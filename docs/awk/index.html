<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>gawk - 小厮</title><meta name="author" content="">
<meta name="author-link" content="">
<meta name="description" content="运行环境： centos: 7 内容来自以下文档： 一见_: awk给外部变量赋值 GNU-gawk帮助手册 gawkgawk 是 awk 繁衍的版本可用于文本排版 升级 从官网下载源码包 1 2 3" /><meta name="keywords" content='awk' /><meta itemprop="name" content="gawk">
<meta itemprop="description" content="运行环境： centos: 7 内容来自以下文档： 一见_: awk给外部变量赋值 GNU-gawk帮助手册 gawkgawk 是 awk 繁衍的版本可用于文本排版 升级 从官网下载源码包 1 2 3"><meta itemprop="datePublished" content="2022-01-12T15:15:47+08:00" />
<meta itemprop="dateModified" content="2022-12-11T10:01:26+08:00" />
<meta itemprop="wordCount" content="15870">
<meta itemprop="keywords" content="awk," /><meta property="og:title" content="gawk" />
<meta property="og:description" content="运行环境： centos: 7 内容来自以下文档： 一见_: awk给外部变量赋值 GNU-gawk帮助手册 gawkgawk 是 awk 繁衍的版本可用于文本排版 升级 从官网下载源码包 1 2 3" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/awk/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-12T15:15:47+08:00" />
<meta property="article:modified_time" content="2022-12-11T10:01:26+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="gawk"/>
<meta name="twitter:description" content="运行环境： centos: 7 内容来自以下文档： 一见_: awk给外部变量赋值 GNU-gawk帮助手册 gawkgawk 是 awk 繁衍的版本可用于文本排版 升级 从官网下载源码包 1 2 3"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#ffffff" data-dark="#252627" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="/awk/" /><link rel="prev" href="/linux%E6%80%A7%E8%83%BD/" /><link rel="next" href="/selinux/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "gawk",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "\/awk\/"
    },"genre": "posts","keywords": "awk","wordcount":  15870 ,
    "url": "\/awk\/","datePublished": "2022-01-12T15:15:47+08:00","dateModified": "2022-12-11T10:01:26+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "小厮"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="wide"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="小厮"><span class="header-title-text">首页</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class='fa-solid fa-archive fa-fw fa-sm'></i> 所有文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="小厮"><span class="header-title-text">首页</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class='fa-solid fa-archive fa-fw fa-sm'></i> 所有文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container container-reverse"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>gawk</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      小厮</span></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/" class="post-category" title="分类 - 文本处理"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 文本处理</a></span></div><div class="post-meta-line"><span title="发布于 2022-01-12 15:15:47"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2022-01-12">2022-01-12</time></span>&nbsp;<span title="更新于 2022-12-11 10:01:26"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2022-12-11">2022-12-11</time></span>&nbsp;<span title="15870 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 15900 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 32 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#gawk">gawk</a>
      <ul>
        <li><a href="#升级">升级</a></li>
        <li><a href="#命令行选项">命令行选项</a></li>
      </ul>
    </li>
    <li><a href="#模式">模式</a>
      <ul>
        <li><a href="#gawk-中的正则表达式">gawk 中的正则表达式</a></li>
        <li><a href="#特殊模式">特殊模式</a></li>
      </ul>
    </li>
    <li><a href="#gawk-读取输入">gawk 读取输入</a>
      <ul>
        <li><a href="#读取输入方式">读取输入方式</a></li>
        <li><a href="#记录records">记录（Records）</a>
          <ul>
            <li><a href="#记录分隔符record-splitting">记录分隔符（Record Splitting）</a></li>
            <li><a href="#读取下一条记录之-next">读取下一条记录之 next</a></li>
            <li><a href="#读取下一条记录之-getline">读取下一条记录之 getline</a></li>
          </ul>
        </li>
        <li><a href="#字段fields">字段（Fields）</a>
          <ul>
            <li><a href="#以字符划分字段">以字符划分字段</a></li>
            <li><a href="#以固定宽度分隔字段">以固定宽度分隔字段</a></li>
            <li><a href="#以内容样式分割字段">以内容样式分割字段</a></li>
            <li><a href="#检查字段分割方式">检查字段分割方式</a></li>
            <li><a href="#引用字段值">引用字段值</a></li>
          </ul>
        </li>
        <li><a href="#读取超时">读取超时</a></li>
        <li><a href="#重试读取">重试读取</a></li>
        <li><a href="#读取目录">读取目录</a></li>
      </ul>
    </li>
    <li><a href="#打印">打印</a>
      <ul>
        <li><a href="#简单打印-print">简单打印 (print)</a></li>
        <li><a href="#高等打印printf">高等打印（printf）</a></li>
        <li><a href="#字段输出分隔符">字段输出分隔符</a></li>
        <li><a href="#记录输出分割符">记录输出分割符</a></li>
        <li><a href="#输出重定向">输出重定向</a></li>
      </ul>
    </li>
    <li><a href="#变量">变量</a>
      <ul>
        <li><a href="#自定义变量">自定义变量</a></li>
        <li><a href="#内置变量">内置变量</a>
          <ul>
            <li><a href="#指定对所有-io使用二进制模式">指定对所有 I/O使用二进制模式</a></li>
            <li><a href="#数字转换字符串">数字转换字符串</a></li>
            <li><a href="#固定列边界">固定列边界</a></li>
            <li><a href="#创建字段">创建字段</a></li>
            <li><a href="#字段分隔符">字段分隔符</a></li>
            <li><a href="#匹配时忽略大小写">匹配时忽略大小写</a></li>
            <li><a href="#输出字段分隔符">输出字段分隔符</a></li>
            <li><a href="#输出记录分隔符">输出记录分隔符</a></li>
            <li><a href="#浮点数精度">浮点数精度</a></li>
            <li><a href="#数字进度舍入模式">数字进度舍入模式</a></li>
            <li><a href="#输入记录分隔符">输入记录分隔符</a></li>
            <li><a href="#下标分隔符">下标分隔符</a></li>
            <li><a href="#源文本中特别标记的字符串常量默认的文本域">源文本中特别标记的字符串常量默认的文本域</a></li>
            <li><a href="#命令行参数">命令行参数</a></li>
            <li><a href="#当前文件索引">当前文件索引</a></li>
            <li><a href="#环境变量">环境变量</a></li>
            <li><a href="#错误信息">错误信息</a></li>
            <li><a href="#输入文件名">输入文件名</a></li>
            <li><a href="#当前记录号">当前记录号</a></li>
            <li><a href="#字段数量">字段数量</a></li>
            <li><a href="#函数名称">函数名称</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#表达式">表达式</a>
      <ul>
        <li><a href="#字符串和数字转换">字符串和数字转换</a></li>
        <li><a href="#算术运算">算术运算</a></li>
        <li><a href="#字符串类型和数值类型比较">字符串类型和数值类型比较</a></li>
      </ul>
    </li>
    <li><a href="#数组">数组</a></li>
    <li><a href="#陈述语句">陈述语句</a>
      <ul>
        <li><a href="#if-then-语句">if-then 语句</a></li>
        <li><a href="#while-语句">while 语句</a></li>
        <li><a href="#do-while">do-while</a></li>
        <li><a href="#for">for</a></li>
        <li><a href="#switch">switch</a></li>
        <li><a href="#break">break</a></li>
        <li><a href="#continue">continue</a></li>
      </ul>
    </li>
    <li><a href="#退出状态码">退出状态码</a></li>
    <li><a href="#脚本">脚本</a>
      <ul>
        <li><a href="#内建函数">内建函数</a></li>
        <li><a href="#函数库">函数库</a></li>
      </ul>
    </li>
    <li><a href="#实例">实例</a>
      <ul>
        <li><a href="#查看文本行数">查看文本行数</a></li>
        <li><a href="#查看偶数行内容">查看偶数行内容</a></li>
        <li><a href="#查看奇数行内容">查看奇数行内容</a></li>
        <li><a href="#查看所有文件字节数">查看所有文件字节数</a></li>
        <li><a href="#查看文本行内容不含空行">查看文本行内容，不含空行</a></li>
        <li><a href="#查看文件中最长的行宽度">查看文件中最长的行宽度</a></li>
        <li><a href="#以字符e为分隔符显示第一部分和第二部分">以字符<code>e</code>为分隔符，显示第一部分和第二部分</a></li>
        <li><a href="#以字符e为分隔符格式显示第二部分">以字符<code>e</code>为分隔符，格式显示第二部分</a></li>
        <li><a href="#以字符e为分隔符显示第一部分和第二部分-1">以字符<code>e</code>为分隔符，显示第一部分和第二部分</a></li>
        <li><a href="#指定显示分隔符">指定显示分隔符</a></li>
        <li><a href="#指定读取分隔符">指定读取分隔符</a></li>
        <li><a href="#指定输出分隔符">指定输出分隔符</a></li>
        <li><a href="#统计文本的所有行">统计文本的所有行</a></li>
        <li><a href="#分开统计处理文本的所有行">分开统计处理文本的所有行</a></li>
        <li><a href="#nf查看以e作为分隔符号显示行号和最后一段">NF查看以e作为分隔符号，显示行号和最后一段</a></li>
        <li><a href="#自定义变量示例">自定义变量示例</a></li>
        <li><a href="#格式输出">格式输出</a></li>
        <li><a href="#正则表达式示例">正则表达式示例</a></li>
        <li><a href="#显示uid小于大于或等于3且小于7的用户">显示UID小于大于或等于3且小于7的用户</a></li>
        <li><a href="#查看使用率大于10的磁盘和挂载点">查看使用率大于10的磁盘和挂载点</a></li>
        <li><a href="#匹配uid为0到第一次匹配nologin结尾的用户">匹配UID为0到第一次匹配nologin结尾的用户</a></li>
        <li><a href="#brgin模式与end模式示例">BRGIN模式与END模式示例</a></li>
        <li><a href="#if语句示例">if语句示例</a></li>
        <li><a href="#变量示例">变量示例</a></li>
        <li><a href="#begin模式定义变量">BEGIN模式定义变量,</a></li>
        <li><a href="#while循环示例">while循环示例</a></li>
        <li><a href="#length函数示例">length函数示例</a></li>
        <li><a href="#for循环遍历数组示例">for循环遍历数组示例</a></li>
        <li><a href="#gawk-数组示例">gawk 数组示例</a></li>
        <li><a href="#删除所有文件换行符">删除所有文件换行符</a></li>
        <li><a href="#特定宽度为8换行">特定宽度为8换行</a></li>
        <li><a href="#打乱文本内容">打乱文本内容</a></li>
        <li><a href="#示例以-pyh-开头的行作为键其余为值">示例：以 pyh: 开头的行作为键，其余为值</a></li>
        <li><a href="#千位分割">千位分割</a></li>
        <li><a href="#查看cpu型号">查看cpu型号</a></li>
        <li><a href="#查看cpu核心数量">查看cpu核心数量</a></li>
        <li><a href="#非-risk-v2-和-risk-listener-部分添加号注释">非 risk-v2 和 risk-listener 部分添加#号注释</a></li>
        <li><a href="#每行后面增加一行空行">每行后面增加一行空行</a></li>
        <li><a href="#查看系统版本">查看系统版本</a></li>
        <li><a href="#获取内存容量总容量m">获取内存容量（总容量M）</a></li>
        <li><a href="#获取交换分区容量总容量m">获取交换分区容量（总容量M）</a></li>
        <li><a href="#获取系统运行时长">获取系统运行时长</a></li>
        <li><a href="#获取cpu频率mhz">获取CPU频率（MHz）</a></li>
        <li><a href="#获取系统平均负载统计时间">获取系统平均负载统计时间</a></li>
        <li><a href="#竖排调整为横排去除感叹号">竖排调整为横排，去除感叹号</a></li>
        <li><a href="#第一列去除重复字符串第二列统计数值之和">第一列去除重复字符串，第二列统计数值之和</a></li>
      </ul>
    </li>
    <li><a href="#给外部变量赋值">给外部变量赋值</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><div class="details admonition note open">
      <div class="details-summary admonition-title">
        <i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i>
      </div>
      <div class="details-content">
        <div class="admonition-content">本文最后更新于 2022-12-11，文中内容可能已过时。</div>
      </div>
    </div><!-- FileID: FID -->
<blockquote>
<p>运行环境：</p>
<ul>
<li>centos: 7</li>
</ul>
<p>内容来自以下文档：</p>
<ul>
<li><a href="https://blog.51cto.com/mooon/909783"target="_blank" rel="external nofollow noopener noreferrer"><code>一见_</code>: awk给外部变量赋值</a></li>
<li><a href="https://www.gnu.org/software/gawk/manual/" title="GNU-gawk帮助手册"target="_blank" rel="external nofollow noopener noreferrer">GNU-gawk帮助手册</a></li>
</ul>
</blockquote>
<!-- 网址链接 -->
<!-- 图片链接 -->
<h1 id="gawk" class="heading-element">
  <a href="#gawk" class="heading-mark"></a>gawk</h1><p>gawk 是 awk 繁衍的版本可用于文本排版</p>
<h2 id="升级" class="heading-element">
  <a href="#%e5%8d%87%e7%ba%a7" class="heading-mark"></a>升级</h2><br/>
<ol>
<li>从官网下载源码包</li>
</ol>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 pag<span class="o">]</span><span class="c1"># wget https://ftp.gnu.org/gnu/gawk/gawk-5.1.0.tar.xz</span>
</span></span><span class="line"><span class="cl">--2020-07-13 08:29:17--  https://ftp.gnu.org/gnu/gawk/gawk-5.1.0.tar.xz
</span></span><span class="line"><span class="cl">Resolving ftp.gnu.org <span class="o">(</span>ftp.gnu.org<span class="o">)</span>... 209.51.188.20, 2001:470:142:3::b
</span></span><span class="line"><span class="cl">Connecting to ftp.gnu.org <span class="o">(</span>ftp.gnu.org<span class="o">)</span><span class="p">|</span>209.51.188.20<span class="p">|</span>:443... connected.
</span></span><span class="line"><span class="cl">HTTP request sent, awaiting response... <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Length: <span class="m">3154564</span> <span class="o">(</span>3.0M<span class="o">)</span> <span class="o">[</span>application/x-xz<span class="o">]</span>
</span></span><span class="line"><span class="cl">Saving to: ‘gawk-5.1.0.tar.xz’
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gawk-5.1.0.tar.xz                100%<span class="o">[=======================================================</span>&gt;<span class="o">]</span>   3.01M  1.28MB/s    in 2.4s    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2020-07-13 08:29:21 <span class="o">(</span>1.28 MB/s<span class="o">)</span> - ‘gawk-5.1.0.tar.xz’ saved <span class="o">[</span>3154564/3154564<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ol start="2">
<li>解压</li>
</ol>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 pag<span class="o">]</span><span class="c1"># tar -Jxf gawk-5.1.0.tar.xz </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 pag<span class="o">]</span><span class="c1"># cd gawk-5.1.0</span></span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ol start="3">
<li>编译安装</li>
</ol>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk-5.1.0<span class="o">]</span><span class="c1"># ./config</span>
</span></span><span class="line"><span class="cl">config.guess  config.rpath  config.sub    configure     
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk-5.1.0<span class="o">]</span><span class="c1"># ./configure </span>
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> a BSD-compatible install... ./install-sh -c
</span></span><span class="line"><span class="cl">checking whether build environment is sane... yes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> a thread-safe mkdir -p... /usr/bin/mkdir -p
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> gawk... gawk
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk-5.1.0<span class="o">]</span><span class="c1"># make &amp;&amp; make install</span>
</span></span><span class="line"><span class="cl">make  all-recursive
</span></span><span class="line"><span class="cl">make<span class="o">[</span>1<span class="o">]</span>: Entering directory <span class="s1">&#39;/root/pag/gawk-5.1.0&#39;</span>
</span></span><span class="line"><span class="cl">Making all in support
</span></span><span class="line"><span class="cl">...</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ol start="4">
<li>查看版本</li>
</ol>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 如果没有生效，结束当前 ssh 进程，重新远程；本地登录的直接退出程序登陆</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk-5.1.0<span class="o">]</span><span class="c1"># gawk -V</span>
</span></span><span class="line"><span class="cl">GNU Awk 5.1.0, API: 3.0
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>C<span class="o">)</span> 1989, 1991-2020 Free Software Foundation.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This program is free software<span class="p">;</span> you can redistribute it and/or modify
</span></span><span class="line"><span class="cl">it under the terms of the GNU General Public License as published by
</span></span><span class="line"><span class="cl">the Free Software Foundation<span class="p">;</span> either version <span class="m">3</span> of the License, or
</span></span><span class="line"><span class="cl"><span class="o">(</span>at your option<span class="o">)</span> any later version.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This program is distributed in the hope that it will be useful,
</span></span><span class="line"><span class="cl">but WITHOUT ANY WARRANTY<span class="p">;</span> without even the implied warranty of
</span></span><span class="line"><span class="cl">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
</span></span><span class="line"><span class="cl">GNU General Public License <span class="k">for</span> more details.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">You should have received a copy of the GNU General Public License
</span></span><span class="line"><span class="cl">along with this program. If not, see http://www.gnu.org/licenses/.</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="命令行选项" class="heading-element">
  <a href="#%e5%91%bd%e4%bb%a4%e8%a1%8c%e9%80%89%e9%a1%b9" class="heading-mark"></a>命令行选项</h2><div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">使用格式：
</span></span><span class="line"><span class="cl">gawk <span class="o">[</span> POSIX or GNU style options <span class="o">]</span> -f program-file <span class="o">[</span> -- <span class="o">]</span> file ...
</span></span><span class="line"><span class="cl">gawk <span class="o">[</span> POSIX or GNU style options <span class="o">]</span> <span class="o">[</span> -- <span class="o">]</span> program-text file ...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">常见选项：
</span></span><span class="line"><span class="cl">-F
</span></span><span class="line"><span class="cl">	指定分隔符，默认为空格，等效 FS 变量
</span></span><span class="line"><span class="cl">-f
</span></span><span class="line"><span class="cl">	从指定文件读取程序
</span></span><span class="line"><span class="cl">-v
</span></span><span class="line"><span class="cl">	定义变量，格式：变量名<span class="o">=</span>变量值
</span></span><span class="line"><span class="cl">-mf
</span></span><span class="line"><span class="cl">	指定要处理的数据文件中的最大字段数
</span></span><span class="line"><span class="cl">-mr
</span></span><span class="line"><span class="cl">	指定数据文件中的最大数据行数
</span></span><span class="line"><span class="cl">-W
</span></span><span class="line"><span class="cl">	指定gawk的兼容模式或警告等级</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="模式" class="heading-element">
  <a href="#%e6%a8%a1%e5%bc%8f" class="heading-mark"></a>模式</h1><p>模式控制 awk 操作执行范围，当模式与输入记录匹配时，执行对应的操作，有以下几种模式：</p>
<ul>
<li>正则表达式：当正则表达式能匹配记录时执行操作</li>
<li>普通表达式：当数值不为0或字符串不为空则执行操作</li>
<li>范围模式：&ldquo;开始,结束&rdquo; 形式指定范围</li>
<li>BEGIN：读取记录之前做的操作</li>
<li>END：对记录执行操作后的后续操作</li>
<li>BEGINFILE：读取记录之前执行 awk 脚本</li>
<li>ENDFILE：执行操作之后执行 awk 脚本</li>
<li>不指定：对每条记录都执行操作</li>
</ul>
<h2 id="gawk-中的正则表达式" class="heading-element">
  <a href="#gawk-%e4%b8%ad%e7%9a%84%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f" class="heading-mark"></a>gawk 中的正则表达式</h2><p>正则表达式写法：<code>/regexp/</code></p>
<ul>
<li>正则表达式</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">元字符</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>\</code></td>
<td style="text-align:left">转义符</td>
</tr>
<tr>
<td style="text-align:left"><code>^</code></td>
<td style="text-align:left">匹配字符串开头</td>
</tr>
<tr>
<td style="text-align:left"><code>$</code></td>
<td style="text-align:left">匹配字符串结尾</td>
</tr>
<tr>
<td style="text-align:left"><code>.</code></td>
<td style="text-align:left">匹配任何单个字符，包括换行符</td>
</tr>
<tr>
<td style="text-align:left"><code>[ ]</code></td>
<td style="text-align:left">方括号表达式，表示匹配其中任意单个字符</td>
</tr>
<tr>
<td style="text-align:left"><code>[^ ]</code></td>
<td style="text-align:left">补充的方括号表达式，表示区分，不匹配方括号中任意单个字符</td>
</tr>
<tr>
<td style="text-align:left">`</td>
<td style="text-align:left">`</td>
</tr>
<tr>
<td style="text-align:left"><code>( )</code></td>
<td style="text-align:left">分区，将表达式划分为一组</td>
</tr>
<tr>
<td style="text-align:left"><code>*</code></td>
<td style="text-align:left">匹配前面的表达式任意次数，贪婪模式</td>
</tr>
<tr>
<td style="text-align:left"><code>+</code></td>
<td style="text-align:left">匹配前面的表达式至少一次</td>
</tr>
<tr>
<td style="text-align:left"><code>?</code></td>
<td style="text-align:left">匹配前面的表达式0次或1次</td>
</tr>
<tr>
<td style="text-align:left"><code>{n}</code></td>
<td style="text-align:left">匹配前面的表达式 n 次；n 为正整数</td>
</tr>
<tr>
<td style="text-align:left"><code>{n,}</code></td>
<td style="text-align:left">匹配前面的表达式至少 n 次；n 为正整数</td>
</tr>
<tr>
<td style="text-align:left"><code>{n,m}</code></td>
<td style="text-align:left">匹配前面的表达式至少 n 次，最多 m 次；n 和 m 都为正整数，且 m &gt; n</td>
</tr>
<tr>
<td style="text-align:left"><code>\\</code></td>
<td style="text-align:left">单个字符串 <code>\</code></td>
</tr>
<tr>
<td style="text-align:left"><code>\a</code></td>
<td style="text-align:left">警报，即 <code>&lt;BEL&gt;</code> ; <code>&lt;Ctrl-g&gt;</code> ASCII 为 7</td>
</tr>
<tr>
<td style="text-align:left"><code>\b</code></td>
<td style="text-align:left">退格，即 <code>&lt;BS&gt;</code> ；<code>&lt;ctrl-h&gt;</code> ASCII 为 8</td>
</tr>
<tr>
<td style="text-align:left"><code>\f</code></td>
<td style="text-align:left">换页符，即 <code>&lt;FF&gt;</code> ; <code>&lt;Ctrl-l&gt;</code> ASCII 为 12</td>
</tr>
<tr>
<td style="text-align:left"><code>\n</code></td>
<td style="text-align:left">换行符，即 <code>&lt;LF&gt;</code> ; <code>&lt;Ctrl-j&gt;</code> ASCII 为 10</td>
</tr>
<tr>
<td style="text-align:left"><code>\r</code></td>
<td style="text-align:left">回车符，即 <code>&lt;CR&gt;</code> ; <code>&lt;Ctrl-m&gt;</code> ASCII 为 13</td>
</tr>
<tr>
<td style="text-align:left"><code>\t</code></td>
<td style="text-align:left">水平制表符，即 <code>&lt;Tab&gt;</code> ; <code>&lt;Ctrl-i&gt;</code> ASCII 为 9</td>
</tr>
<tr>
<td style="text-align:left"><code>\v</code></td>
<td style="text-align:left">垂直制表符; <code>&lt;Ctrl-k&gt;</code> ASCII 为 11</td>
</tr>
<tr>
<td style="text-align:left"><code>\nnn</code></td>
<td style="text-align:left">八进制 nnn</td>
</tr>
<tr>
<td style="text-align:left"><code>\xhh</code></td>
<td style="text-align:left">十六进制</td>
</tr>
<tr>
<td style="text-align:left"><code>\/</code></td>
<td style="text-align:left">字符 <code>/</code> 仅应用于正则表达式常量</td>
</tr>
<tr>
<td style="text-align:left"><code>\&quot;</code></td>
<td style="text-align:left">字符 <code>&quot;</code> 仅应用于正则表达式常量</td>
</tr>
<tr>
<td style="text-align:left"><code>[:alnim:]</code></td>
<td style="text-align:left">字母数字字符；等效 <code>[0-9a-zA-Z]</code></td>
</tr>
<tr>
<td style="text-align:left"><code>[:alpha:]</code></td>
<td style="text-align:left">字母字符；等效 <code>[a-zA-Z]</code></td>
</tr>
<tr>
<td style="text-align:left"><code>[:blank:]</code></td>
<td style="text-align:left">空格或制表符</td>
</tr>
<tr>
<td style="text-align:left"><code>[:cntrl:]</code></td>
<td style="text-align:left">控制字符</td>
</tr>
<tr>
<td style="text-align:left"><code>[:digit;]</code></td>
<td style="text-align:left">数字字符；等效 <code>[0-9]</code></td>
</tr>
<tr>
<td style="text-align:left"><code>[:graph:]</code></td>
<td style="text-align:left">可见字符</td>
</tr>
<tr>
<td style="text-align:left"><code>[:lower:]</code></td>
<td style="text-align:left">小写字母字符</td>
</tr>
<tr>
<td style="text-align:left"><code>[:print:]</code></td>
<td style="text-align:left">可见字符（包含空格）</td>
</tr>
<tr>
<td style="text-align:left"><code>[:punct:]</code></td>
<td style="text-align:left">标点字符</td>
</tr>
<tr>
<td style="text-align:left"><code>[:space:]</code></td>
<td style="text-align:left">空白字符（包含空格、回车符、换行符之类的）</td>
</tr>
<tr>
<td style="text-align:left"><code>[:upper:]</code></td>
<td style="text-align:left">大写字母字符；等效 <code>[A-Z]</code></td>
</tr>
</tbody>
</table>
<ul>
<li>正则表达式运算符</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">运算符</th>
<th style="text-align:left">说明</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>~</code></td>
<td style="text-align:left">和</td>
<td style="text-align:left"><code>/regexp/ ~ $1</code> 表示 <code>$1</code> 含有 <code>regexp</code> 时才满足</td>
</tr>
<tr>
<td style="text-align:left"><code>!~</code></td>
<td style="text-align:left">非</td>
<td style="text-align:left"><code>/regexp/ !~$1</code> 表示 <code>$1</code> 含有 <code>regexp</code> 时不满足</td>
</tr>
</tbody>
</table>
<ul>
<li>特定与 GAWK 才有的表达式，其他 awk 不一定有</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">表达式</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>\s</code></td>
<td style="text-align:left">匹配空白字符（包含空格、制表符、回车符之类的）</td>
</tr>
<tr>
<td style="text-align:left"><code>\S</code></td>
<td style="text-align:left">匹配非空白字符，和 <code>\s</code> 相反</td>
</tr>
<tr>
<td style="text-align:left"><code>\w</code></td>
<td style="text-align:left">匹配字母、数字、下划线</td>
</tr>
<tr>
<td style="text-align:left"><code>\W</code></td>
<td style="text-align:left">匹配非字母、数字、下划线，和 <code>\w</code> 相反</td>
</tr>
<tr>
<td style="text-align:left"><code>\&lt;</code></td>
<td style="text-align:left">匹配单词的开头</td>
</tr>
<tr>
<td style="text-align:left"><code>\&gt;</code></td>
<td style="text-align:left">匹配单词的结尾</td>
</tr>
<tr>
<td style="text-align:left"><code>\y</code></td>
<td style="text-align:left">匹配单词边界</td>
</tr>
<tr>
<td style="text-align:left"><code>\B</code></td>
<td style="text-align:left">匹配字符边界都相同的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>\`</code></td>
<td style="text-align:left">匹配缓冲区开头的字符串</td>
</tr>
<tr>
<td style="text-align:left"><code>\'</code></td>
<td style="text-align:left">匹配缓冲区结尾的字符串</td>
</tr>
</tbody>
</table>
<h2 id="特殊模式" class="heading-element">
  <a href="#%e7%89%b9%e6%ae%8a%e6%a8%a1%e5%bc%8f" class="heading-mark"></a>特殊模式</h2><p><code>BEGIN{}</code> 规则在读取记录之前执行一次；<code>END{}</code> 规则是对记录执行操作之后的清尾步奏。他们不能和运算符一起使用，当存在多个 <code>BEGIN</code> 或 <code>END</code> 规则时，按照顺序执行</p>
<h1 id="gawk-读取输入" class="heading-element">
  <a href="#gawk-%e8%af%bb%e5%8f%96%e8%be%93%e5%85%a5" class="heading-mark"></a>gawk 读取输入</h1><h2 id="读取输入方式" class="heading-element">
  <a href="#%e8%af%bb%e5%8f%96%e8%be%93%e5%85%a5%e6%96%b9%e5%bc%8f" class="heading-mark"></a>读取输入方式</h2><p>有以下读取方式</p>
<ul>
<li>文件</li>
<li>标准输入</li>
<li>管道符</li>
<li><code>getline</code></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">变量名称</th>
<th style="text-align:left">注释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>$n</code>(n为正整数和0)</td>
<td style="text-align:left">n 表示个字段，0 表示所有字段。字段以 FS 变量为分隔符</td>
</tr>
<tr>
<td style="text-align:left"><code>FS</code></td>
<td style="text-align:left">指定读取文本的分隔符，默认是空白符</td>
</tr>
<tr>
<td style="text-align:left"><code>RS</code></td>
<td style="text-align:left">指定读取文本的分号符，默认是换行符</td>
</tr>
<tr>
<td style="text-align:left"><code>OFS</code></td>
<td style="text-align:left">指定输出文本的分隔符，默认是空白符</td>
</tr>
<tr>
<td style="text-align:left"><code>ORS</code></td>
<td style="text-align:left">指定输出文本的分行符，默认是换行符</td>
</tr>
<tr>
<td style="text-align:left"><code>FIELDWIDTHS</code></td>
<td style="text-align:left">指定输入字符宽度，忽略 FS 变量，定义之后不可修改</td>
</tr>
<tr>
<td style="text-align:left"><code>ARGC</code></td>
<td style="text-align:left">当前命令行的参数</td>
</tr>
<tr>
<td style="text-align:left"><code>ARGIND</code></td>
<td style="text-align:left">当前文件在 ARGV 中的参数</td>
</tr>
<tr>
<td style="text-align:left"><code>CONVFMT</code></td>
<td style="text-align:left">数字转换格式，默认值为 <code>%.6 g</code></td>
</tr>
<tr>
<td style="text-align:left"><code>ENVIRON</code></td>
<td style="text-align:left">当前shell环境变量及其值组成的关联组</td>
</tr>
<tr>
<td style="text-align:left"><code>ERRNO</code></td>
<td style="text-align:left">当读取或关闭输入文件发送错误时的系统错误信号</td>
</tr>
<tr>
<td style="text-align:left"><code>FILENAME</code></td>
<td style="text-align:left"><code>gawk</code> 输入数据的文件名称</td>
</tr>
<tr>
<td style="text-align:left"><code>FNR</code></td>
<td style="text-align:left">当前数据文件中的行数</td>
</tr>
<tr>
<td style="text-align:left"><code>IGNORECASE</code></td>
<td style="text-align:left">设置为0时，忽略命令行中的字符大小写</td>
</tr>
<tr>
<td style="text-align:left"><code>NF</code></td>
<td style="text-align:left">数据文件中的字段总数</td>
</tr>
<tr>
<td style="text-align:left"><code>NR</code></td>
<td style="text-align:left">以处理的输入记录</td>
</tr>
<tr>
<td style="text-align:left"><code>OFMT</code></td>
<td style="text-align:left">数字的输入格式，默认为 <code>%.6 g</code></td>
</tr>
<tr>
<td style="text-align:left"><code>RLENGTH</code></td>
<td style="text-align:left">由 match 函数所匹配的子字符串长度</td>
</tr>
<tr>
<td style="text-align:left"><code>RSTART</code></td>
<td style="text-align:left">由 match 函数所匹配的子字符起始位置</td>
</tr>
</tbody>
</table>
<h2 id="记录records" class="heading-element">
  <a href="#%e8%ae%b0%e5%bd%95records" class="heading-mark"></a>记录（Records）</h2><p>通常情况下 awk 通标准输入或文件中获取输入，如果指定输入文件，awk 会按照顺序读取和执行相关操作；输入以记录（records）为单位读取；并每次处理一个 &ldquo;records&rdquo; (默认为一行)</p>
<h3 id="记录分隔符record-splitting" class="heading-element">
  <a href="#%e8%ae%b0%e5%bd%95%e5%88%86%e9%9a%94%e7%ac%a6record-splitting" class="heading-mark"></a>记录分隔符（Record Splitting）</h3><p>记录（Record）由成为记录分隔符（Record Splitting）拆分，默认情况下记录分隔符为换行符，因此默认情况下 awk 每次读取一行</p>
<p>可以更改 <code>RS</code> 变量改变默认的记录分隔符；</p>
<ul>
<li>当 <code>RS</code> 变量值为多个字符，则视为正则表达式</li>
<li>当 <code>RS</code> 变量在兼容模式下时，正则表达式不可用，仅用第一个字符作为记录分隔符</li>
<li>当 <code>RS</code> 变量值为空时，表示整个输入为一个记录</li>
<li>当 <code>RS</code> 变量值不存在时，<code>RS</code> 值自动设置为空字符串，也就是把整个输入当成一个记录处理</li>
</ul>
<p>多行分隔记录方法：https://www.gnu.org/software/gawk/manual/html_node/Multiple-Line.html</p>
<h3 id="读取下一条记录之-next" class="heading-element">
  <a href="#%e8%af%bb%e5%8f%96%e4%b8%8b%e4%b8%80%e6%9d%a1%e8%ae%b0%e5%bd%95%e4%b9%8b-next" class="heading-mark"></a>读取下一条记录之 next</h3><p><code>next</code> 语句可以强制 awk 停止处理当前记录，并继续读取下一条记录，因此会放弃后续操作：</p>
<ul>
<li>由于该next语句，该程序的后续规则将不会看到错误的记录。错误消息将被重定向到标准错误输出流，就像错误消息一样</li>
<li>如果该next语句导致到达输入的结尾，那么将END执行任何规则中的代码</li>
<li>该next声明是不允许在 BEGINFILE 和 ENDFILE 规则中定义（-根据POSIX标准，如果next在BEGIN或END规则中使用该语句，则行为是不确定的 。 gawk将其视为语法错误）</li>
<li>next函数体内的一条语句读取下一条记录，并开始使用程序中的第一条规则对其进行处理</li>
</ul>
<br/>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># cat a</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="m">3</span> <span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="m">5</span> <span class="m">6</span>
</span></span><span class="line"><span class="cl"><span class="m">7</span> <span class="m">8</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos  ~<span class="o">]</span><span class="c1"># awk &#39;{print &#34;$1=&#34;$1;next;print &#34;$2=&#34;$2}&#39; a</span>
</span></span><span class="line"><span class="cl"><span class="nv">$1</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">$1</span><span class="o">=</span><span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="nv">$1</span><span class="o">=</span><span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="nv">$1</span><span class="o">=</span><span class="m">7</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="读取下一条记录之-getline" class="heading-element">
  <a href="#%e8%af%bb%e5%8f%96%e4%b8%8b%e4%b8%80%e6%9d%a1%e8%ae%b0%e5%bd%95%e4%b9%8b-getline" class="heading-mark"></a>读取下一条记录之 getline</h3><br/>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos ~<span class="o">]</span><span class="c1"># cat a</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="m">3</span> <span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="m">5</span> <span class="m">6</span>
</span></span><span class="line"><span class="cl"><span class="m">7</span> <span class="m">8</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos  ~<span class="o">]</span><span class="c1"># awk &#39;{print &#34;$1=&#34;$1;getline;print &#34;$2=&#34;$2}&#39; a</span>
</span></span><span class="line"><span class="cl"><span class="nv">$1</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">$2</span><span class="o">=</span><span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="nv">$1</span><span class="o">=</span><span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="nv">$2</span><span class="o">=</span><span class="m">8</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="字段fields" class="heading-element">
  <a href="#%e5%ad%97%e6%ae%b5fields" class="heading-mark"></a>字段（Fields）</h2><p>当 awk 读取输入的记录时，会自动分解为多个字段（filed）。默认情况下以一个或多个空白字符（仅限于空格、制表符、换行符）为分隔符</p>
<h3 id="以字符划分字段" class="heading-element">
  <a href="#%e4%bb%a5%e5%ad%97%e7%ac%a6%e5%88%92%e5%88%86%e5%ad%97%e6%ae%b5" class="heading-mark"></a>以字符划分字段</h3><p>可以使用 <code>FS</code> 变量（也可以使用 <code>gawk -F</code> 选项）改变默认的字段分隔符：</p>
<ul>
<li><code>FS</code> 变量值默认为空字符（空格或制表符）</li>
<li><code>FS</code> 变量值可以使用正则表达式或单个字符或字符与正则表达式混合使用</li>
<li><code>FS</code> 变量值为增则和字符串混用时，会先经过 awk 字符串处理，因此使用转义符时需使用双倍, <code>\\</code> 第一个 <code>\</code> 会被 awk 字符串处理掉，在把 <code>\</code> 传递给该变量</li>
<li><code>FS</code> 变量值为空时，<code>FS=&quot;&quot;</code> 每个字符都是一个字段，包括空格，但不包括换行符</li>
<li><code>FS</code> 变量值为换行符时，<code>$1</code> 等效表示输入行中的一行文本</li>
<li><code>FS</code> 在旧的版本中，记录拆分会在实际引用字段之前。即 在读取记录之后，使用引用字段操作之前更改该变量值会生效的</li>
<li><code>FS</code> 在新的版本中（gawk:4.0.2 测试可以），读取记录时就会拆分字段，也就是说在读取记录之后，即便改了该变量值，使用引用字段操作还是默认值，因此，需要在读取记录之前修改该变量</li>
</ul>
<br/>
<ul>
<li>示例：<code>FS</code> 变量值为正则表达式</li>
</ul>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk &#39;BEGIN { FS = &#34;[2b].&#34; } {print $1}&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> 
</span></span><span class="line"><span class="cl">aa 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span> os iw</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：<code>FS</code> 变量值为正则表达式和字符混合使用</li>
</ul>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># [2b] 表示正则表达式，2或b</span>
</span></span><span class="line"><span class="cl"><span class="c1"># \\. 经过 awk 字符串处理之后为 \. 在赋值给 FS变量，FS变量再把 \. 转义为 . 字符</span>
</span></span><span class="line"><span class="cl"><span class="c1"># FS 变量值不存在，使用默认的换行符</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk &#39;BEGIN { FS = &#34;[2b]\\.&#34; } {print $2}&#39; file4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk &#39;BEGIN { FS = &#34;[2b]\\.&#34; } {print $1}&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span> os iw
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span> os iw</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：读取每个字符串</li>
</ul>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1">#  echo a b | gawk &#39;BEGIN { FS = &#34;&#34; } {for (i = 1; i &lt;= NF; i = i + 1)  print &#34;Field&#34;, i, &#34;is&#34;, $i  }&#39;</span>
</span></span><span class="line"><span class="cl">Field <span class="m">1</span> is a
</span></span><span class="line"><span class="cl">Field <span class="m">2</span> is  
</span></span><span class="line"><span class="cl">Field <span class="m">3</span> is b</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="以固定宽度分隔字段" class="heading-element">
  <a href="#%e4%bb%a5%e5%9b%ba%e5%ae%9a%e5%ae%bd%e5%ba%a6%e5%88%86%e9%9a%94%e5%ad%97%e6%ae%b5" class="heading-mark"></a>以固定宽度分隔字段</h3><p>gawk提供了一种处理没有特定字段分隔符的固定宽度字段的功能，待补充，页面：https://www.gnu.org/software/gawk/manual/html_node/Constant-Size.html</p>
<h3 id="以内容样式分割字段" class="heading-element">
  <a href="#%e4%bb%a5%e5%86%85%e5%ae%b9%e6%a0%b7%e5%bc%8f%e5%88%86%e5%89%b2%e5%ad%97%e6%ae%b5" class="heading-mark"></a>以内容样式分割字段</h3><p>待补充，原文：https://www.gnu.org/software/gawk/manual/html_node/Splitting-By-Content.html</p>
<h3 id="检查字段分割方式" class="heading-element">
  <a href="#%e6%a3%80%e6%9f%a5%e5%ad%97%e6%ae%b5%e5%88%86%e5%89%b2%e6%96%b9%e5%bc%8f" class="heading-mark"></a>检查字段分割方式</h3><div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span>PROCINFO<span class="o">[</span><span class="s2">&#34;FS&#34;</span><span class="o">]</span> <span class="o">==</span> <span class="s2">&#34;FS&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    regular field splitting …
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="k">if</span> <span class="o">(</span>PROCINFO<span class="o">[</span><span class="s2">&#34;FS&#34;</span><span class="o">]</span> <span class="o">==</span> <span class="s2">&#34;FIELDWIDTHS&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    fixed-width field splitting …
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="k">if</span> <span class="o">(</span>PROCINFO<span class="o">[</span><span class="s2">&#34;FS&#34;</span><span class="o">]</span> <span class="o">==</span> <span class="s2">&#34;FPAT&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    content-based field splitting …
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">    API input parser field splitting … <span class="o">(</span>advanced feature<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="引用字段值" class="heading-element">
  <a href="#%e5%bc%95%e7%94%a8%e5%ad%97%e6%ae%b5%e5%80%bc" class="heading-mark"></a>引用字段值</h3><p>字段可以被 <code>$n</code> 引用，其中 n 表示从左往右的字段编号，如果 n 大于实际的编号，则打印空格。还有以下特殊的编号：</p>
<ul>
<li><code>$0</code> 表示记录中的所有段，也就是整个记录。当记录值重建时，<code>$0</code> 会去除记录开头和结尾的空格字符</li>
<li><code>$NF</code> 表示记录中最后一个字段。<code>$NF</code> 是一个预定义变量，每次读取记录，<code>$NF</code> 变量值为该记录的字段数量，当 <code>$NF</code> 重建的值小于记录字段时，余下的字段被抛弃</li>
</ul>
<p>n 可以以表达式形式书写，如 <code>$( 2*2 )</code> 表示 <code>$4</code> ; <code>$( 2-2 )</code> 表示 <code>$0</code>；当字段作为数字做运算符记算时，会转换为数值，运算完成之后再转换为字符串</p>
<p>字段可以赋值给变量，同样也可以把值赋值给字段</p>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;{Fs = $2; $2=10; print Fs,&#34;=&gt;&#34;,$2}&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="nv">22</span> <span class="o">=</span>&gt; <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">bb</span> <span class="o">=</span>&gt; <span class="m">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 22+10 为 32</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;{Fs = $2; $2=$2+10; print Fs,&#34;=&gt;&#34;,$2}&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="nv">22</span> <span class="o">=</span>&gt; <span class="m">32</span>
</span></span><span class="line"><span class="cl"><span class="nv">bb</span> <span class="o">=</span>&gt; <span class="m">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span> os iw
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;{Fs = $2; $2=$2+$2+$3; print Fs,&#34;=&gt;&#34;,$2}&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="nv">22</span> <span class="o">=</span>&gt; <span class="m">83</span>
</span></span><span class="line"><span class="cl"><span class="nv">bb</span> <span class="o">=</span>&gt; <span class="m">0</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>$NF</code> 的变量值被修改之后，会抛弃余下的字段</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;{ print &#34;NF = &#34; NF;  NF = 3; print $0}&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="nv">NF</span> <span class="o">=</span> <span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span>
</span></span><span class="line"><span class="cl"><span class="nv">NF</span> <span class="o">=</span> <span class="m">5</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span> os iw</span></span></code></pre></td></tr></table>
</div>
</div><p><code>$NF</code> 变量值为表达式 <code>^</code> 时，有的 awk 是匹配整个记录的开头，有的是每个分割字段符都是新的字符串</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39;xxAA  xxBxx  C&#39; | gawk -F &#39;(^x+)|( +)&#39; &#39;{ for (i = 1; i &lt;= NF; i++) printf &#34;--&gt;%s&lt;--\n&#34;,$i }&#39;</span>
</span></span><span class="line"><span class="cl">--&gt;&lt;--
</span></span><span class="line"><span class="cl">--&gt;AA&lt;--
</span></span><span class="line"><span class="cl">--&gt;xxBxx&lt;--
</span></span><span class="line"><span class="cl">--&gt;C&lt;--</span></span></code></pre></td></tr></table>
</div>
</div><p><code>$0</code> 重建时之前会丢弃记录开头和结尾的空格字符</p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># $2 被重建，因此 $0 也被重建</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39;  a b c d&#39; | awk &#39;{ print; $2 = $2; print }&#39;</span>
</span></span><span class="line"><span class="cl">  a b c d
</span></span><span class="line"><span class="cl">a b c d</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="读取超时" class="heading-element">
  <a href="#%e8%af%bb%e5%8f%96%e8%b6%85%e6%97%b6" class="heading-mark"></a>读取超时</h2><p><a href="https://www.gnu.org/software/gawk/manual/html_node/Read-Timeout.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.gnu.org/software/gawk/manual/html_node/Read-Timeout.html</a></p>
<h2 id="重试读取" class="heading-element">
  <a href="#%e9%87%8d%e8%af%95%e8%af%bb%e5%8f%96" class="heading-mark"></a>重试读取</h2><p><a href="https://www.gnu.org/software/gawk/manual/html_node/Retrying-Input.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.gnu.org/software/gawk/manual/html_node/Retrying-Input.html</a></p>
<h2 id="读取目录" class="heading-element">
  <a href="#%e8%af%bb%e5%8f%96%e7%9b%ae%e5%bd%95" class="heading-mark"></a>读取目录</h2><p>POSIX 标准中，是不能执行从目录读取的，当读取目录时，默认情况下 gawk 会忽略该警告，当使用 <code>--posix</code> 或 <code>--traditional</code> 会恢复警告</p>
<h1 id="打印" class="heading-element">
  <a href="#%e6%89%93%e5%8d%b0" class="heading-mark"></a>打印</h1><p>打印是最常见的操作，通常是输出一部分或全部内容，默认情况输出字段以空格作为分隔符，输出记录以换行符作为分隔符</p>
<h2 id="简单打印-print" class="heading-element">
  <a href="#%e7%ae%80%e5%8d%95%e6%89%93%e5%8d%b0-print" class="heading-mark"></a>简单打印 (print)</h2><p>print 是语句，并不是表达式。该语句简单，只是标准化格式输出。可以以逗号分隔打印多个项（字段）</p>
<ul>
<li>字符或字符串</li>
<li>变量：自定义变量或 awk 变量</li>
<li>数值：数值会以转化为字符串再输出</li>
<li><code>&quot;&quot;</code>：打印空行</li>
<li><code>&quot; &quot;</code> ：引号包围的字符表示是一个项，且内容当成字符串处理；如果没有引号会当成 awk 表达式处理</li>
</ul>
<br/>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk -F &#34;\n&#34; &#39;{print &#34;这是一行：&#34;$1}&#39; file4</span>
</span></span><span class="line"><span class="cl">这是一行：11 <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span> 
</span></span><span class="line"><span class="cl">这是一行：aa bb <span class="nb">cd</span> os iw </span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>示例：冒号之中字符串当成字符处理</li>
</ul>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk &#39;{print &#34;内容行,$0=&#34;,$0}&#39; file4</span>
</span></span><span class="line"><span class="cl">内容行,<span class="nv">$0</span><span class="o">=</span> <span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span>
</span></span><span class="line"><span class="cl">内容行,<span class="nv">$0</span><span class="o">=</span> aa bb <span class="nb">cd</span> os iw</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="高等打印printf" class="heading-element">
  <a href="#%e9%ab%98%e7%ad%89%e6%89%93%e5%8d%b0printf" class="heading-mark"></a>高等打印（printf）</h2><p>printf 是语句，比 print 语句更精准地标准化格式输出</p>
<p>格式控制字符会按照指定格式输出字段</p>
<table>
<thead>
<tr>
<th style="text-align:left">格式控制字符</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>%a</code></td>
<td style="text-align:left">格式为 <code>[-]0xh.hhhhp+-dd</code> 的浮点数，除 <code>gawk</code> 之外基本不支持</td>
</tr>
<tr>
<td style="text-align:left"><code>%A</code></td>
<td style="text-align:left">格式为 <code>[-]0xh.hhhhp+-dd</code> （16进制）的浮点数，除 <code>gawk</code> 之外基本不支持</td>
</tr>
<tr>
<td style="text-align:left"><code>%c</code></td>
<td style="text-align:left">打印数字作为字符， POSIX标准说要打印字符串的第一个字符。在具有多字节字符的语言环境中，gawk尝试将字符串的前导字节转换为有效的宽字符，然后打印该字符的多字节编码。同样，在打印数字值时，gawk允许该值在可以用宽字符保留的值的数字范围内。如果转换为多字节编码失败，请gawk 使用该值的低八位作为要打印的字符</td>
</tr>
<tr>
<td style="text-align:left"><code>%d</code></td>
<td style="text-align:left">打印一个十进制整数</td>
</tr>
<tr>
<td style="text-align:left"><code>%i</code></td>
<td style="text-align:left">打印一个十进制整数</td>
</tr>
<tr>
<td style="text-align:left"><code>%e</code></td>
<td style="text-align:left">以科学计数法的指数打印数字</td>
</tr>
<tr>
<td style="text-align:left"><code>%E</code></td>
<td style="text-align:left">以科学计数法的指数打印数字</td>
</tr>
<tr>
<td style="text-align:left"><code>%f</code></td>
<td style="text-align:left">以浮点数打印数字</td>
</tr>
<tr>
<td style="text-align:left"><code>%F</code></td>
<td style="text-align:left">以浮点数打印数字，但无穷大和非数值字符使用大写拼写</td>
</tr>
<tr>
<td style="text-align:left"><code>%g</code></td>
<td style="text-align:left">以科学计数法或浮点数计数法打印字符，以较少的字符为准，如果也科学计数法打印，使用 <code>e</code></td>
</tr>
<tr>
<td style="text-align:left"><code>%G</code></td>
<td style="text-align:left">以科学计数法或浮点数计数法打印字符，以较少的字符为准，如果也科学计数法打印，使用 <code>E</code></td>
</tr>
<tr>
<td style="text-align:left"><code>%o</code></td>
<td style="text-align:left">打印无符号的八进制字符</td>
</tr>
<tr>
<td style="text-align:left"><code>%s</code></td>
<td style="text-align:left">打印字符串</td>
</tr>
<tr>
<td style="text-align:left"><code>%u</code></td>
<td style="text-align:left">打印无符号的十进制字符</td>
</tr>
<tr>
<td style="text-align:left"><code>%x</code></td>
<td style="text-align:left">打印无符号的十六进制字符，字符使用小写 <code>a-f</code></td>
</tr>
<tr>
<td style="text-align:left"><code>%X</code></td>
<td style="text-align:left">打印无符号的十六进制字符，字符使用大写 <code>A-F</code></td>
</tr>
<tr>
<td style="text-align:left"><code>%%</code></td>
<td style="text-align:left">打印单个 <code>%</code>，且会忽略所有修饰符</td>
</tr>
<tr>
<td style="text-align:left"><code>n$</code></td>
<td style="text-align:left">一个整数常量，后跟一个 <code>$</code> 是位置说明符。通常，格式规范按照格式字符串中给定的顺序应用于自变量。使用位置说明符，格式说明将应用于特定的参数，而不是列表中的下一个参数。位置说明符从一开始计数</td>
</tr>
<tr>
<td style="text-align:left"><code>-</code></td>
<td style="text-align:left">表示左对齐</td>
</tr>
<tr>
<td style="text-align:left"><code>space</code></td>
<td style="text-align:left">对于数值转换，正数前面留空格，负数前面使用 <code>-</code> 表示负数</td>
</tr>
<tr>
<td style="text-align:left"><code>+</code></td>
<td style="text-align:left">格式化为正数，也始终为数字转换提供一个符号。<code>+</code> 会覆盖空格修饰符</td>
</tr>
<tr>
<td style="text-align:left"><code>#</code></td>
<td style="text-align:left">对某些控制字母使用“替代形式”。对于％o<code>，提供前导零。对于％X</code>和<code>％X</code>，提供领导<code>0x</code> 要么 <code>0X</code>表示非零结果。对于％e<code>，</code>％E<code>，</code>％F<code>和</code>％F<code>，结果始终包含小数点。对于</code>％G<code>和</code>％G`，则不会从结果中删除尾随零</td>
</tr>
<tr>
<td style="text-align:left"><code>0</code></td>
<td style="text-align:left">领先的0&rsquo;（零）用作标志，指示应在输出中填充零而不是空格。这仅适用于数字输出格式。仅当字段宽度大于要打印的值时，此标志才有效</td>
</tr>
<tr>
<td style="text-align:left"><code>'</code></td>
<td style="text-align:left">单引号或撇号字符是ISO C的POSIX扩展。它指示浮点值的整数部分或整数十进制值的整个部分中应包含一个千位分隔符。这仅在支持此类字符的语言环境中起作用</td>
</tr>
<tr>
<td style="text-align:left"><code>%n</code></td>
<td style="text-align:left">n 是一个数值，用于指定所需的最小字段宽度。在<code>％</code>符号和格式控制字符会强制字段扩展到该宽度。执行此操作的默认方法是在左侧填充空格；值是最小宽度，而不是最大宽度。如果项目值需要的宽度字符以上，则可以根据需要设置宽度</td>
</tr>
<tr>
<td style="text-align:left"><code>.</code></td>
<td style="text-align:left"><code>.</code> 后面更着一个常数，指定打印的精度，精度和以下控制字符有关 <br/> - <code>%d，%i，%o，%u，%x，%X</code> 这些打印最小位数 <br/> - <code>%e，%E，%f，%F</code> 这些指定小数点右边的位数 <br/> - <code>%g， %G</code> 这些有效最大位数 <br/> - <code>%s</code> 字符串中应打印的最大字符数</td>
</tr>
</tbody>
</table>
<br/>
<ul>
<li>示例：左对齐第一列和第二列</li>
</ul>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># %-10s 表示左对齐10个字符串宽度，多余的字符串位置用空格填补</span>
</span></span><span class="line"><span class="cl"><span class="c1"># %s\n 表达打印换行符</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;{ printf &#34;%-10s %s\n&#34;, $1, $2 }&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span>         <span class="m">22</span>
</span></span><span class="line"><span class="cl">aa         bb
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span> os iw</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="字段输出分隔符" class="heading-element">
  <a href="#%e5%ad%97%e6%ae%b5%e8%be%93%e5%87%ba%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>字段输出分隔符</h2><p>默认情况下字段输出使用空格作为分隔符，可以使用 <code>OFS</code> 变量改变该值</p>
<h2 id="记录输出分割符" class="heading-element">
  <a href="#%e8%ae%b0%e5%bd%95%e8%be%93%e5%87%ba%e5%88%86%e5%89%b2%e7%ac%a6" class="heading-mark"></a>记录输出分割符</h2><p>默认情况下记录输出使用换行符作为分隔符，可以使用 <code>ORS</code> 变量改变该值：</p>
<h2 id="输出重定向" class="heading-element">
  <a href="#%e8%be%93%e5%87%ba%e9%87%8d%e5%ae%9a%e5%90%91" class="heading-mark"></a>输出重定向</h2><p>这里是指 print 或 printf 语句的输出重定向，有以下重定向方式：</p>
<ul>
<li><code>&gt;</code> ：重定向到文件，如果文件不存在，则创建文件；可以使用 awk 表达式，awk 会转化为字符串作为文件名称</li>
<li><code>&gt;&gt;</code> ： 追加到文件，如果文件不存在，则创建文件；可以使用 awk 表达式，awk 会转化为字符串作为文件名称</li>
<li><code>|</code> ：管道符，将输出结果传递给另一个命令，重定向参数命令实际上是一个awk 表达式。其值将转换为字符串，其内容将给出要运行的 shell 命令</li>
<li><code>|&amp;</code> ：类似 <code>|</code> ，但以使用getline读取命令的输出。因此，命令是一个协同过程，它与awk程序一起工作但又作为其附属程序</li>
</ul>
<p>使用重定向的一种特别有效的方法是构建命令行并将它们通过管道传递到Shell中sh</p>
<br/>
<ul>
<li>示例：假设您有一个从系统中移过来的文件列表，其中所有文件名都以大写形式存储，并且您希望将它们重命名为所有小写形式的名称。以下程序既简单又有效</li>
</ul>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">{</span> printf<span class="o">(</span><span class="s2">&#34;mv %s %s\n&#34;</span>, <span class="nv">$0</span>, tolower<span class="o">(</span><span class="nv">$0</span><span class="o">))</span> <span class="p">|</span> <span class="s2">&#34;sh&#34;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">END <span class="o">{</span> close<span class="o">(</span><span class="s2">&#34;sh&#34;</span><span class="o">)</span> <span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="变量" class="heading-element">
  <a href="#%e5%8f%98%e9%87%8f" class="heading-mark"></a>变量</h1><h2 id="自定义变量" class="heading-element">
  <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%8f%98%e9%87%8f" class="heading-mark"></a>自定义变量</h2><p>变量名必须是字母，数字或下划线的序列，并且不能以数字开头，变量不需要初始化，可以直接定义使用。变量值可以是字符串或数值，可以在变量周期内被改变，默认情况下变量初始化为空字符串，如果转换为数值，则为 0</p>
<p>变量可以使用 <code>-v</code> 选项定义，也可以在 awk 中定义，<code>-v</code> 选项可以把外部变量的值赋值给 awk 变量</p>
<br/>
<ul>
<li>示例：定义变量</li>
</ul>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># -v 定义了变量 n ，因此 file1 打印 $1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 读取完 file1 之后 n=2</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 读取 File2 时打印 $2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk -v n=1 &#39;{ print $n }&#39;  file1 n=2 file2</span>
</span></span><span class="line"><span class="cl">aa
</span></span><span class="line"><span class="cl"><span class="m">12</span>
</span></span><span class="line"><span class="cl">b2
</span></span><span class="line"><span class="cl">2b
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 等效上述命令</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk   &#39;{ print $n }&#39;  n=1 file1 n=2 file2</span>
</span></span><span class="line"><span class="cl">aa
</span></span><span class="line"><span class="cl"><span class="m">12</span>
</span></span><span class="line"><span class="cl">b2
</span></span><span class="line"><span class="cl">2b</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>示例：为初始化的变量</li>
</ul>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># n 没有定义，为空</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk  &#39;{ print $n }&#39;  file2</span>
</span></span><span class="line"><span class="cl">a1 b2 c3 d4
</span></span><span class="line"><span class="cl">1a 2b 3c 4d</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="内置变量" class="heading-element">
  <a href="#%e5%86%85%e7%bd%ae%e5%8f%98%e9%87%8f" class="heading-mark"></a>内置变量</h2><p>gawk 自带的变量</p>
<h3 id="指定对所有-io使用二进制模式" class="heading-element">
  <a href="#%e6%8c%87%e5%ae%9a%e5%af%b9%e6%89%80%e6%9c%89-io%e4%bd%bf%e7%94%a8%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%a8%a1%e5%bc%8f" class="heading-mark"></a>指定对所有 I/O使用二进制模式</h3><p><code>BINMODE</code> 变量在非POSIX系统上，此变量指定对所有 <code>I/O</code> 使用二进制模式</p>
<p>数字值1、2或3指定输入文件，输出文件或所有文件分别应使用二进制I / O。小于零的数值视为零，大于三的数值视为三。或者，字符串值&quot;r&quot;或&quot;w&quot;指定输入文件和输出文件应分别使用二进制I / O。字符串值&quot;rw&quot;或 &ldquo;wr&quot;表示所有文件应使用二进制I / O。其他任何字符串值都与相同&quot;rw&rdquo;，但会导致gawk 生成警告消息</p>
<h3 id="数字转换字符串" class="heading-element">
  <a href="#%e6%95%b0%e5%ad%97%e8%bd%ac%e6%8d%a2%e5%ad%97%e7%ac%a6%e4%b8%b2" class="heading-mark"></a>数字转换字符串</h3><p><code>CONVFMT</code> 变量值为一个字符串，用于控制数值到字符串的转换。实际上是通过 <code>sprintf()</code>函数的第一个参数传递。 默认值为 <code>%.6g</code></p>
<p>旧的版本中使用 <code>0FMT</code> 变量</p>
<h3 id="固定列边界" class="heading-element">
  <a href="#%e5%9b%ba%e5%ae%9a%e5%88%97%e8%be%b9%e7%95%8c" class="heading-mark"></a>固定列边界</h3><p>gawk 扩展</p>
<p><code>FIELDWIDTHS</code> 变量值是用空格分隔的列表，以固定宽度显示字段，会覆盖 <code>FS</code> 和 <code>FPAT</code> 变量</p>
<p>从版本4.2开始，每个字段宽度都可以选择以冒号分隔的值开头，该值指定在字段开始之前要跳过的字符数</p>
<h3 id="创建字段" class="heading-element">
  <a href="#%e5%88%9b%e5%bb%ba%e5%ad%97%e6%ae%b5" class="heading-mark"></a>创建字段</h3><p>gawk 扩展</p>
<p><code>FPAT</code> 变量值为正则表达式字，匹配该表达式的内容作为一个字段，会覆盖 <code>FS</code> 和 <code>FIELDWIDTHS</code> 变量</p>
<h3 id="字段分隔符" class="heading-element">
  <a href="#%e5%ad%97%e6%ae%b5%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>字段分隔符</h3><p><code>FS</code>变量值为单字符或正则表达式，指定输入字段分隔符，如果值为空（<code>&quot;&quot;</code>），则每个字符串都是一个字段</p>
<p>默认值为单个空格，该值有特色情况，不仅仅表示单个空格，还包含制表符、换行符；记录开头和结尾处的空格、制表符、换行符都会被忽略</p>
<h3 id="匹配时忽略大小写" class="heading-element">
  <a href="#%e5%8c%b9%e9%85%8d%e6%97%b6%e5%bf%bd%e7%95%a5%e5%a4%a7%e5%b0%8f%e5%86%99" class="heading-mark"></a>匹配时忽略大小写</h3><p>gawk 扩展</p>
<p><code>IGNORECASE</code> 变量值非零或非空时，所有字符串比较和所有正则表达式匹配均不区分大小写</p>
<p>在 gawk 处于兼容模式时无效</p>
<h3 id="输出字段分隔符" class="heading-element">
  <a href="#%e8%be%93%e5%87%ba%e5%ad%97%e6%ae%b5%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>输出字段分隔符</h3><p><code>OFS</code> 变量值为字符串，指定输出字段分隔符，它在print语句打印的字段之间输出。它的默认值是由单个空格组成的字符串</p>
<h3 id="输出记录分隔符" class="heading-element">
  <a href="#%e8%be%93%e5%87%ba%e8%ae%b0%e5%bd%95%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>输出记录分隔符</h3><p><code>RS</code> 输出记录分隔符。在每个print语句的末尾输出 。其默认值为换行符</p>
<h3 id="浮点数精度" class="heading-element">
  <a href="#%e6%b5%ae%e7%82%b9%e6%95%b0%e7%b2%be%e5%ba%a6" class="heading-mark"></a>浮点数精度</h3><p>gawk 扩展</p>
<p>任意精度浮点数的工作精度，默认为53位</p>
<h3 id="数字进度舍入模式" class="heading-element">
  <a href="#%e6%95%b0%e5%ad%97%e8%bf%9b%e5%ba%a6%e8%88%8d%e5%85%a5%e6%a8%a1%e5%bc%8f" class="heading-mark"></a>数字进度舍入模式</h3><p>gawk 扩展</p>
<p>默认情况下，用于数字上的任意精度算术的舍入模式&quot;N&quot;</p>
<h3 id="输入记录分隔符" class="heading-element">
  <a href="#%e8%be%93%e5%85%a5%e8%ae%b0%e5%bd%95%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>输入记录分隔符</h3><p><code>RS</code> 变量的默认值是一个包含单个换行符的字符串，因此输入记录由一行文本组成。它也可以是空字符串，在这种情况下，记录由空白行分隔。如果它是一个正则表达式，则记录由输入文本中正则表达式的匹配项分隔</p>
<p>如果 gawk 处于兼容模式下，该变量值只能是一个字符</p>
<h3 id="下标分隔符" class="heading-element">
  <a href="#%e4%b8%8b%e6%a0%87%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>下标分隔符</h3><p>下标分隔符。它的默认值 <code>\034</code> =用于分隔多维数组的索引部分。因此，表达式<code>foo [“ A”，“ B”]</code> 确实可以访问 <code>foo[&quot;A\034B&quot;]</code></p>
<h3 id="源文本中特别标记的字符串常量默认的文本域" class="heading-element">
  <a href="#%e6%ba%90%e6%96%87%e6%9c%ac%e4%b8%ad%e7%89%b9%e5%88%ab%e6%a0%87%e8%ae%b0%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%b8%b8%e9%87%8f%e9%bb%98%e8%ae%a4%e7%9a%84%e6%96%87%e6%9c%ac%e5%9f%9f" class="heading-mark"></a>源文本中特别标记的字符串常量默认的文本域</h3><p>用于该awk级别程序的国际化 。它设置在源文本中特别标记的字符串常量默认的文本域，以及为 dcgettext()，dcngettext()，和bindtextdomain()功能（见国际同gawk）。默认值TEXTDOMAIN是&quot;messages&quot;。</p>
<h3 id="命令行参数" class="heading-element">
  <a href="#%e5%91%bd%e4%bb%a4%e8%a1%8c%e5%8f%82%e6%95%b0" class="heading-mark"></a>命令行参数</h3><p>awk程序可用的命令行参数存储在名为的数组中ARGV。 ARGC是存在的命令行参数的数量，与大多数awk数组不同， ARGV索引从0到ARGC-1</p>
<p>值ARGV[0]可能因系统而异。另外，您应该注意，程序文本不包含在中ARGV，任何awk的命令行选项也不包含</p>
<p><a href="https://www.gnu.org/software/gawk/manual/html_node/ARGC-and-ARGV.html"target="_blank" rel="external nofollow noopener noreferrer">https://www.gnu.org/software/gawk/manual/html_node/ARGC-and-ARGV.html</a></p>
<h3 id="当前文件索引" class="heading-element">
  <a href="#%e5%bd%93%e5%89%8d%e6%96%87%e4%bb%b6%e7%b4%a2%e5%bc%95" class="heading-mark"></a>当前文件索引</h3><blockquote>
<p>gawk 扩展</p>
</blockquote>
<p><code>ARGIND</code> 变量值为正在处理文件索引，每次gawk打开一个新的数据文件进行处理时，它都会设置 ARGIND为ARGV文件名的索引。因此在gawk处理输入文件时，<code>FILENAME == ARGV [ARGIND]</code></p>
<p>虽然可以ARGIND在awk 程序中更改的值，但在gawk打开下一个文件时会自动将其设置为新值</p>
<h3 id="环境变量" class="heading-element">
  <a href="#%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f" class="heading-mark"></a>环境变量</h3><p><code>ENVIRON</code> 变量包含环境值的关联数组。数组索引是环境变量名称。元素是特定环境变量的值。对于POSIX而言awk，更改此数组不会影响传递给任何awk可能通过重定向或system()功能产生的程序的环境</p>
<p>这也会影响正在运行的gawk程序，因为某些内置函数可能会注意某些环境变量</p>
<p>从4.2版开始，如果未处于POSIX兼容模式，则更改gawk时会更新其自身的环境 ENVIRON，从而更改其创建的程序所看到的环境</p>
<h3 id="错误信息" class="heading-element">
  <a href="#%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af" class="heading-mark"></a>错误信息</h3><blockquote>
<p>gawk 扩展</p>
</blockquote>
<p>如果在重定向getline期间，读取期间<code>getline</code>或<code>close()</code>操作期间发生系统错误，则 <code>ERRNO</code>变量包含描述错误的字符串</p>
<p>在打开每个命令行输入文件之前gawk清除ERRNO。这样可以检查文件在BEGINFILE模式内是否可读</p>
<h3 id="输入文件名" class="heading-element">
  <a href="#%e8%be%93%e5%85%a5%e6%96%87%e4%bb%b6%e5%90%8d" class="heading-mark"></a>输入文件名</h3><p><code>FILENAME</code> 变量值为当前输入的文件名称，如果命令行上未列出任何数据文件，awk则从标准输入中读取并 <code>FILENAME</code> 设置为 <code>-</code>。 FILENAME每次读取新文件时都会更改内部BEGIN 规则，也就是 <code>FILENAME</code> 为空，因为没有输入文件被尚未处理。不过，在规则内使用getline BEGIN可以提供FILENAME值</p>
<h3 id="当前记录号" class="heading-element">
  <a href="#%e5%bd%93%e5%89%8d%e8%ae%b0%e5%bd%95%e5%8f%b7" class="heading-mark"></a>当前记录号</h3><p><code>FNR</code> 变量当前文件中的当前记录号。 每次读取新记录时都会awk递增 FNR（请参见如何将输入拆分为记录）。 每次启动新的输入文件时awk重置FNR为零</p>
<h3 id="字段数量" class="heading-element">
  <a href="#%e5%ad%97%e6%ae%b5%e6%95%b0%e9%87%8f" class="heading-mark"></a>字段数量</h3><p><code>NF</code> 当前输入记录中的字段数。 NF每次读取新记录，创建新字段或$0更改字段时都会设置设置（请参见检查字段）</p>
<p>与本小节中描述的大多数变量不同，为分配值NF可能会影响 awk的内部工作。特别是，分配to NF可以用于在当前记录中创建字段或从当前记录中删除字段</p>
<h3 id="函数名称" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0%e5%90%8d%e7%a7%b0" class="heading-mark"></a>函数名称</h3><p><code>FUNCTAB</code> 变量值是一个数组，其索引和对应值是程序中所有内置，用户定义和扩展函数的名称</p>
<h1 id="表达式" class="heading-element">
  <a href="#%e8%a1%a8%e8%be%be%e5%bc%8f" class="heading-mark"></a>表达式</h1><p>有空推到重写，内容缺失严重</p>
<p>表达式是 awk 模式和动作的基本构建块。表达式的计算结果为可以打印，测试或传递给函数的值。此外，表达式可以使用赋值运算符将新值赋给变量或字段</p>
<p>表达式本身可以用作模式或动作语句。大多数其他类型的语句包含一个或多个表达式，这些表达式指定要对其进行操作的数据。与其他语言一样，中的表达式awk可以包括变量，数组引用，常量和函数调用，以及它们与各种运算符的组合</p>
<p>常量：</p>
<ul>
<li>数值：数字，可以是整数、十进制小数、科学计数法的指数形式</li>
<li>字符串：被冒号包含的字符，可以是任意长度，可以含有 8 bit 的 ASCII 码（包含 ASCII NU</li>
</ul>
<h2 id="字符串和数字转换" class="heading-element">
  <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%92%8c%e6%95%b0%e5%ad%97%e8%bd%ac%e6%8d%a2" class="heading-mark"></a>字符串和数字转换</h2><p>如果字符串做数学运算时，当成变量处理，会自动替换为变量值。数字转换为字符串需要使用引号；字符串转换为数字时，需要在字符串前面添加一个0，如果字符无法解析为数字，无法解析的字符会忽略掉</p>
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk &#39;BEGIN{ ta=1; tb=2; print( tb ta ) - tb, 25fix, 025fix, 7ss, 1e3}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">19</span> <span class="m">25</span> <span class="m">21</span> <span class="m">7</span> <span class="m">1000</span></span></span></code></pre></td></tr></table>
</div>
</div><p>数字和字符转换时，由于地区不同小数点和千位分割符也不同（有的使用逗号，有的使用点）。POSIX 规范规定，awk 执行 awk 操作和读取文件时，用小数点作为分隔符,然而，解释输入数据，因为当 print 和 printf 输出，以及用于数到字符串的转换，则使用本地小数点字符，可以使用 <code>--posix</code> 或 <code>POSIXLY_CORRECT</code> 环境变量强制使用点作为分隔符</p>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 强制使用 POSIX 规范</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># export POSIXLY_CORRECT=1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk &#39;BEGIN { printf &#34;%g\n&#34;, 3.1415927 }&#39;</span>
</span></span><span class="line"><span class="cl">3.14159
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># LC_ALL=en_DK.utf-8 gawk &#39;BEGIN { printf &#34;%g\n&#34;, 3.1415927 }&#39;</span>
</span></span><span class="line"><span class="cl">3,14159
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1">#  gawk &#39;BEGIN { printf &#34;%g\n&#34;, 3.1415927 }&#39;</span>
</span></span><span class="line"><span class="cl">3.14159
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo 4,321 | gawk &#39;{ print $1 + 1 }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">5</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo 4,321 | LC_ALL=en_DK.utf-8 gawk &#39;{ print $1 + 1 }&#39;</span>
</span></span><span class="line"><span class="cl">5,321</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="算术运算" class="heading-element">
  <a href="#%e7%ae%97%e6%9c%af%e8%bf%90%e7%ae%97" class="heading-mark"></a>算术运算</h2><p>awk 按照从上往下的优先级运算</p>
<table>
<thead>
<tr>
<th style="text-align:left">运算符</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>x ^ y</code></td>
<td style="text-align:left">求幂，在 POSIX 标准中规范使用，方便移植</td>
</tr>
<tr>
<td style="text-align:left"><code>x ** y</code></td>
<td style="text-align:left">求幂</td>
</tr>
<tr>
<td style="text-align:left"><code>- x</code></td>
<td style="text-align:left">negation</td>
</tr>
<tr>
<td style="text-align:left"><code>+ x</code></td>
<td style="text-align:left">(优先级与 -x 相同) Unary plus; the expression is converted to a number</td>
</tr>
<tr>
<td style="text-align:left"><code>x * y</code></td>
<td style="text-align:left">乘法</td>
</tr>
<tr>
<td style="text-align:left"><code>x / y</code></td>
<td style="text-align:left">（优先级与乘法相同）	除法</td>
</tr>
<tr>
<td style="text-align:left"><code>x % y</code></td>
<td style="text-align:left">求余（商）, x 为负数时，商为负数</td>
</tr>
<tr>
<td style="text-align:left"><code>x + y</code></td>
<td style="text-align:left">加法</td>
</tr>
<tr>
<td style="text-align:left"><code>x - y</code></td>
<td style="text-align:left">（优先级与加法相同）减法</td>
</tr>
</tbody>
</table>
<p>当混合运算时，需要使用跨号</p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { print -12 &#34; &#34; -24 }&#39;</span>
</span></span><span class="line"><span class="cl">-12-24
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { print -12 &#34; &#34; (-24) }&#39;</span>
</span></span><span class="line"><span class="cl">-12 -24</span></span></code></pre></td></tr></table>
</div>
</div><p>变量可以使用类似运算符方式赋值</p>
<table>
<thead>
<tr>
<th style="text-align:left">表达式</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>变量 += 值</code></td>
<td style="text-align:left">变量值基础上增加值</td>
</tr>
<tr>
<td style="text-align:left"><code>变量 -= 值</code></td>
<td style="text-align:left">变量值基础上减少值</td>
</tr>
<tr>
<td style="text-align:left"><code>变量 *= 值</code></td>
<td style="text-align:left">变量值基础上乘以值</td>
</tr>
<tr>
<td style="text-align:left"><code>变量 /= 值</code></td>
<td style="text-align:left">变量值基础上除以值</td>
</tr>
<tr>
<td style="text-align:left"><code>变量 ^= 值</code></td>
<td style="text-align:left">变量值基础上求幂运算</td>
</tr>
<tr>
<td style="text-align:left"><code>变量 ** = 值</code></td>
<td style="text-align:left">变量值基础上求幂运算</td>
</tr>
<tr>
<td style="text-align:left"><code>变量 %= 值</code></td>
<td style="text-align:left">变量值基础上与值求余</td>
</tr>
<tr>
<td style="text-align:left"><code>变量++</code></td>
<td style="text-align:left">变量值+1，变量值不会变</td>
</tr>
<tr>
<td style="text-align:left"><code>++变量</code></td>
<td style="text-align:left">变量值+1，变量值会改变</td>
</tr>
<tr>
<td style="text-align:left"><code>--变量</code></td>
<td style="text-align:left">变量值-1，变量值会改变</td>
</tr>
<tr>
<td style="text-align:left"><code>++变量</code></td>
<td style="text-align:left">变量值-1，变量值不会变</td>
</tr>
</tbody>
</table>
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 添加变量值</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { ta = a; ta +=b ; print ta }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { ta = 2; ta +=1 ; print ta }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { ta = 3; b = ++ta ; print ta,b }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">4</span> <span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { ta = 3; b = ta++ ; print ta,b }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">4</span> <span class="m">3</span></span></span></code></pre></td></tr></table>
</div>
</div><p>官方反馈递增不同版本结果不一样，要避免这种使用方式</p>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { ta = 6; ta += ta++ + ++ta ; print ta }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">22</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;BEGIN { ta = 6; ta += ta++  ; print ta }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">13</span></span></span></code></pre></td></tr></table>
</div>
</div><p>比较运算符表达式</p>
<table>
<thead>
<tr>
<th style="text-align:left">表达式</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>x&lt;y</code></td>
<td style="text-align:left">x 小于 y ，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>x&gt;y</code></td>
<td style="text-align:left">x 大于 y ，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>x==y</code></td>
<td style="text-align:left">x 等于 y ，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>x!=y</code></td>
<td style="text-align:left">x 不等于 y ，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>x&gt;=y</code></td>
<td style="text-align:left">x 大于或等于 y，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>x&lt;=y</code></td>
<td style="text-align:left">x 小于或等于 y，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>x~y</code></td>
<td style="text-align:left">字符串 x 匹配表达式 y，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>x!~y</code></td>
<td style="text-align:left">字符串 x 不匹配表达式 y，为 true</td>
</tr>
<tr>
<td style="text-align:left"><code>subscript in array</code></td>
<td style="text-align:left">数值 array 中有下标 subscript ，为 true</td>
</tr>
</tbody>
</table>
<p>通过比较每个字符串的第一个字符，然后比较每个字符串的第二个字符等来比较字符串。因此，&ldquo;10&quot;小于&quot;9&rdquo;。如果有两个字符串，其中一个是另一个的前缀，则较短的字符串小于较长的字符串。因此，&ldquo;abc&quot;小于&quot;abcd&rdquo;</p>
<br/>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo 1e2 3 | awk &#39;{ print ($1 &lt; $2) ? &#34;true&#34; : &#34;false&#34; }&#39;</span>
</span></span><span class="line"><span class="cl">false</span></span></code></pre></td></tr></table>
</div>
</div><p>由于 == 操作员检查字符串是否相同，而不是是否相等排序，因此需要检查字符串是否相等排序的应用程序可以使用以下方式</p>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">a &lt;<span class="o">=</span> b <span class="o">&amp;&amp;</span> a&gt; <span class="o">=</span> b</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="字符串类型和数值类型比较" class="heading-element">
  <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%b1%bb%e5%9e%8b%e5%92%8c%e6%95%b0%e5%80%bc%e7%b1%bb%e5%9e%8b%e6%af%94%e8%be%83" class="heading-mark"></a>字符串类型和数值类型比较</h2><p>看不懂：https://www.gnu.org/software/gawk/manual/html_node/Variable-Typing.html</p>
<p>用户输入的数字其实是字符串，但是“像”数值，因此当数值比较，看着“像”字符串当成字符串比较，这是故意“矫正”的</p>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">        +----------------------------------------------
</span></span><span class="line"><span class="cl">        <span class="p">|</span>       STRING          NUMERIC         STRNUM
</span></span><span class="line"><span class="cl">--------+----------------------------------------------
</span></span><span class="line"><span class="cl">        <span class="p">|</span>
</span></span><span class="line"><span class="cl">STRING  <span class="p">|</span>       string          string          string
</span></span><span class="line"><span class="cl">        <span class="p">|</span>
</span></span><span class="line"><span class="cl">NUMERIC <span class="p">|</span>       string          numeric         numeric
</span></span><span class="line"><span class="cl">        <span class="p">|</span>
</span></span><span class="line"><span class="cl">STRNUM  <span class="p">|</span>       string          numeric         numeric
</span></span><span class="line"><span class="cl">--------+----------------------------------------------</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>判断输入是什么类型</li>
</ul>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo hello 37 | gawk &#39;{ print typeof($1), typeof($2) }&#39;</span>
</span></span><span class="line"><span class="cl">string strnum</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>示例：字符串和数值比较</li>
</ul>
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 1 表示成立</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 0 表示不成立</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{print typeof($1)}&#39;</span>
</span></span><span class="line"><span class="cl">strnum
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($0 == &#34; +3.14&#34;) }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($0 == &#34;+3.14&#34;) }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($0 == &#34;3.14&#34;) }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($0 == 3.14) }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($1 == &#34; +3.14&#34;) }&#39; </span>
</span></span><span class="line"><span class="cl"><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($1 == &#34;+3.14&#34;) }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($1 == &#34;3.14&#34;) }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># echo &#39; +3.14&#39; | awk &#39;{ print($1 == 3.14) }&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="数组" class="heading-element">
  <a href="#%e6%95%b0%e7%bb%84" class="heading-mark"></a>数组</h1><p><code>gawk</code> 为了在单个变量中存储多个值，使用关联数组提供该功能。关联数组的索引值可以的任意文本的字符串</p>
<p>定义数组的格式：<code>变量名称[索引] = 值</code></p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">capital<span class="o">[</span><span class="s2">&#34;Illinois&#34;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&#34;Springfield&#34;</span>
</span></span><span class="line"><span class="cl">capital<span class="o">[</span><span class="s2">&#34;Indiana&#34;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&#34;Indianapolis&#34;</span>
</span></span><span class="line"><span class="cl">capital<span class="o">[</span><span class="s2">&#34;Ohio&#34;</span><span class="o">]</span> <span class="o">=</span> <span class="s2">&#34;Columbus&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>引用方式也很简单，只需要使用变量时包含索引就行</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-33"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># gawk &#39;BEGIN{</span>
</span></span><span class="line"><span class="cl">var<span class="o">[</span>var1<span class="o">]</span> <span class="o">=</span> <span class="s2">&#34;gawk&#34;</span>
</span></span><span class="line"><span class="cl">print var<span class="o">[</span>var1<span class="o">]</span> <span class="o">}</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl">gawk</span></span></code></pre></td></tr></table>
</div>
</div><p>for 语句可以遍历数组，索引值不会按照特定顺序返回，但能够指向对应的数据元素值</p>
<div class="highlight" id="id-34"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> <span class="o">(</span>变量名称 in 数组名称<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">  操作
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-35"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 如果索引为数值时，按从小到大排序</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@xiaosi ~<span class="o">]</span><span class="c1"># gawk &#39;BEGIN{ var[1]=&#34;a&#34;; var[2]=&#34;b&#34; ;var[3]=&#34;c&#34; ;for (i in var) {  print &#34;index:&#34;,i,&#34;, value: &#34;,var[i]}}&#39;</span>
</span></span><span class="line"><span class="cl">index: <span class="m">1</span> , value:  a
</span></span><span class="line"><span class="cl">index: <span class="m">2</span> , value:  b
</span></span><span class="line"><span class="cl">index: <span class="m">3</span> , value:  c</span></span></code></pre></td></tr></table>
</div>
</div><p>删除数组变量需要使用这种格式：<code>delete 变量[索引]</code></p>
<h1 id="陈述语句" class="heading-element">
  <a href="#%e9%99%88%e8%bf%b0%e8%af%ad%e5%8f%a5" class="heading-mark"></a>陈述语句</h1><p>在 awk 中，任何非零数值或非空的字符串都是 ture；空字符串和数值0为 false</p>
<div class="highlight" id="id-36"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk -f gawk </span>
</span></span><span class="line"><span class="cl">A strange truth value
</span></span><span class="line"><span class="cl">B strange truth value
</span></span><span class="line"><span class="cl">C strange truth value
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat gawk </span>
</span></span><span class="line"><span class="cl"><span class="c1">#xiaosi/2020-07-15 14:40:07</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 文件: gawk</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="o">(</span>3.1415927<span class="o">)</span>
</span></span><span class="line"><span class="cl">       print <span class="s2">&#34;A strange truth value&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="o">(</span><span class="s2">&#34;Four Score And Seven Years Ago&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">       print <span class="s2">&#34;B strange truth value&#34;</span>
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="o">(</span><span class="nv">j</span> <span class="o">=</span> 57<span class="o">)</span>
</span></span><span class="line"><span class="cl">       print <span class="s2">&#34;C strange truth value&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="if-then-语句" class="heading-element">
  <a href="#if-then-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>if-then 语句</h2><p>格式：<code>if (condition) then-body [else else-body]</code></p>
<br/>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-37"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span>x % <span class="nv">2</span> <span class="o">==</span> 0<span class="o">)</span>
</span></span><span class="line"><span class="cl">    print <span class="s2">&#34;x is even&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">    print <span class="s2">&#34;x is odd&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">(</span>x % <span class="nv">2</span> <span class="o">==</span> 0<span class="o">)</span> print <span class="s2">&#34;x is even&#34;</span><span class="p">;</span> <span class="k">else</span>
</span></span><span class="line"><span class="cl">        print <span class="s2">&#34;x is odd&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="while-语句" class="heading-element">
  <a href="#while-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>while 语句</h2><p>格式</p>
<div class="highlight" id="id-38"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">while</span> <span class="o">(</span>condition<span class="o">){</span>
</span></span><span class="line"><span class="cl">  body
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-39"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">awk <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">{
</span></span></span><span class="line"><span class="cl"><span class="s1">    i = 1
</span></span></span><span class="line"><span class="cl"><span class="s1">    while (i &lt;= 3) {
</span></span></span><span class="line"><span class="cl"><span class="s1">        print $i
</span></span></span><span class="line"><span class="cl"><span class="s1">        i++
</span></span></span><span class="line"><span class="cl"><span class="s1">    }
</span></span></span><span class="line"><span class="cl"><span class="s1">}&#39;</span> inventory-shipped</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="do-while" class="heading-element">
  <a href="#do-while" class="heading-mark"></a>do-while</h2><p>do 结构执行成功，则循环 while 语句</p>
<p>格式：</p>
<div class="highlight" id="id-40"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  body
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">(</span>condition<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-41"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">i</span> <span class="o">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        print <span class="nv">$0</span>
</span></span><span class="line"><span class="cl">        i++
</span></span><span class="line"><span class="cl">    <span class="o">}</span> <span class="k">while</span> <span class="o">(</span>i &lt;<span class="o">=</span> 10<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="for" class="heading-element">
  <a href="#for" class="heading-mark"></a>for</h2><p>格式：</p>
<div class="highlight" id="id-42"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> <span class="o">(</span>initialization<span class="p">;</span> condition<span class="p">;</span> increment<span class="o">)</span>
</span></span><span class="line"><span class="cl">  body</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-43"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">awk <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">{
</span></span></span><span class="line"><span class="cl"><span class="s1">    for (i = 1; i &lt;= 3; i++)
</span></span></span><span class="line"><span class="cl"><span class="s1">        print $i
</span></span></span><span class="line"><span class="cl"><span class="s1">}&#39;</span> inventory-shipped
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">(</span><span class="nv">i</span> <span class="o">=</span> 1<span class="p">;</span> i &lt;<span class="o">=</span> 100<span class="p">;</span> i *<span class="o">=</span> 2<span class="o">)</span>
</span></span><span class="line"><span class="cl">    print i
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># for 是 while 缩写</span>
</span></span><span class="line"><span class="cl">initialization
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">(</span>condition<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  body
</span></span><span class="line"><span class="cl">  increment
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># for 遍历</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">(</span>i in array<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span> something with array<span class="o">[</span>i<span class="o">]</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="switch" class="heading-element">
  <a href="#switch" class="heading-mark"></a>switch</h2><p>格式：</p>
<div class="highlight" id="id-44"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">switch <span class="o">(</span>expression<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> value or regular expression:
</span></span><span class="line"><span class="cl">    <span class="k">case</span>-body
</span></span><span class="line"><span class="cl">default:
</span></span><span class="line"><span class="cl">    default-body
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><br/>
<ul>
<li>示例；</li>
</ul>
<div class="highlight" id="id-45"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">while</span> <span class="o">((</span><span class="nv">c</span> <span class="o">=</span> getopt<span class="o">(</span>ARGC, ARGV, <span class="s2">&#34;aksx&#34;</span><span class="o">))</span> !<span class="o">=</span> -1<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    switch <span class="o">(</span>c<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;a&#34;</span>:
</span></span><span class="line"><span class="cl">        <span class="c1"># report size of all files</span>
</span></span><span class="line"><span class="cl">        <span class="nv">all_files</span> <span class="o">=</span> TRUE<span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;k&#34;</span>:
</span></span><span class="line"><span class="cl">        <span class="nv">BLOCK_SIZE</span> <span class="o">=</span> <span class="m">1024</span>       <span class="c1"># 1K block size</span>
</span></span><span class="line"><span class="cl">        <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;s&#34;</span>:
</span></span><span class="line"><span class="cl">        <span class="c1"># do sums only</span>
</span></span><span class="line"><span class="cl">        <span class="nv">sum_only</span> <span class="o">=</span> TRUE
</span></span><span class="line"><span class="cl">        <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;x&#34;</span>:
</span></span><span class="line"><span class="cl">        <span class="c1"># don&#39;t cross filesystems</span>
</span></span><span class="line"><span class="cl">        <span class="nv">fts_flags</span> <span class="o">=</span> or<span class="o">(</span>fts_flags, FTS_XDEV<span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s2">&#34;?&#34;</span>:
</span></span><span class="line"><span class="cl">    default:
</span></span><span class="line"><span class="cl">        usage<span class="o">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="break" class="heading-element">
  <a href="#break" class="heading-mark"></a>break</h2><p>该break语句跳转最里面出来for， while 或 do 包围它循环，是完全跳出了循环</p>
<br/>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-46"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># find smallest divisor of num</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">num</span> <span class="o">=</span> <span class="nv">$1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="o">(</span><span class="nv">divisor</span> <span class="o">=</span> 2<span class="p">;</span> divisor * divisor &lt;<span class="o">=</span> num<span class="p">;</span> divisor++<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span>num % <span class="nv">divisor</span> <span class="o">==</span> 0<span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(</span>num % <span class="nv">divisor</span> <span class="o">==</span> 0<span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">printf</span> <span class="s2">&#34;Smallest divisor of %d is %d\n&#34;</span>, num, divisor
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="nb">printf</span> <span class="s2">&#34;%d is prime\n&#34;</span>, num
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># find smallest divisor of num</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">num</span> <span class="o">=</span> <span class="nv">$1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="o">(</span><span class="nv">divisor</span> <span class="o">=</span> 2<span class="p">;</span> <span class="p">;</span> divisor++<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span>num % <span class="nv">divisor</span> <span class="o">==</span> 0<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="nb">printf</span> <span class="s2">&#34;Smallest divisor of %d is %d\n&#34;</span>, num, divisor
</span></span><span class="line"><span class="cl">            <span class="nb">break</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span>divisor * divisor &gt; num<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="nb">printf</span> <span class="s2">&#34;%d is prime\n&#34;</span>, num
</span></span><span class="line"><span class="cl">            <span class="nb">break</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="continue" class="heading-element">
  <a href="#continue" class="heading-mark"></a>continue</h2><p>continue 跳过了循环主体的其余部分，导致围绕循环的下一个循环立即开始</p>
<br/>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-47"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">for</span> <span class="o">(</span><span class="nv">x</span> <span class="o">=</span> 0<span class="p">;</span> x &lt;<span class="o">=</span> 20<span class="p">;</span> x++<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="o">(</span><span class="nv">x</span> <span class="o">==</span> 5<span class="o">)</span>
</span></span><span class="line"><span class="cl">             <span class="k">continue</span>
</span></span><span class="line"><span class="cl">         <span class="nb">printf</span> <span class="s2">&#34;%d &#34;</span>, x
</span></span><span class="line"><span class="cl">     <span class="o">}</span>
</span></span><span class="line"><span class="cl">     print <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="nv">x</span> <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">     <span class="k">while</span> <span class="o">(</span>x &lt;<span class="o">=</span> 20<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">if</span> <span class="o">(</span><span class="nv">x</span> <span class="o">==</span> 5<span class="o">)</span>
</span></span><span class="line"><span class="cl">             <span class="k">continue</span>
</span></span><span class="line"><span class="cl">         <span class="nb">printf</span> <span class="s2">&#34;%d &#34;</span>, x
</span></span><span class="line"><span class="cl">         x++
</span></span><span class="line"><span class="cl">     <span class="o">}</span>
</span></span><span class="line"><span class="cl">     print <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="退出状态码" class="heading-element">
  <a href="#%e9%80%80%e5%87%ba%e7%8a%b6%e6%80%81%e7%a0%81" class="heading-mark"></a>退出状态码</h1><p><code>exit [return code]</code>  可以指定退出状态码，当遇到 exit 时，立即停止 awk ，返回退出状态码。停止处理输入，余下的操作也会被忽略</p>
<p>当 exit 从一条 BEGIN 规则执行一条语句时，该程序立即停止处理所有内容。不会读取任何输入记录。但是，如果存在 END 规则，则作为执行 exit 语句的一部分，将执行该 END 规则如果 exit 在 END 规则主体中使用，它将导致程序立即停止</p>
<p>exit 不属于 BEGIN 或 END 规则的一部分的语句停止执行当前记录的所有其他自动规则，跳过读取所有剩余的输入记录，并在 END 有一个记录的情况下执行该规则。 gawk 也跳过任何ENDFILE 规则；他们不执行</p>
<p>如果将参数提供给 exit，则其值将用作 awk 流程的退出状态代码。如果未提供任何参数，则 exit导致awk返回“success”状态。如果将参数提供给第一条exit语句，然后exit从END没有参数的规则中第二次调用该参数，则 awk使用先前提供的退出值</p>
<p>为了方便移植，退出状态码应该在 0到126，负值或126以上的值在可能会在某些操作系统产生错误</p>
<br/>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-48"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">((</span><span class="s2">&#34;date&#34;</span> <span class="p">|</span> getline date_now<span class="o">)</span> &lt;<span class="o">=</span> 0<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        print <span class="s2">&#34;Can&#39;t get system date&#34;</span> &gt; <span class="s2">&#34;/dev/stderr&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    print <span class="s2">&#34;current date is&#34;</span>, date_now
</span></span><span class="line"><span class="cl">    close<span class="o">(</span><span class="s2">&#34;date&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="脚本" class="heading-element">
  <a href="#%e8%84%9a%e6%9c%ac" class="heading-mark"></a>脚本</h1><h2 id="内建函数" class="heading-element">
  <a href="#%e5%86%85%e5%bb%ba%e5%87%bd%e6%95%b0" class="heading-mark"></a>内建函数</h2><p>gawk编程语言提供了不少内置函数，可进行一些常见的数学、字符串以及时间函数运算</p>
<table>
<thead>
<tr>
<th style="text-align:left">gawk数学函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>atan2(x, y)</code></td>
<td style="text-align:left">x/y的反正切，x和y以弧度为单位</td>
</tr>
<tr>
<td style="text-align:left"><code>cos(x)</code></td>
<td style="text-align:left">x的余弦，x以弧度为单位</td>
</tr>
<tr>
<td style="text-align:left"><code>exp(x)</code></td>
<td style="text-align:left">x的指数函数</td>
</tr>
<tr>
<td style="text-align:left"><code>int(x)</code></td>
<td style="text-align:left">x的整数部分，取靠近零一侧的值</td>
</tr>
<tr>
<td style="text-align:left"><code>log(x)</code></td>
<td style="text-align:left">x的自然对数</td>
</tr>
<tr>
<td style="text-align:left"><code>rand( )</code></td>
<td style="text-align:left">比0大比1小的随机浮点值</td>
</tr>
<tr>
<td style="text-align:left"><code>sin(x)</code></td>
<td style="text-align:left">x的正弦，x以弧度为单位</td>
</tr>
<tr>
<td style="text-align:left"><code>sqrt(x)</code></td>
<td style="text-align:left">x的平方根</td>
</tr>
<tr>
<td style="text-align:left"><code>srand(x)</code></td>
<td style="text-align:left">为计算随机数指定一个种子值</td>
</tr>
<tr>
<td style="text-align:left"><code>and(v1, v2)</code></td>
<td style="text-align:left">执行值v1和v2的按位与运算</td>
</tr>
<tr>
<td style="text-align:left"><code>compl(val)</code></td>
<td style="text-align:left">执行val的补运算</td>
</tr>
<tr>
<td style="text-align:left"><code>lshift(val, count)</code></td>
<td style="text-align:left">将值val左移count位</td>
</tr>
<tr>
<td style="text-align:left"><code>or(v1, v2)</code></td>
<td style="text-align:left">执行值v1和v2的按位或运算</td>
</tr>
<tr>
<td style="text-align:left"><code>rshift(val, count)</code></td>
<td style="text-align:left">将值val右移count位</td>
</tr>
<tr>
<td style="text-align:left"><code>xor(v1, v2)</code></td>
<td style="text-align:left">执行值v1和v2的按位异或运算</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">gawk 字符串函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>asort(s [,d])</code></td>
<td style="text-align:left">将数组s按数据元素值排序。索引值会被替换成表示新的排序顺序的连续数字。另外，如果指定了d，则排序后的数组会存储在数组d中</td>
</tr>
<tr>
<td style="text-align:left"><code>asorti(s [,d])</code></td>
<td style="text-align:left">将数组s按索引值排序。生成的数组会将索引值作为数据元素值，用连续数字索引来表明排序顺序。另外如果指定了d，排序后的数组会存储在数组d中</td>
</tr>
<tr>
<td style="text-align:left"><code>gensub(r, s, h [, t])</code></td>
<td style="text-align:left">查找变量$0或目标字符串t（如果提供了的话）来匹配正则表达式r。如果h是一个以g或G开头的字符串，就用s替换掉匹配的文本。如果h是一个数字，它表示要替换掉第h处r匹配的地方</td>
</tr>
<tr>
<td style="text-align:left"><code>gsub(r, s [,t])</code></td>
<td style="text-align:left">查找变量$0或目标字符串t（如果提供了的话）来匹配正则表达式r。如果找到了，就全部替换成字符串s</td>
</tr>
<tr>
<td style="text-align:left"><code>index(s, t)</code></td>
<td style="text-align:left">返回字符串t在字符串s中的索引值，如果没找到的话返回0</td>
</tr>
<tr>
<td style="text-align:left"><code>length([s])</code></td>
<td style="text-align:left">返回字符串s的长度；如果没有指定的话，返回$0的长度</td>
</tr>
<tr>
<td style="text-align:left"><code>match(s, r [,a])</code></td>
<td style="text-align:left">返回字符串s中正则表达式r出现位置的索引。如果指定了数组a，它会存储s中匹配正则表达式的那部分</td>
</tr>
<tr>
<td style="text-align:left"><code>split(s, a [,r])</code></td>
<td style="text-align:left">将s用FS字符或正则表达式r（如果指定了的话）分开放到数组a中。返回字段的总数</td>
</tr>
<tr>
<td style="text-align:left"><code>sprintf(format,variables)</code></td>
<td style="text-align:left">用提供的format和variables返回一个类似于printf输出的字符串</td>
</tr>
<tr>
<td style="text-align:left"><code>sub(r, s [,t])</code></td>
<td style="text-align:left">在变量$0或目标字符串t中查找正则表达式r的匹配。如果找到了，就用字符串s替换掉第一处匹配</td>
</tr>
<tr>
<td style="text-align:left"><code>substr(s, i [,n])</code></td>
<td style="text-align:left">返回s中从索引值i开始的n个字符组成的子字符串。如果未提供n，则返回s剩下的部分</td>
</tr>
<tr>
<td style="text-align:left"><code>tolower(s)</code></td>
<td style="text-align:left">将s中的所有字符转换成小写</td>
</tr>
<tr>
<td style="text-align:left"><code>toupper(s)</code></td>
<td style="text-align:left">将s中的所有字符转换成大写</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">gawk 时间函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>mktime(datespec)</code></td>
<td style="text-align:left">将一个按YYYY MM DD HH MM SS [DST]格式指定的日期转换成时间戳值</td>
</tr>
<tr>
<td style="text-align:left"><code>strftime(format[,timestamp])</code></td>
<td style="text-align:left">将当前时间的时间戳或timestamp（如果提供了的话）转化格式化日期（采用shell函数date()的格式）</td>
</tr>
<tr>
<td style="text-align:left"><code>systime( )</code></td>
<td style="text-align:left">返回当前时间的时间戳</td>
</tr>
</tbody>
</table>
<p>自定义函数格式：</p>
<div class="highlight" id="id-49"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> name<span class="o">([</span>variables<span class="o">])</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">	statements
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="函数库" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0%e5%ba%93" class="heading-mark"></a>函数库</h2><p>在 gawk 脚本文件中，可以通过 <code>@include &quot;文件地址&quot;</code> 引用其他 gawk 文件，其中文件地址可以是相对路径，也可以是绝对路径，同个目录下可以直接使用文件名</p>
<ul>
<li>示例 file1 中引用 file2</li>
</ul>
<div class="highlight" id="id-50"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk -f file2</span>
</span></span><span class="line"><span class="cl">is file1
</span></span><span class="line"><span class="cl">is file2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># file1 内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file1</span>
</span></span><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">  print <span class="s2">&#34;is file1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># file2 内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file2</span>
</span></span><span class="line"><span class="cl">@include <span class="s2">&#34;./file1&#34;</span>
</span></span><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">  print <span class="s2">&#34;is file2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>还可以嵌套使用</li>
</ul>
<div class="highlight" id="id-51"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk -f file3</span>
</span></span><span class="line"><span class="cl">is file1
</span></span><span class="line"><span class="cl">is file2
</span></span><span class="line"><span class="cl">is file3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file3</span>
</span></span><span class="line"><span class="cl">@include <span class="s2">&#34;./file2&#34;</span>
</span></span><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">  print <span class="s2">&#34;is file3&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># file2 内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># cat file2</span>
</span></span><span class="line"><span class="cl">@include <span class="s2">&#34;./file1&#34;</span>
</span></span><span class="line"><span class="cl">BEGIN <span class="o">{</span>
</span></span><span class="line"><span class="cl">  print <span class="s2">&#34;is file2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="实例" class="heading-element">
  <a href="#%e5%ae%9e%e4%be%8b" class="heading-mark"></a>实例</h1><br/>
<h2 id="查看文本行数" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e6%96%87%e6%9c%ac%e8%a1%8c%e6%95%b0" class="heading-mark"></a>查看文本行数</h2><div class="highlight" id="id-52"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;END{ print NR }&#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="m">2</span></span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h2 id="查看偶数行内容" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e5%81%b6%e6%95%b0%e8%a1%8c%e5%86%85%e5%ae%b9" class="heading-mark"></a>查看偶数行内容</h2><div class="highlight" id="id-53"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;NR % 2 == 0 &#39; file4</span>
</span></span><span class="line"><span class="cl">aa bb <span class="nb">cd</span> os iw</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h2 id="查看奇数行内容" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e5%a5%87%e6%95%b0%e8%a1%8c%e5%86%85%e5%ae%b9" class="heading-mark"></a>查看奇数行内容</h2><div class="highlight" id="id-54"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;NR % 2 == 1 &#39; file4</span>
</span></span><span class="line"><span class="cl"><span class="m">11</span> <span class="m">22</span> <span class="m">39</span> <span class="m">45</span> <span class="m">02</span></span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h2 id="查看所有文件字节数" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e6%89%80%e6%9c%89%e6%96%87%e4%bb%b6%e5%ad%97%e8%8a%82%e6%95%b0" class="heading-mark"></a>查看所有文件字节数</h2><div class="highlight" id="id-55"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># ll vps##sshd*  | gawk &#39;{ x += $5 } END{ print &#34;总字节数：&#34; x }&#39;</span>
</span></span><span class="line"><span class="cl">总字节数：8566221</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h2 id="查看文本行内容不含空行" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e6%96%87%e6%9c%ac%e8%a1%8c%e5%86%85%e5%ae%b9%e4%b8%8d%e5%90%ab%e7%a9%ba%e8%a1%8c" class="heading-mark"></a>查看文本行内容，不含空行</h2><div class="highlight" id="id-56"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># gawk &#39;NF &gt; 0&#39; ssh.log</span>
</span></span><span class="line"><span class="cl">Jul  <span class="m">5</span> 08:54:21 localhost sshd<span class="o">[</span>29663<span class="o">]</span>: pam_succeed_if<span class="o">(</span>sshd:auth<span class="o">)</span>: requirement <span class="s2">&#34;uid &gt;= 1000&#34;</span> not met by user <span class="s2">&#34;root&#34;</span>
</span></span><span class="line"><span class="cl">Jul  <span class="m">5</span> 08:54:23 localhost sshd<span class="o">[</span>29663<span class="o">]</span>: Failed password <span class="k">for</span> root from 129.211.75.184 port <span class="m">41502</span> ssh2
</span></span><span class="line"><span class="cl">Jul  <span class="m">5</span> 08:54:23 localhost sshd<span class="o">[</span>29663<span class="o">]</span>: Received disconnect from 129.211.75.184 port 41502:11: Bye Bye <span class="o">[</span>preauth<span class="o">]</span>
</span></span><span class="line"><span class="cl">Jul  <span class="m">5</span> 08:54:23 localhost sshd<span class="o">[</span>29663<span class="o">]</span>: Disconnected from 129.211.75.184 port <span class="m">41502</span> <span class="o">[</span>preauth<span class="o">]</span>
</span></span><span class="line"><span class="cl">Jul  <span class="m">5</span> 08:54:26 localhost sshd<span class="o">[</span>29669<span class="o">]</span>: Invalid user irc from 118.24.89.243 port <span class="m">49904</span>
</span></span><span class="line"><span class="cl">Jul  <span class="m">5</span> 08:54:26 localhost sshd<span class="o">[</span>29669<span class="o">]</span>: input_userauth_request: invalid user irc <span class="o">[</span>pr^C
</span></span><span class="line"><span class="cl">...</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h2 id="查看文件中最长的行宽度" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e6%96%87%e4%bb%b6%e4%b8%ad%e6%9c%80%e9%95%bf%e7%9a%84%e8%a1%8c%e5%ae%bd%e5%ba%a6" class="heading-mark"></a>查看文件中最长的行宽度</h2><div class="highlight" id="id-57"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@c8 gawk<span class="o">]</span><span class="c1"># awk &#39;{ if (length($0) &gt; max) max = length($0) } END{ print max }&#39; vps##sshd.log </span>
</span></span><span class="line"><span class="cl"><span class="m">196</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="以字符e为分隔符显示第一部分和第二部分" class="heading-element">
  <a href="#%e4%bb%a5%e5%ad%97%e7%ac%a6e%e4%b8%ba%e5%88%86%e9%9a%94%e7%ac%a6%e6%98%be%e7%a4%ba%e7%ac%ac%e4%b8%80%e9%83%a8%e5%88%86%e5%92%8c%e7%ac%ac%e4%ba%8c%e9%83%a8%e5%88%86" class="heading-mark"></a>以字符<code>e</code>为分隔符，显示第一部分和第二部分</h2><div class="highlight" id="id-58"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;{print $1,$2}&#39; ena</span>
</span></span><span class="line"><span class="cl">svch <span class="nv">ck</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">svk <span class="nv">y</span><span class="o">=</span>https://
</span></span><span class="line"><span class="cl">copr##b .cloud.f
</span></span><span class="line"><span class="cl">/r sults/libr</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="以字符e为分隔符格式显示第二部分" class="heading-element">
  <a href="#%e4%bb%a5%e5%ad%97%e7%ac%a6e%e4%b8%ba%e5%88%86%e9%9a%94%e7%ac%a6%e6%a0%bc%e5%bc%8f%e6%98%be%e7%a4%ba%e7%ac%ac%e4%ba%8c%e9%83%a8%e5%88%86" class="heading-mark"></a>以字符<code>e</code>为分隔符，格式显示第二部分</h2><div class="highlight" id="id-59"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;{print &#34;echo：&#34;,$2}&#39; ena</span>
</span></span><span class="line"><span class="cl">echo： <span class="nv">ck</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">echo： <span class="nv">y</span><span class="o">=</span>https://
</span></span><span class="line"><span class="cl">echo： .cloud.f
</span></span><span class="line"><span class="cl">echo： sults/libr</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="以字符e为分隔符显示第一部分和第二部分-1" class="heading-element">
  <a href="#%e4%bb%a5%e5%ad%97%e7%ac%a6e%e4%b8%ba%e5%88%86%e9%9a%94%e7%ac%a6%e6%98%be%e7%a4%ba%e7%ac%ac%e4%b8%80%e9%83%a8%e5%88%86%e5%92%8c%e7%ac%ac%e4%ba%8c%e9%83%a8%e5%88%86-1" class="heading-mark"></a>以字符<code>e</code>为分隔符，显示第一部分和第二部分</h2><div class="highlight" id="id-60"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk  &#39;BEGIN{FS=&#34;e&#34;}{print &#34;echo：&#34;,$2}&#39; ena</span>
</span></span><span class="line"><span class="cl">echo： <span class="nv">ck</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">echo： <span class="nv">y</span><span class="o">=</span>https://
</span></span><span class="line"><span class="cl">echo： .cloud.f
</span></span><span class="line"><span class="cl">echo： sults/libr</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="指定显示分隔符" class="heading-element">
  <a href="#%e6%8c%87%e5%ae%9a%e6%98%be%e7%a4%ba%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>指定显示分隔符</h2><div class="highlight" id="id-61"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;BEGIN{OFS=&#34;=&#34;}{print &#34;echo&#34;,$2}&#39; ena</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk  &#39;BEGIN{FS=&#34;e&#34;;OFS=&#34;=&#34;}{print &#34;echo&#34;,$2}&#39; ena</span>
</span></span><span class="line"><span class="cl"><span class="nv">echo</span><span class="o">=</span><span class="nv">ck</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">echo</span><span class="o">=</span><span class="nv">y</span><span class="o">=</span>https://
</span></span><span class="line"><span class="cl"><span class="nv">echo</span><span class="o">=</span>.cloud.f
</span></span><span class="line"><span class="cl"><span class="nv">echo</span><span class="o">=</span>sults/libr</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="指定读取分隔符" class="heading-element">
  <a href="#%e6%8c%87%e5%ae%9a%e8%af%bb%e5%8f%96%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>指定读取分隔符</h2><div class="highlight" id="id-62"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;BEGIN{RS=&#34;=&#34;}{print &#34;echo：&#34;,$2}&#39; ena</span>
</span></span><span class="line"><span class="cl">echo： ck
</span></span><span class="line"><span class="cl">echo： y
</span></span><span class="line"><span class="cl">echo： .cloud.f</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="指定输出分隔符" class="heading-element">
  <a href="#%e6%8c%87%e5%ae%9a%e8%be%93%e5%87%ba%e5%88%86%e9%9a%94%e7%ac%a6" class="heading-mark"></a>指定输出分隔符</h2><div class="highlight" id="id-63"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;BEGIN{ORS=&#34;!!!&#34;}{print &#34;echo&#34;,$2}&#39; ena</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">ck</span><span class="o">=</span>1!!!echo <span class="nv">y</span><span class="o">=</span>https://!!!echo .cloud.f!!!echo sults/libr!!!<span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1">#</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="统计文本的所有行" class="heading-element">
  <a href="#%e7%bb%9f%e8%ae%a1%e6%96%87%e6%9c%ac%e7%9a%84%e6%89%80%e6%9c%89%e8%a1%8c" class="heading-mark"></a>统计文本的所有行</h2><div class="highlight" id="id-64"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;{print &#34;第&#34;NR&#34;行&#34;,$2}&#39; ena enb</span>
</span></span><span class="line"><span class="cl">第1行 <span class="nv">ck</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">第2行 <span class="nv">y</span><span class="o">=</span>https://
</span></span><span class="line"><span class="cl">第3行 .cloud.f
</span></span><span class="line"><span class="cl">第4行 sults/libr
</span></span><span class="line"><span class="cl">第5行 !o
</span></span><span class="line"><span class="cl">第6行 <span class="m">23</span>
</span></span><span class="line"><span class="cl">第7行 a!c</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="分开统计处理文本的所有行" class="heading-element">
  <a href="#%e5%88%86%e5%bc%80%e7%bb%9f%e8%ae%a1%e5%a4%84%e7%90%86%e6%96%87%e6%9c%ac%e7%9a%84%e6%89%80%e6%9c%89%e8%a1%8c" class="heading-mark"></a>分开统计处理文本的所有行</h2><div class="highlight" id="id-65"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;{print &#34;第&#34;FNR&#34;行&#34;,$2}&#39; ena enb</span>
</span></span><span class="line"><span class="cl">第1行 <span class="nv">ck</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">第2行 <span class="nv">y</span><span class="o">=</span>https://
</span></span><span class="line"><span class="cl">第3行 .cloud.f
</span></span><span class="line"><span class="cl">第4行 sults/libr
</span></span><span class="line"><span class="cl">第1行 !o
</span></span><span class="line"><span class="cl">第2行 <span class="m">23</span>
</span></span><span class="line"><span class="cl">第3行 a!c</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="nf查看以e作为分隔符号显示行号和最后一段" class="heading-element">
  <a href="#nf%e6%9f%a5%e7%9c%8b%e4%bb%a5e%e4%bd%9c%e4%b8%ba%e5%88%86%e9%9a%94%e7%ac%a6%e5%8f%b7%e6%98%be%e7%a4%ba%e8%a1%8c%e5%8f%b7%e5%92%8c%e6%9c%80%e5%90%8e%e4%b8%80%e6%ae%b5" class="heading-mark"></a>NF查看以e作为分隔符号，显示行号和最后一段</h2><div class="highlight" id="id-66"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;{print NF,$NF}&#39; ena</span>
</span></span><span class="line"><span class="cl"><span class="m">2</span> <span class="nv">ck</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="m">2</span> <span class="nv">y</span><span class="o">=</span>https://
</span></span><span class="line"><span class="cl"><span class="m">4</span> ct.org
</span></span><span class="line"><span class="cl"><span class="m">4</span> y.sv</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="自定义变量示例" class="heading-element">
  <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%8f%98%e9%87%8f%e7%a4%ba%e4%be%8b" class="heading-mark"></a>自定义变量示例</h2><div class="highlight" id="id-67"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk  ##Fe &#39;BEGIN{ec=&#34;echo：&#34;}{print ec,$1}&#39;  ena</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##v ec=&#34;echo：&#34; -Fe &#39;{print ec,$1}&#39;  ena</span>
</span></span><span class="line"><span class="cl">echo： svch
</span></span><span class="line"><span class="cl">echo： svk
</span></span><span class="line"><span class="cl">echo： copr##b
</span></span><span class="line"><span class="cl">echo： /r</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="格式输出" class="heading-element">
  <a href="#%e6%a0%bc%e5%bc%8f%e8%be%93%e5%87%ba" class="heading-mark"></a>格式输出</h2><div class="highlight" id="id-68"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># df ##Th |sed &#39;1d&#39; |awk &#39;{printf &#34;%+1s %-23s %+s %-14s %+s %+4s %+7s %+5s \n&#34;,&#34;设备：&#34;,$1,&#34;挂载点：&#34;,$7,&#34;剩余空间：&#34;,$5,&#34;总容量：&#34;,$3}&#39;</span>
</span></span><span class="line"><span class="cl">设备： /dev/mapper/centos##root 挂载点： /              剩余空间：  16G    总容量：   17G
</span></span><span class="line"><span class="cl">设备： devtmpfs                挂载点： /dev           剩余空间： 900M    总容量：  900M
</span></span><span class="line"><span class="cl">设备： tmpfs                   挂载点： /dev/shm       剩余空间： 911M    总容量：  911M
</span></span><span class="line"><span class="cl">设备： tmpfs                   挂载点： /run           剩余空间： 902M    总容量：  911M
</span></span><span class="line"><span class="cl">设备： tmpfs                   挂载点： /sys/fs/cgroup 剩余空间： 911M    总容量：  911M
</span></span><span class="line"><span class="cl">设备： /dev/sda1               挂载点： /boot          剩余空间： 831M    总容量： 1014M
</span></span><span class="line"><span class="cl">设备： tmpfs                   挂载点： /run/user/0    剩余空间： 183M    总容量：  183M</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="正则表达式示例" class="heading-element">
  <a href="#%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f%e7%a4%ba%e4%be%8b" class="heading-mark"></a>正则表达式示例</h2><div class="highlight" id="id-69"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##Fe &#39;/^s/{print $1}&#39; ena</span>
</span></span><span class="line"><span class="cl">svch
</span></span><span class="line"><span class="cl">svk</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="显示uid小于大于或等于3且小于7的用户" class="heading-element">
  <a href="#%e6%98%be%e7%a4%bauid%e5%b0%8f%e4%ba%8e%e5%a4%a7%e4%ba%8e%e6%88%96%e7%ad%89%e4%ba%8e3%e4%b8%94%e5%b0%8f%e4%ba%8e7%e7%9a%84%e7%94%a8%e6%88%b7" class="heading-mark"></a>显示UID小于大于或等于3且小于7的用户</h2><div class="highlight" id="id-70"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##F: &#39;$3&gt;=5 &amp;&amp; $3&lt;7{print $1}&#39; /etc/passwd</span>
</span></span><span class="line"><span class="cl">sync
</span></span><span class="line"><span class="cl">shutdown</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="查看使用率大于10的磁盘和挂载点" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e4%bd%bf%e7%94%a8%e7%8e%87%e5%a4%a7%e4%ba%8e10%e7%9a%84%e7%a3%81%e7%9b%98%e5%92%8c%e6%8c%82%e8%bd%bd%e7%82%b9" class="heading-mark"></a>查看使用率大于10的磁盘和挂载点</h2><div class="highlight" id="id-71"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># df ##Th | sed &#39;1d&#39; |awk &#39;+$6&gt;10{print $1,$NF}&#39;</span>
</span></span><span class="line"><span class="cl">/dev/sda1 /boot</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="匹配uid为0到第一次匹配nologin结尾的用户" class="heading-element">
  <a href="#%e5%8c%b9%e9%85%8duid%e4%b8%ba0%e5%88%b0%e7%ac%ac%e4%b8%80%e6%ac%a1%e5%8c%b9%e9%85%8dnologin%e7%bb%93%e5%b0%be%e7%9a%84%e7%94%a8%e6%88%b7" class="heading-mark"></a>匹配UID为0到第一次匹配nologin结尾的用户</h2><div class="highlight" id="id-72"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##F: &#39;$3==0,$7~&#34;nologin$&#34;{print $1}&#39; /etc/passwd</span>
</span></span><span class="line"><span class="cl">root
</span></span><span class="line"><span class="cl">bin</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="brgin模式与end模式示例" class="heading-element">
  <a href="#brgin%e6%a8%a1%e5%bc%8f%e4%b8%8eend%e6%a8%a1%e5%bc%8f%e7%a4%ba%e4%be%8b" class="heading-mark"></a>BRGIN模式与END模式示例</h2><div class="highlight" id="id-73"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># head ##n 5 /etc/passwd | awk -F: &#39;BEGIN{print &#34;user&#34;,&#34;ID&#34;,&#34;shell&#34;}{print $1,$3,$7}END{print&#34;===========&#34;}&#39;</span>
</span></span><span class="line"><span class="cl">user ID shell
</span></span><span class="line"><span class="cl">root <span class="m">0</span> /bin/bash
</span></span><span class="line"><span class="cl">bin <span class="m">1</span> /sbin/nologin
</span></span><span class="line"><span class="cl">daemon <span class="m">2</span> /sbin/nologin
</span></span><span class="line"><span class="cl">adm <span class="m">3</span> /sbin/nologin
</span></span><span class="line"><span class="cl">lp <span class="m">4</span> /sbin/nologin
</span></span><span class="line"><span class="cl"><span class="o">===========</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="if语句示例" class="heading-element">
  <a href="#if%e8%af%ad%e5%8f%a5%e7%a4%ba%e4%be%8b" class="heading-mark"></a>if语句示例</h2><div class="highlight" id="id-74"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># head ##n 3 /etc/passwd | awk -F: &#39;{if($3==0) {printf &#34;%-15s %-14s \n&#34;,$1,&#34;是超级用户&#34;} else{printf &#34;%-15s %-14s \n&#34;,$1,&#34;是普通用户&#34;}}&#39;</span>
</span></span><span class="line"><span class="cl">root            是超级用户         
</span></span><span class="line"><span class="cl">bin             是普通用户         
</span></span><span class="line"><span class="cl">daemon          是普通用户 </span></span></code></pre></td></tr></table>
</div>
</div><h2 id="变量示例" class="heading-element">
  <a href="#%e5%8f%98%e9%87%8f%e7%a4%ba%e4%be%8b" class="heading-mark"></a>变量示例</h2><div class="highlight" id="id-75"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># head ##n 3 /etc/passwd | awk -F:  -v i==0 &#39;{if($3&lt;11) {i++}}END{print &#34;UID小于3的用户数量：&#34;,i}&#39; /etc/passwd</span>
</span></span><span class="line"><span class="cl">UID小于3的用户数量： <span class="m">9</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="begin模式定义变量" class="heading-element">
  <a href="#begin%e6%a8%a1%e5%bc%8f%e5%ae%9a%e4%b9%89%e5%8f%98%e9%87%8f" class="heading-mark"></a>BEGIN模式定义变量,</h2><div class="highlight" id="id-76"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##F: &#39; BEGIN{bh=0;nh=0}{if($NF==&#34;/bin/bash&#34;){bh++} else {nh++}} END{print &#34;bash用户数量：&#34;,bh,&#34;nologin用户数量：&#34;,nh}&#39; /etc/passwd</span>
</span></span><span class="line"><span class="cl">bash用户数量： <span class="m">1</span> nologin用户数量： <span class="m">18</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="while循环示例" class="heading-element">
  <a href="#while%e5%be%aa%e7%8e%af%e7%a4%ba%e4%be%8b" class="heading-mark"></a>while循环示例</h2><div class="highlight" id="id-77"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># head ##n 3 /etc/passwd | awk &#39;{i=1;while(i&lt;=3){print $0;i++}}&#39;</span>
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">bin:x:1:1:bin:/bin:/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:1:1:bin:/bin:/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:1:1:bin:/bin:/sbin/nologin
</span></span><span class="line"><span class="cl">daemon:x:2:2:daemon:/sbin:/sbin/nologin
</span></span><span class="line"><span class="cl">daemon:x:2:2:daemon:/sbin:/sbin/nologin
</span></span><span class="line"><span class="cl">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="length函数示例" class="heading-element">
  <a href="#length%e5%87%bd%e6%95%b0%e7%a4%ba%e4%be%8b" class="heading-mark"></a>length函数示例</h2><div class="highlight" id="id-78"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># head ##n 3 /etc/passwd | awk -v n=0 -F: &#39;{i=1; while(i&lt;=NF) {if(length($i)&gt;4) {print $i;n++};i++}}END{print &#34;字符串长度大于4的数量：&#34;n}&#39;</span>
</span></span><span class="line"><span class="cl">/root
</span></span><span class="line"><span class="cl">/bin/bash
</span></span><span class="line"><span class="cl">/sbin/nologin
</span></span><span class="line"><span class="cl">daemon
</span></span><span class="line"><span class="cl">daemon
</span></span><span class="line"><span class="cl">/sbin
</span></span><span class="line"><span class="cl">/sbin/nologin
</span></span><span class="line"><span class="cl">字符串长度大于4的数量：7</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="for循环遍历数组示例" class="heading-element">
  <a href="#for%e5%be%aa%e7%8e%af%e9%81%8d%e5%8e%86%e6%95%b0%e7%bb%84%e7%a4%ba%e4%be%8b" class="heading-mark"></a>for循环遍历数组示例</h2><div class="highlight" id="id-79"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># head ##n 3 /etc/passwd | awk -F: &#39;{for(i=1;i&lt;=3;i++) {print $0}}&#39;</span>
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">bin:x:1:1:bin:/bin:/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:1:1:bin:/bin:/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:1:1:bin:/bin:/sbin/nologin
</span></span><span class="line"><span class="cl">daemon:x:2:2:daemon:/sbin:/sbin/nologin
</span></span><span class="line"><span class="cl">daemon:x:2:2:daemon:/sbin:/sbin/nologin
</span></span><span class="line"><span class="cl">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gawk-数组示例" class="heading-element">
  <a href="#gawk-%e6%95%b0%e7%bb%84%e7%a4%ba%e4%be%8b" class="heading-mark"></a>gawk 数组示例</h2><div class="highlight" id="id-80"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@yh ~<span class="o">]</span><span class="c1"># awk ##F: &#39;{shell[$NF]++}END{for(i in shell) {print i,shell[i]}}&#39; /etc/passwd</span>
</span></span><span class="line"><span class="cl">/bin/sync <span class="m">1</span>
</span></span><span class="line"><span class="cl">/bin/bash <span class="m">1</span>
</span></span><span class="line"><span class="cl">/sbin/nologin <span class="m">15</span>
</span></span><span class="line"><span class="cl">/sbin/halt <span class="m">1</span>
</span></span><span class="line"><span class="cl">/sbin/shutdown <span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="删除所有文件换行符" class="heading-element">
  <a href="#%e5%88%a0%e9%99%a4%e6%89%80%e6%9c%89%e6%96%87%e4%bb%b6%e6%8d%a2%e8%a1%8c%e7%ac%a6" class="heading-mark"></a>删除所有文件换行符</h2><div class="highlight" id="id-81"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@master ~<span class="o">]</span><span class="c1"># awk ##v RS=&#34;&#34; &#39;{gsub(&#34;\n&#34;,&#34;&#34;);print}&#39;  file</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="特定宽度为8换行" class="heading-element">
  <a href="#%e7%89%b9%e5%ae%9a%e5%ae%bd%e5%ba%a6%e4%b8%ba8%e6%8d%a2%e8%a1%8c" class="heading-mark"></a>特定宽度为8换行</h2><div class="highlight" id="id-82"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@master ~<span class="o">]</span><span class="c1"># awk &#39;NR{for(n=0;n&lt;length;n+=8)print substr($0,n+1,8)}&#39; file</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="打乱文本内容" class="heading-element">
  <a href="#%e6%89%93%e4%b9%b1%e6%96%87%e6%9c%ac%e5%86%85%e5%ae%b9" class="heading-mark"></a>打乱文本内容</h2><div class="highlight" id="id-83"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">awk &#39;BEGIN{10000*srand();} {printf &#34;%s %s\n&#34;, rand(), $0}&#39; file | sort ##k1n | awk &#39;{gsub($1FS,&#34;&#34;); print $0}&#39;</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="示例以-pyh-开头的行作为键其余为值" class="heading-element">
  <a href="#%e7%a4%ba%e4%be%8b%e4%bb%a5-pyh-%e5%bc%80%e5%a4%b4%e7%9a%84%e8%a1%8c%e4%bd%9c%e4%b8%ba%e9%94%ae%e5%85%b6%e4%bd%99%e4%b8%ba%e5%80%bc" class="heading-mark"></a>示例：以 pyh: 开头的行作为键，其余为值</h2><div class="highlight" id="id-84"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@master yaml<span class="o">]</span><span class="c1"># cat phy.txt </span>
</span></span><span class="line"><span class="cl">phy:11111
</span></span><span class="line"><span class="cl"><span class="m">21231321</span>
</span></span><span class="line"><span class="cl"><span class="m">23243920</span>
</span></span><span class="line"><span class="cl">phy:22222
</span></span><span class="line"><span class="cl">sfds
</span></span><span class="line"><span class="cl">fsdw
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@master yaml<span class="o">]</span><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@master yaml<span class="o">]</span><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@master yaml<span class="o">]</span><span class="c1"># awk &#39;/phy/{a=$0}!/phy/{print a&#34;\t&#34;$0}&#39; phy.txt </span>
</span></span><span class="line"><span class="cl">phy:11111	<span class="m">21231321</span>
</span></span><span class="line"><span class="cl">phy:11111	<span class="m">23243920</span>
</span></span><span class="line"><span class="cl">phy:22222	sfds
</span></span><span class="line"><span class="cl">phy:22222	fsdw</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="千位分割" class="heading-element">
  <a href="#%e5%8d%83%e4%bd%8d%e5%88%86%e5%89%b2" class="heading-mark"></a>千位分割</h2><div class="highlight" id="id-85"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@master ~<span class="o">]</span><span class="c1"># awk &#34;BEGIN{printf \&#34;%&#39;d\n\&#34;,1234567890}&#34;</span>
</span></span><span class="line"><span class="cl">1,234,567,890</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="查看cpu型号" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8bcpu%e5%9e%8b%e5%8f%b7" class="heading-mark"></a>查看cpu型号</h2><div class="highlight" id="id-86"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># awk ##F: &#39;/model name/ {name=$2} END {print name}&#39; /proc/cpuinfo </span>
</span></span><span class="line"><span class="cl"> Intel<span class="o">(</span>R<span class="o">)</span> Xeon<span class="o">(</span>R<span class="o">)</span> CPU E5##2660 v2 @ 2.20GHz</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="查看cpu核心数量" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8bcpu%e6%a0%b8%e5%bf%83%e6%95%b0%e9%87%8f" class="heading-mark"></a>查看cpu核心数量</h2><div class="highlight" id="id-87"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># lscpu | awk ##F: &#39;/model name/ {core++} END {print core}&#39; /proc/cpuinfo </span>
</span></span><span class="line"><span class="cl"><span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># awk ##F: &#39;/model name/ {core++} END {print core}&#39; /proc/cpuinfo </span>
</span></span><span class="line"><span class="cl"><span class="m">4</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="非-risk-v2-和-risk-listener-部分添加号注释" class="heading-element">
  <a href="#%e9%9d%9e-risk-v2-%e5%92%8c-risk-listener-%e9%83%a8%e5%88%86%e6%b7%bb%e5%8a%a0%e5%8f%b7%e6%b3%a8%e9%87%8a" class="heading-mark"></a>非 risk-v2 和 risk-listener 部分添加#号注释</h2><div class="highlight" id="id-88"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 文本部分</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>program:risk##v2<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">environment</span><span class="o">=</span><span class="nv">DJANGO_SETTINGS_MODULE</span><span class="o">=</span>risk.settings.<span class="o">{</span>env<span class="o">}</span>,RULE_MODULE_CONFIG<span class="o">=</span>configs.dev,NEW_RELIC_CONFIG_FILE<span class="o">=</span>/data/www/risk##v2/configs/newrelic.ini
</span></span><span class="line"><span class="cl"><span class="nv">directory</span><span class="o">=</span>/data/www/%<span class="o">(</span>program_name<span class="o">)</span>s/configs
</span></span><span class="line"><span class="cl"><span class="nv">command</span><span class="o">=</span> newrelic##admin run-program /usr/local/bin/uwsgi --ini uwsgi-%<span class="o">(</span>program_name<span class="o">)</span>s.ini
</span></span><span class="line"><span class="cl"><span class="nv">autostart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">autorestart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">stopsignal</span><span class="o">=</span>QUIT
</span></span><span class="line"><span class="cl"><span class="nv">killasgroup</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">stdout_logfile</span><span class="o">=</span>/data/logs/%<span class="o">(</span>program_name<span class="o">)</span>s/supervisor.stdout.log
</span></span><span class="line"><span class="cl"><span class="nv">stderr_logfile</span><span class="o">=</span>/data/logs/%<span class="o">(</span>program_name<span class="o">)</span>s/supervisor.stderr.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>program:risk##monitor<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">environment</span><span class="o">=</span><span class="nv">RISK_MONITOR_CONFIG</span><span class="o">=</span>monitor.settings.<span class="o">{</span>env<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">directory</span><span class="o">=</span>/data/www/risk##v2/
</span></span><span class="line"><span class="cl"><span class="nv">command</span><span class="o">=</span>/data/www/risk##v2/monitor/venv/bin/python /data/www/risk-v2/monitor/app.py
</span></span><span class="line"><span class="cl"><span class="nv">autostart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">autorestart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">stopsignal</span><span class="o">=</span>QUIT
</span></span><span class="line"><span class="cl"><span class="nv">killasgroup</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">stdout_logfile</span><span class="o">=</span>/data/logs/risk##v2/supervisor.stdout.log
</span></span><span class="line"><span class="cl"><span class="nv">stderr_logfile</span><span class="o">=</span>/data/logs/risk##v2/supervisor.stderr.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>program:risk##listener<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">environment</span><span class="o">=</span><span class="nv">RISK_MONITOR_CONFIG</span><span class="o">=</span>monitor.settings.<span class="o">{</span>env<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">directory</span><span class="o">=</span>/data/www/risk##v2/
</span></span><span class="line"><span class="cl"><span class="nv">command</span><span class="o">=</span>/data/www/risk##v2/monitor/venv/bin/python /data/www/risk-v2/monitor/supervisor_listener.py
</span></span><span class="line"><span class="cl"><span class="nv">autostart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">autorestart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">stdout_logfile</span><span class="o">=</span>/data/logs/risk##v2/supervisor.stdout.log
</span></span><span class="line"><span class="cl"><span class="nv">stderr_logfile</span><span class="o">=</span>/data/logs/risk##v2/supervisor.stderr.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>program:risk##jxl-pull<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">environment</span><span class="o">=</span><span class="nv">DJANGO_SETTINGS_MODULE</span><span class="o">=</span>risk.settings.<span class="o">{</span>env<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">directory</span><span class="o">=</span>/data/www/risk##v2/
</span></span><span class="line"><span class="cl"><span class="nv">command</span><span class="o">=</span>/data/www/risk##v2/venv/bin/python /data/www/risk-v2/scripts/jxl_data_pull.py
</span></span><span class="line"><span class="cl"><span class="nv">autostart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">autorestart</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">stopsignal</span><span class="o">=</span>QUIT
</span></span><span class="line"><span class="cl"><span class="nv">killasgroup</span><span class="o">=</span><span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="nv">stdout_logfile</span><span class="o">=</span>/data/logs/risk##v2/supervisor.stdout.log
</span></span><span class="line"><span class="cl"><span class="nv">stderr_logfile</span><span class="o">=</span>/data/logs/risk##v2/supervisor.stderr.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># awk</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># awk &#39;/program:risk##(v2|listener)/{p=1}NF==0{p=0;print;next}!p{$0=&#34;#&#34;$0}1&#39; file.txt</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>program:risk##v2<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">environment</span><span class="o">=</span><span class="nv">DJANGO_SETTINGS_MODULE</span><span class="o">=</span>risk.settings.<span class="o">{</span>env<span class="o">}</span>,RULE_MODULE_CONFIG<span class="o">=</span>configs.dev,NEW_RELIC_CONFIG_FILE<span class="o">=</span>/data/www/risk##v2/configs/newrelic.ini
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="c1">#[program:risk##monitor]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#environment=RISK_MONITOR_CONFIG=monitor.settings.{env}</span>
</span></span><span class="line"><span class="cl">...</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="每行后面增加一行空行" class="heading-element">
  <a href="#%e6%af%8f%e8%a1%8c%e5%90%8e%e9%9d%a2%e5%a2%9e%e5%8a%a0%e4%b8%80%e8%a1%8c%e7%a9%ba%e8%a1%8c" class="heading-mark"></a>每行后面增加一行空行</h2><div class="highlight" id="id-89"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># awk &#39;1;{print &#34;&#34;}&#39; file.txt</span>
</span></span><span class="line"><span class="cl">等效
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># awk &#39;BEGIN{ORS=&#34;\n\n&#34;};1&#39;  file.txt</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="查看系统版本" class="heading-element">
  <a href="#%e6%9f%a5%e7%9c%8b%e7%b3%bb%e7%bb%9f%e7%89%88%e6%9c%ac" class="heading-mark"></a>查看系统版本</h2><div class="highlight" id="id-90"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># awk &#39;{print ($1,$3~/^[0##9]/?$3:$4)}&#39; /etc/redhat-release</span>
</span></span><span class="line"><span class="cl">CentOS 7.8.2003
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1">#  awk ##F&#39;[= &#34;]&#39; &#39;/PRETTY_NAME/{print $3,$4,$5}&#39; /etc/os-release</span>
</span></span><span class="line"><span class="cl">CentOS Linux <span class="m">7</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取内存容量总容量m" class="heading-element">
  <a href="#%e8%8e%b7%e5%8f%96%e5%86%85%e5%ad%98%e5%ae%b9%e9%87%8f%e6%80%bb%e5%ae%b9%e9%87%8fm" class="heading-mark"></a>获取内存容量（总容量M）</h2><div class="highlight" id="id-91"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># free ##m | awk &#39;/Mem/ {print $2}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">3770</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取交换分区容量总容量m" class="heading-element">
  <a href="#%e8%8e%b7%e5%8f%96%e4%ba%a4%e6%8d%a2%e5%88%86%e5%8c%ba%e5%ae%b9%e9%87%8f%e6%80%bb%e5%ae%b9%e9%87%8fm" class="heading-mark"></a>获取交换分区容量（总容量M）</h2><div class="highlight" id="id-92"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># free ##m | awk &#39;/Swap/ {print $2}&#39;</span>
</span></span><span class="line"><span class="cl"><span class="m">2047</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取系统运行时长" class="heading-element">
  <a href="#%e8%8e%b7%e5%8f%96%e7%b3%bb%e7%bb%9f%e8%bf%90%e8%a1%8c%e6%97%b6%e9%95%bf" class="heading-mark"></a>获取系统运行时长</h2><div class="highlight" id="id-93"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># awk &#39;{a=$1/86400;b=($1%86400)/3600;c=($1%3600)/60;d=$1%60} {printf(&#34;%ddays, %d:%d:%d\n&#34;,a,b,c,d)}&#39; /proc/uptime </span>
</span></span><span class="line"><span class="cl">0days, 5:29:27</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取cpu频率mhz" class="heading-element">
  <a href="#%e8%8e%b7%e5%8f%96cpu%e9%a2%91%e7%8e%87mhz" class="heading-mark"></a>获取CPU频率（MHz）</h2><div class="highlight" id="id-94"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># awk ##F: &#39;/cpu MHz/ {freq=$2} END {print freq}&#39; /proc/cpuinfo | sed &#39;s/^[ \t]*//;s/[ \t]*$//&#39;</span>
</span></span><span class="line"><span class="cl">2495.999</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取系统平均负载统计时间" class="heading-element">
  <a href="#%e8%8e%b7%e5%8f%96%e7%b3%bb%e7%bb%9f%e5%b9%b3%e5%9d%87%e8%b4%9f%e8%bd%bd%e7%bb%9f%e8%ae%a1%e6%97%b6%e9%97%b4" class="heading-mark"></a>获取系统平均负载统计时间</h2><div class="highlight" id="id-95"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># w | head ##1 | awk -F&#39;load average:&#39; &#39;{print $2}&#39; | sed &#39;s/^[ \t]*//;s/[ \t]*$//&#39; </span>
</span></span><span class="line"><span class="cl">0.12, 0.05, 0.05</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="竖排调整为横排去除感叹号" class="heading-element">
  <a href="#%e7%ab%96%e6%8e%92%e8%b0%83%e6%95%b4%e4%b8%ba%e6%a8%aa%e6%8e%92%e5%8e%bb%e9%99%a4%e6%84%9f%e5%8f%b9%e5%8f%b7" class="heading-mark"></a>竖排调整为横排，去除感叹号</h2><div class="highlight" id="id-96"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 等效，但使用空格分隔：awk &#39;/!/{$0=&#34;&#34;;print a;a=&#34;&#34;}{a=a?a&#34; &#34;$0:$0}&#39;  file</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 等效，但使用空格分隔：awk -v RS=&#39;!&#39;  &#39;NF+=0&#39;  OFS=&#39; &#39; file </span>
</span></span><span class="line"><span class="cl"><span class="c1"># 等效：gawk &#39;BEGIN{ RS=&#34;!&#34;; OFS=&#34;\t&#34;} {NF+=0; print $0}&#39; file</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># awk -v RS=&#39;!&#39; &#39;NF+=0&#39; OFS=&#39;\t&#39; file </span>
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span>100004944	<span class="nv">bind_house_type</span><span class="o">=</span>2	<span class="nv">bind_msg_type</span><span class="o">=</span>16	<span class="nv">bind_msg_no</span><span class="o">=</span>100004944	<span class="nv">bind_house_cnt</span><span class="o">=</span>1	<span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span>100022884	<span class="nv">bind_house_type</span><span class="o">=</span>2	<span class="nv">bind_msg_type</span><span class="o">=</span>16	<span class="nv">bind_msg_no</span><span class="o">=</span>100022884	<span class="nv">bind_house_cnt</span><span class="o">=</span>1	<span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span>100047553	<span class="nv">bind_house_type</span><span class="o">=</span>2	<span class="nv">bind_msg_type</span><span class="o">=</span>16	<span class="nv">bind_msg_no</span><span class="o">=</span>100047553	<span class="nv">bind_house_cnt</span><span class="o">=</span>1	<span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span><span class="m">68768</span>     <span class="nv">bind_house_type</span><span class="o">=</span>2	<span class="nv">bind_msg_type</span><span class="o">=</span>16	<span class="nv">bind_msg_no</span><span class="o">=</span><span class="m">68768</span>    	<span class="nv">bind_house_cnt</span><span class="o">=</span>1	<span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat file </span>
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span><span class="m">100004944</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_type</span><span class="o">=</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_type</span><span class="o">=</span><span class="m">16</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_no</span><span class="o">=</span><span class="m">100004944</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_cnt</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl">!
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span><span class="m">100022884</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_type</span><span class="o">=</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_type</span><span class="o">=</span><span class="m">16</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_no</span><span class="o">=</span><span class="m">100022884</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_cnt</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl">!
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span><span class="m">100047553</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_type</span><span class="o">=</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_type</span><span class="o">=</span><span class="m">16</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_no</span><span class="o">=</span><span class="m">100047553</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_cnt</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl">!
</span></span><span class="line"><span class="cl"><span class="nv">msgno</span><span class="o">=</span><span class="m">68768</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_type</span><span class="o">=</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_type</span><span class="o">=</span><span class="m">16</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_msg_no</span><span class="o">=</span><span class="m">68768</span>
</span></span><span class="line"><span class="cl"><span class="nv">bind_house_cnt</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">house_name</span><span class="o">=</span><span class="m">254</span>
</span></span><span class="line"><span class="cl">!</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="第一列去除重复字符串第二列统计数值之和" class="heading-element">
  <a href="#%e7%ac%ac%e4%b8%80%e5%88%97%e5%8e%bb%e9%99%a4%e9%87%8d%e5%a4%8d%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%ac%ac%e4%ba%8c%e5%88%97%e7%bb%9f%e8%ae%a1%e6%95%b0%e5%80%bc%e4%b9%8b%e5%92%8c" class="heading-mark"></a>第一列去除重复字符串，第二列统计数值之和</h2><div class="highlight" id="id-97"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># awk &#39;{a[$1]+=$2}END{for(i in a)print i,a[i]}&#39; txt</span>
</span></span><span class="line"><span class="cl">a <span class="m">13</span>
</span></span><span class="line"><span class="cl">b <span class="m">11</span>
</span></span><span class="line"><span class="cl">c <span class="m">6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat txt</span>
</span></span><span class="line"><span class="cl">a <span class="m">13</span>
</span></span><span class="line"><span class="cl">b <span class="m">2</span>
</span></span><span class="line"><span class="cl">c <span class="m">5</span>
</span></span><span class="line"><span class="cl">b <span class="m">9</span>
</span></span><span class="line"><span class="cl">c <span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="给外部变量赋值" class="heading-element">
  <a href="#%e7%bb%99%e5%a4%96%e9%83%a8%e5%8f%98%e9%87%8f%e8%b5%8b%e5%80%bc" class="heading-mark"></a>给外部变量赋值</h1><div class="highlight" id="id-98"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">假设将值存在文件t中，文件t内容如下，只有一行：a b c
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">需要将a、b和c分别赋给外部变量x、y和z，则脚本可写成如下：
</span></span><span class="line"><span class="cl">eval $(awk &#39;{ printf(&#34;x=%s\ny=%s\nz=%s&#34;,$1,$2,$3); }&#39; ./t)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">echo $x
</span></span><span class="line"><span class="cl">echo $y
</span></span><span class="line"><span class="cl">echo $z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">请注意printf函数中的换行符\n是必须的，起关键作用的是eval命令，它在很多场景有特别的用处。</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2022-12-11 10:01:26">更新于 2022-12-11&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/awk/" class="post-tag" title="标签 - awk">awk</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/linux%E6%80%A7%E8%83%BD/" class="post-nav-item" rel="prev" title="linux 性能"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>linux 性能</a>
      <a href="/selinux/" class="post-nav-item" rel="next" title="selinux">selinux<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.115.3"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.1"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/pangu/pangu.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"lightgallery":true,"pangu":{"enable":true,"selector":"article"},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":true,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
