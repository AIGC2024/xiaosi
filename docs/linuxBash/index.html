<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>bash shell脚本 - 小厮</title><meta name="author" content="">
<meta name="author-link" content="">
<meta name="description" content="bash shell" /><meta name="keywords" content='shell' /><meta itemprop="name" content="bash shell脚本">
<meta itemprop="description" content="bash shell"><meta itemprop="datePublished" content="2022-09-30T11:19:49+08:00" />
<meta itemprop="dateModified" content="2023-08-04T13:37:17+08:00" />
<meta itemprop="wordCount" content="15943">
<meta itemprop="keywords" content="shell," /><meta property="og:title" content="bash shell脚本" />
<meta property="og:description" content="bash shell" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/linuxBash/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-30T11:19:49+08:00" />
<meta property="article:modified_time" content="2023-08-04T13:37:17+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="bash shell脚本"/>
<meta name="twitter:description" content="bash shell"/>
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#ffffff" data-dark="#252627" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="/linuxBash/" /><link rel="prev" href="/k8sAPI%E6%A6%82%E8%BF%B0%E5%8F%8A%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/" /><link rel="next" href="/k8s%E5%AD%98%E5%82%A8/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "bash shell脚本",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "\/linuxBash\/"
    },"genre": "posts","keywords": "shell","wordcount":  15943 ,
    "url": "\/linuxBash\/","datePublished": "2022-09-30T11:19:49+08:00","dateModified": "2023-08-04T13:37:17+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "小厮"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="wide"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="小厮"><span class="header-title-text">首页</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class='fa-solid fa-archive fa-fw fa-sm'></i> 所有文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="小厮"><span class="header-title-text">首页</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class='fa-solid fa-archive fa-fw fa-sm'></i> 所有文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class='fa-solid fa-th fa-fw fa-sm'></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class='fa-solid fa-tags fa-fw fa-sm'></i> 标签</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container container-reverse"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>bash shell脚本</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><i class="fa-solid fa-user-circle" aria-hidden="true"></i>
      小厮</span></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/linux/" class="post-category" title="分类 - linux"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> linux</a></span></div><div class="post-meta-line"><span title="发布于 2022-09-30 11:19:49"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2022-09-30">2022-09-30</time></span>&nbsp;<span title="更新于 2023-08-04 13:37:17"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2023-08-04">2023-08-04</time></span>&nbsp;<span title="15943 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 16000 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 32 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#bash-与父子进程">bash 与父子进程</a></li>
    <li><a href="#变量">变量</a>
      <ul>
        <li><a href="#把命令的输出信息赋值给变量">把命令的输出信息赋值给变量</a></li>
        <li><a href="#变量替换表达式">变量替换表达式</a></li>
      </ul>
    </li>
    <li><a href="#命令串">命令串</a></li>
    <li><a href="#配色">配色</a>
      <ul>
        <li><a href="#修改字体颜色或背景颜色">修改字体颜色或背景颜色</a></li>
        <li><a href="#终端命令行颜色">终端命令行颜色</a></li>
      </ul>
    </li>
    <li><a href="#shell-脚本书写与规范">shell 脚本书写与规范</a>
      <ul>
        <li><a href="#缩进与文本长度">缩进与文本长度</a></li>
        <li><a href="#文件名称和路径">文件名称和路径</a></li>
        <li><a href="#注释">注释</a></li>
        <li><a href="#命令">命令</a></li>
        <li><a href="#条件表达式">条件表达式</a>
          <ul>
            <li><a href="#整数比较">整数比较</a></li>
            <li><a href="#字符串比较">字符串比较</a></li>
            <li><a href="#文件测试符">文件测试符</a></li>
            <li><a href="#逻辑判断符">逻辑判断符</a></li>
            <li><a href="#布尔运算符">布尔运算符</a></li>
          </ul>
        </li>
        <li><a href="#逻辑语句">逻辑语句</a>
          <ul>
            <li><a href="#if-语句">if 语句</a></li>
            <li><a href="#for-语句">for 语句</a></li>
            <li><a href="#c-语言风格的-for-语句">C 语言风格的 for 语句</a></li>
            <li><a href="#while-语句">while 语句</a></li>
            <li><a href="#until-语句">until 语句</a></li>
            <li><a href="#case-语句">case 语句</a></li>
            <li><a href="#循环语句控制">循环语句控制</a></li>
          </ul>
        </li>
        <li><a href="#脚本参数与选项">脚本参数与选项</a>
          <ul>
            <li><a href="#位置参数">位置参数</a></li>
            <li><a href="#脚本参数数量">脚本参数数量</a></li>
            <li><a href="#抓取所有脚本参数">抓取所有脚本参数</a></li>
            <li><a href="#脚本参数偏移位">脚本参数偏移位</a></li>
            <li><a href="#查找选项">查找选项</a></li>
            <li><a href="#处理合并的选选项">处理合并的选选项</a></li>
            <li><a href="#标准化选项">标准化选项</a></li>
          </ul>
        </li>
        <li><a href="#函数">函数</a>
          <ul>
            <li><a href="#引用函数">引用函数</a></li>
            <li><a href="#函数的退出状态码">函数的退出状态码</a></li>
            <li><a href="#函数中的变量">函数中的变量</a></li>
            <li><a href="#函数中的数组">函数中的数组</a></li>
            <li><a href="#函数递归">函数递归</a></li>
            <li><a href="#函数库">函数库</a></li>
            <li><a href="#gun-shtool-函数库">GUN shtool 函数库</a></li>
          </ul>
        </li>
        <li><a href="#退出状态码">退出状态码</a></li>
        <li><a href="#重定向与文件描述符">重定向与文件描述符</a>
          <ul>
            <li><a href="#cat-和-eof">cat 和 EOF</a></li>
            <li><a href="#脚本中的重定向">脚本中的重定向</a></li>
            <li><a href="#自定义文件描述符">自定义文件描述符</a></li>
            <li><a href="#关闭自定义文件描述符">关闭自定义文件描述符</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#交互式脚本">交互式脚本</a>
      <ul>
        <li><a href="#read-命令">read 命令</a></li>
        <li><a href="#select-语句">select 语句</a></li>
      </ul>
    </li>
    <li><a href="#重定向错误信息">重定向错误信息</a></li>
    <li><a href="#分离输出信息">分离输出信息</a></li>
    <li><a href="#判断用户身份">判断用户身份</a></li>
    <li><a href="#提示错误过程">提示错误过程</a></li>
    <li><a href="#使用-expr-命令处理字符串">使用 expr 命令处理字符串</a>
      <ul>
        <li><a href="#得到字符串长度">得到字符串长度</a></li>
        <li><a href="#查找字符串子串位置">查找字符串子串位置</a></li>
        <li><a href="#获取字符串子串">获取字符串子串</a></li>
        <li><a href="#获取字符串子串长度">获取字符串子串长度</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><!-- FileID: FID -->
<blockquote>
<p>运行环境：</p>
<ul>
<li>centos: 8</li>
</ul>
<p>内容来自以下文档：</p>
<ul>
<li>[Linux命令行与shell脚本编程大全第3版][]</li>
<li><a href="https://mp.weixin.qq.com/s/uHYc8fugbjiWxGJuoClnzQ"target="_blank" rel="external nofollow noopener noreferrer"><code>linux安全基线配置全解析</code></a></li>
<li><a href="https://zh-google-styleguide.readthedocs.io/en/latest/google-shell-styleguide/contents/" title="google开源项目风格指南-shell风格指南"target="_blank" rel="external nofollow noopener noreferrer">google开源项目风格指南-shell风格指南</a></li>
<li><a href="http://bbs.chinaunix.net/thread-2145841-1-1.html"target="_blank" rel="external nofollow noopener noreferrer"><code>Shell_HAT</code>: bash中字符串的处理</a></li>
<li><a href="https://www.cnblogs.com/ginvip/p/6415853.html" title="琴酒网络-linux BASH shell下设置字体及背景颜色"target="_blank" rel="external nofollow noopener noreferrer">琴酒网络-linux BASH shell下设置字体及背景颜色</a></li>
</ul>
</blockquote>
<!-- 网址链接 -->
<!-- 图片链接 -->
<!-- 其它链接 -->
<h1 id="bash-与父子进程" class="heading-element">
  <a href="#bash-%e4%b8%8e%e7%88%b6%e5%ad%90%e8%bf%9b%e7%a8%8b" class="heading-mark"></a>bash 与父子进程</h1><p>当 bash 进程执行一个非内置命令时，会产生一个子进程去执行该命令，命令执行结束后，回收子进程。如果是 bash 脚本，则会产生 bash 子进程，由 bash 子进程执行脚本</p>
<ul>
<li>当前 bash 执行命令时进程树状图</li>
</ul>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># pstree -p</span>
</span></span><span class="line"><span class="cl">systemd<span class="o">(</span>1<span class="o">)</span>─┬─NetworkManager<span class="o">(</span>2256<span class="o">)</span>─┬─<span class="o">{</span>NetworkManager<span class="o">}(</span>2257<span class="o">)</span>
</span></span><span class="line"><span class="cl">           ├─sshd<span class="o">(</span>2466<span class="o">)</span>─┬─sshd<span class="o">(</span>13287<span class="o">)</span>───bash<span class="o">(</span>13289<span class="o">)</span>───ping<span class="o">(</span>17747<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │            └─sshd<span class="o">(</span>17752<span class="o">)</span>───bash<span class="o">(</span>17756<span class="o">)</span>───pstree<span class="o">(</span>17825<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中，终端1的bash 进程（13289） 在运行 ping 命令产生了一个进程 ping (17747)，bash 进程（17756）运行当前 pstree 命令也产生一个进程 （17825）</p>
<ul>
<li>当 bash 运行脚本时，产生的进程树状图</li>
</ul>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 终端1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat ping.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">ping baidu.com 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># ./ping.sh </span>
</span></span><span class="line"><span class="cl">PING baidu.com <span class="o">(</span>39.156.69.79<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">48</span> <span class="nv">time</span><span class="o">=</span>43.7 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">48</span> <span class="nv">time</span><span class="o">=</span>44.3 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">48</span> <span class="nv">time</span><span class="o">=</span>44.1 ms
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 终端2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># pstree -p</span>
</span></span><span class="line"><span class="cl">systemd<span class="o">(</span>1<span class="o">)</span>─┬─NetworkManager<span class="o">(</span>2256<span class="o">)</span>─┬─<span class="o">{</span>NetworkManager<span class="o">}(</span>2257<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │                      └─<span class="o">{</span>NetworkManager<span class="o">}(</span>2259<span class="o">)</span>
</span></span><span class="line"><span class="cl">           ├─sshd<span class="o">(</span>2466<span class="o">)</span>─┬─sshd<span class="o">(</span>13287<span class="o">)</span>───bash<span class="o">(</span>13289<span class="o">)</span>───ping.sh<span class="o">(</span>19530<span class="o">)</span>───ping<span class="o">(</span>19531<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │            ├─sshd<span class="o">(</span>17752<span class="o">)</span>───bash<span class="o">(</span>17756<span class="o">)</span>───pstree<span class="o">(</span>19536<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中，终端1 运行一个脚之所以产生一个子shell （bash）类型，是因为运行 bash 命令的效果，每执行一次 bash 命令就会产生并进入 bash 子进程，当进程命令结束运行时回收子进程</p>
<ul>
<li>示例：运行 bash 命令产生进程以及回收</li>
</ul>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 终端1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># bash</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># bash</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># bash</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># bash ping.sh </span>
</span></span><span class="line"><span class="cl">PING baidu.com <span class="o">(</span>39.156.69.79<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">48</span> <span class="nv">time</span><span class="o">=</span>43.8 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">48</span> <span class="nv">time</span><span class="o">=</span>44.0 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">48</span> <span class="nv">time</span><span class="o">=</span>44.3 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">4</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">48</span> <span class="nv">time</span><span class="o">=</span>43.9 ms
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 终端2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># pstree -p</span>
</span></span><span class="line"><span class="cl">systemd<span class="o">(</span>1<span class="o">)</span>─┬─NetworkManager<span class="o">(</span>2256<span class="o">)</span>─┬─<span class="o">{</span>NetworkManager<span class="o">}(</span>2257<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │                      └─<span class="o">{</span>NetworkManager<span class="o">}(</span>2259<span class="o">)</span>
</span></span><span class="line"><span class="cl">           ├─sshd<span class="o">(</span>2466<span class="o">)</span>─┬─sshd<span class="o">(</span>13287<span class="o">)</span>───bash<span class="o">(</span>13289<span class="o">)</span>───bash<span class="o">(</span>19763<span class="o">)</span>───bash<span class="o">(</span>19774<span class="o">)</span>───bash<span class="o">(</span>19783<span class="o">)</span>───bash<span class="o">(</span>19894<span class="o">)</span>───ping<span class="o">(</span>19895<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │            ├─sshd<span class="o">(</span>17752<span class="o">)</span>───bash<span class="o">(</span>17756<span class="o">)</span>───pstree<span class="o">(</span>19901<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 结束终端1之后，终端2查看进程树效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># pstree -p</span>
</span></span><span class="line"><span class="cl">systemd<span class="o">(</span>1<span class="o">)</span>─┬─NetworkManager<span class="o">(</span>2256<span class="o">)</span>─┬─<span class="o">{</span>NetworkManager<span class="o">}(</span>2257<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │                      └─<span class="o">{</span>NetworkManager<span class="o">}(</span>2259<span class="o">)</span>
</span></span><span class="line"><span class="cl">           ├─sshd<span class="o">(</span>2466<span class="o">)</span>─┬─sshd<span class="o">(</span>13287<span class="o">)</span>───bash<span class="o">(</span>13289<span class="o">)</span>───bash<span class="o">(</span>19763<span class="o">)</span>───bash<span class="o">(</span>19774<span class="o">)</span>───bash<span class="o">(</span>19783<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │            ├─sshd<span class="o">(</span>17752<span class="o">)</span>───bash<span class="o">(</span>17756<span class="o">)</span>───pstree<span class="o">(</span>20125<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>bash 命令常见选项</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">使用方式：bash <span class="o">[</span>GNU long option<span class="o">]</span> <span class="o">[</span>option<span class="o">]</span> script-file ...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">常见选项：
</span></span><span class="line"><span class="cl">-c string 
</span></span><span class="line"><span class="cl">	从字符串中读取命令
</span></span><span class="line"><span class="cl">-s
</span></span><span class="line"><span class="cl">	从标准输入中读取命令
</span></span><span class="line"><span class="cl">-i
</span></span><span class="line"><span class="cl">	交互式
</span></span><span class="line"><span class="cl">-l
</span></span><span class="line"><span class="cl">	以登陆 shell 方式启动
</span></span><span class="line"><span class="cl">-r
</span></span><span class="line"><span class="cl">	受限制在家目录中
</span></span><span class="line"><span class="cl">-x
</span></span><span class="line"><span class="cl">	查看执行的命令和参数，set 命令的效果，可以有 bash -x 直接运行
</span></span><span class="line"><span class="cl">-v
</span></span><span class="line"><span class="cl">	查看执行时输入的行，set 命令的效果，可以用 bash -v 直接运行
</span></span><span class="line"><span class="cl">-n
</span></span><span class="line"><span class="cl">	读取命令但不执行</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="变量" class="heading-element">
  <a href="#%e5%8f%98%e9%87%8f" class="heading-mark"></a>变量</h1><p>变量：表示表示某段内存空间的值 。变量名是标识内存空间的名称</p>
<ul>
<li>数据存储方式：<code>ASCII</code>码</li>
<li>存储数据类型：字符，且不支持浮点数（不同解释器有所不同）</li>
</ul>
<p>查看变量值方式：</p>
<ul>
<li>使用 <code>set</code> 命令查看</li>
<li>使用 <code>printenv 变量名</code> ，仅限于环境变量</li>
<li>使用 <code>echo ${变量名}</code></li>
<li>使用 <code>unset 变量名</code> 可以删除某个变量</li>
</ul>
<p>变量按照环境有以下分类：</p>
<ul>
<li>环境变量：<code>shell</code> 工作环境相关的变量，变量名通常全是大写字母</li>
<li>用户变量：只在某个用户生效的变量，变量名通常全是小写字母</li>
</ul>
<p>以下表格是常见变量</p>
<table>
<thead>
<tr>
<th style="text-align:left">变量名</th>
<th style="text-align:left">变量简介</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>$$</code></td>
<td style="text-align:left">当前进程<code>PID</code></td>
</tr>
<tr>
<td style="text-align:left"><code>$?</code></td>
<td style="text-align:left">上一条命令的退出状态码</td>
</tr>
<tr>
<td style="text-align:left"><code>$!</code></td>
<td style="text-align:left">上一条运行后台进程的<code>PID</code></td>
</tr>
<tr>
<td style="text-align:left"><code>$PWD</code></td>
<td style="text-align:left">当前目录</td>
</tr>
<tr>
<td style="text-align:left"><code>$LANG</code></td>
<td style="text-align:left">默认语言</td>
</tr>
<tr>
<td style="text-align:left"><code>$USER</code></td>
<td style="text-align:left">当前用户名</td>
</tr>
<tr>
<td style="text-align:left"><code>$HOME</code></td>
<td style="text-align:left">当前用户家目录</td>
</tr>
<tr>
<td style="text-align:left"><code>$PATH</code></td>
<td style="text-align:left">默认可执行程序路径</td>
</tr>
<tr>
<td style="text-align:left"><code>$SHELL</code></td>
<td style="text-align:left">默认 <code>shell</code></td>
</tr>
<tr>
<td style="text-align:left"><code>$HOSTNAME</code></td>
<td style="text-align:left">主机名</td>
</tr>
<tr>
<td style="text-align:left"><code>$#</code></td>
<td style="text-align:left">脚本参数数量</td>
</tr>
<tr>
<td style="text-align:left"><code>$*</code></td>
<td style="text-align:left">脚本所有参数（当成整体）</td>
</tr>
<tr>
<td style="text-align:left"><code>$0</code></td>
<td style="text-align:left">脚本名称（包含执行时的路径）</td>
</tr>
<tr>
<td style="text-align:left"><code>$n</code></td>
<td style="text-align:left">n 为 1 到 8 的正整数，脚本参数</td>
</tr>
<tr>
<td style="text-align:left"><code>$@</code></td>
<td style="text-align:left">脚本所有参数（每个参数当成单个个体）</td>
</tr>
</tbody>
</table>
<p>自定义变的方法：变量名=变量值，其中变量名可以是任何由字母、数字或下划线组成的文本字符串。长度不超过20个，区分大小写。定义变量时：</p>
<ul>
<li>如果是原有文件，保持之前的格式</li>
<li>定义变量时，变量名尽量是单词，多个单词使用下划线分割，如 <code>bash_shell</code></li>
<li>定义环境变量和常用变量时：名称全部使用大写，且声明在文件脚本注释下面</li>
<li>引用变量时，容易引起争议的单个字符变量和多字符变量使用 <code>${var}</code> 格式；单个字符变量和脚本参数变量使用 <code>$var</code> 格式</li>
<li>引用变量时，尽量使用 <code>$@</code> ，有必要才使用 <code>$*</code></li>
<li>引用变量时，使用 <code>[[ ]]</code> 匹配规则，不要使用 <code>[]</code></li>
<li>只读变量应该使用 <code>readonly</code> 或 <code>declare -r</code> 明确定义</li>
<li>本地变量（常见于函数）需要使用 <code>local</code> 命令明确定义，当赋值的值由命令替换提供时，声明和赋值必须分开。因为内建的 local 不会从命令替换中传递退出码</li>
</ul>
<p>子进程被创建时会继承父进程的环境变量，但父进程不会引用子进程的变量，因此，如果是子进程被销毁，它生成的变量也会销毁。</p>
<h2 id="把命令的输出信息赋值给变量" class="heading-element">
  <a href="#%e6%8a%8a%e5%91%bd%e4%bb%a4%e7%9a%84%e8%be%93%e5%87%ba%e4%bf%a1%e6%81%af%e8%b5%8b%e5%80%bc%e7%bb%99%e5%8f%98%e9%87%8f" class="heading-mark"></a>把命令的输出信息赋值给变量</h2><p>把命令输出的信息赋值给变量有以下方法：</p>
<ul>
<li>变量名=<code>`命令`</code></li>
<li>变量名=<code>$(命令)</code></li>
</ul>
<p>上述的方式会创建一个子 shell 来运行对应的命令，因此，如果该子 shell 运行的是一个脚本或外部命令，则无法获取变量</p>
<h2 id="变量替换表达式" class="heading-element">
  <a href="#%e5%8f%98%e9%87%8f%e6%9b%bf%e6%8d%a2%e8%a1%a8%e8%be%be%e5%bc%8f" class="heading-mark"></a>变量替换表达式</h2><table>
<thead>
<tr>
<th style="text-align:left">形式</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>${var}</code></td>
<td style="text-align:left">变量本身</td>
</tr>
<tr>
<td style="text-align:left"><code>${#var}</code></td>
<td style="text-align:left">返回 <code>var</code> 值中元素个数</td>
</tr>
<tr>
<td style="text-align:left"><code>${var+str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量不存在时返回它的值，否则返回 <code>str</code></td>
</tr>
<tr>
<td style="text-align:left"><code>${var:+str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量为空时返回它的值，否则返回 <code>str</code></td>
</tr>
<tr>
<td style="text-align:left"><code>${var-str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量存在时返回它的值，否则返回 <code>str</code></td>
</tr>
<tr>
<td style="text-align:left"><code>${var:-str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量不为空时返回它的值，否则返回 <code>str</code></td>
</tr>
<tr>
<td style="text-align:left"><code>${var=str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量存在时返回它的值，否则把 <code>str</code> 赋值给 <code>var</code> 变量并返回</td>
</tr>
<tr>
<td style="text-align:left"><code>${var:=str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量不为空时返回它的值，否则把 <code>str</code> 赋值给 <code>var</code> 变量并返回</td>
</tr>
<tr>
<td style="text-align:left"><code>${var?str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量存在时返回它的值，否则把 <code>str</code> 输出到标准错误输出</td>
</tr>
<tr>
<td style="text-align:left"><code>${var:?str}</code></td>
<td style="text-align:left">如果 <code>var</code> 变量存在或不为空时返回它的值，否则把 <code>str</code> 输出到标准错误输出</td>
</tr>
<tr>
<td style="text-align:left"><code>${var:x:y}</code></td>
<td style="text-align:left">从 <code>var</code> 变量下标 <code>x</code> 截取到下标 <code>y</code>，可以是负数(负号前有空格)，表示从结尾倒序截取，注意从结尾计算下标时是从<code>1</code>开始</td>
</tr>
<tr>
<td style="text-align:left"><code>${var:x}</code></td>
<td style="text-align:left">从 <code>var</code> 变量下标 <code>x</code> 截取到最后，可以是负数(负号前有空格)，表示从结尾倒序截取，注意从结尾计算下标时是从<code>1</code>开始，<code>${var: -0}</code> 表示整个变量值</td>
</tr>
<tr>
<td style="text-align:left"><code>${var::y}</code></td>
<td style="text-align:left">从 <code>var</code> 变量下标 <code>0</code> 截取到下标 <code>y</code>，可以是负数(负号前有空格)，表示从结尾倒序截取，注意从结尾计算下标时是从<code>1</code>开始</td>
</tr>
<tr>
<td style="text-align:left"><code>${var#x}</code></td>
<td style="text-align:left">返回变量值，并去掉开头的 <code>x</code> , <code>#</code> 表示从开关去掉字符</td>
</tr>
<tr>
<td style="text-align:left"><code>${var%x}</code></td>
<td style="text-align:left">返回变量值，并去掉结尾的 <code>x</code> , <code>%</code> 表示从结尾（从右往左）去掉字符</td>
</tr>
<tr>
<td style="text-align:left"><code>${var#?}</code></td>
<td style="text-align:left">返回变量值，并去掉开头第一个字符, 通配符 <code>?</code> 表示单个字符</td>
</tr>
<tr>
<td style="text-align:left"><code>${var#*x}</code></td>
<td style="text-align:left">返回变量值，并去掉从开头到第一个 <code>x</code> , 通配符 <code>*</code> 表示任意字符</td>
</tr>
<tr>
<td style="text-align:left"><code>${var#*x?}</code></td>
<td style="text-align:left">返回变量值，并去掉从开头到第一个 <code>x</code> 及其后面的第一个字符</td>
</tr>
<tr>
<td style="text-align:left"><code>${var##*x}</code></td>
<td style="text-align:left">返回变量值，并去掉从开头到最后一个 <code>x</code>, <code>##</code> 表示贪婪模式</td>
</tr>
<tr>
<td style="text-align:left"><code>${var##*x?}</code></td>
<td style="text-align:left">返回变量值，并去掉从开头到最后一个 <code>x</code> 及其后面的第一个字符</td>
</tr>
<tr>
<td style="text-align:left"><code>${var/x/y}</code></td>
<td style="text-align:left">返回变量值，并把第一个 <code>x</code> 改为 <code>y</code>，可以配合通配符（<code>?</code> 或 <code>*</code>）使用</td>
</tr>
<tr>
<td style="text-align:left"><code>${var//x/y}</code></td>
<td style="text-align:left">返回变量值，并把所有 <code>x</code> 改为 <code>y</code>，可以配合通配符（<code>?</code> 或 <code>*</code>）使用</td>
</tr>
<tr>
<td style="text-align:left"><code>${var/x/}</code></td>
<td style="text-align:left">返回变量值，并把第一个 <code>x</code> 删除掉，可以配合通配符（<code>?</code> 或 <code>*</code>）使用</td>
</tr>
</tbody>
</table>
<ul>
<li><code>${var}</code> 示例</li>
</ul>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># var=hello &amp;&amp; echo ${var}</span>
</span></span><span class="line"><span class="cl">hello</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>${var-str}</code> 示例</li>
</ul>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># v1=hello &amp;&amp; echo ${v1-v2}</span>
</span></span><span class="line"><span class="cl">hello
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># v1=hello &amp;&amp; echo ${v2-v1}</span>
</span></span><span class="line"><span class="cl">v1</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="命令串" class="heading-element">
  <a href="#%e5%91%bd%e4%bb%a4%e4%b8%b2" class="heading-mark"></a>命令串</h1><p>有以下字符可以把多个命令组合使用：</p>
<ul>
<li>在多个命令之间使用 <code>|</code> 字符：后面的命令输入是从前面的命令标准输入中获取的，简单说就是把前面的输出交给后面的命令。注意，不是所有命令都支持从标准输出中获取</li>
<li>在多个命令之间使用 <code>&amp;</code> 字符：多个命令并行执行，单个命令执行失败不会影响其他命令（除非有关联）</li>
<li>在多个命令之间使用 <code>;</code> 字符，前面命令结束之后，无论成功还是失败，都会执行后面命令</li>
<li>在多个命令直接使用 <code>&amp;&amp;</code> 字符，前面命令执行成功后面的命令才会执行</li>
<li>在多个命令直接使用 <code>||</code> 字符，前面命令执行失败后面的命令才会执行</li>
</ul>
<p>多个命令并行执行示例</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 终端1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># ping baidu.com &amp; ping qq.com</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span> <span class="m">1895</span>
</span></span><span class="line"><span class="cl">PING baidu.com <span class="o">(</span>39.156.69.79<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl">PING qq.com <span class="o">(</span>183.3.226.35<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 183.3.226.35 <span class="o">(</span>183.3.226.35<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>5.64 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>42.4 ms
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 终端2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># pstree -p</span>
</span></span><span class="line"><span class="cl">systemd<span class="o">(</span>1<span class="o">)</span>─┬─NetworkManager<span class="o">(</span>722<span class="o">)</span>─┬─dhclient<span class="o">(</span>784<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │                     ├─<span class="o">{</span>NetworkManager<span class="o">}(</span>744<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │                     └─<span class="o">{</span>NetworkManager<span class="o">}(</span>754<span class="o">)</span>
</span></span><span class="line"><span class="cl">           ├─sshd<span class="o">(</span>989<span class="o">)</span>─┬─sshd<span class="o">(</span>1708<span class="o">)</span>───bash<span class="o">(</span>1712<span class="o">)</span>─┬─ping<span class="o">(</span>1895<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │           │                         └─ping<span class="o">(</span>1896<span class="o">)</span>
</span></span><span class="line"><span class="cl">           │           └─sshd<span class="o">(</span>1876<span class="o">)</span>───bash<span class="o">(</span>1880<span class="o">)</span>───pstree<span class="o">(</span>1897<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>串行执行多个命令示例</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 终端1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># ping baidu.com ; ping qq.com</span>
</span></span><span class="line"><span class="cl">PING baidu.com <span class="o">(</span>39.156.69.79<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>47.8 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>44.2 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">11</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>43.9 ms
</span></span><span class="line"><span class="cl">^C
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 123.151.137.18 <span class="o">(</span>123.151.137.18<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">6</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>42.7 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 123.151.137.18 <span class="o">(</span>123.151.137.18<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">7</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>42.0 ms
</span></span><span class="line"><span class="cl">^C
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">--- qq.com ping statistics ---
</span></span><span class="line"><span class="cl"><span class="m">7</span> packets transmitted, <span class="m">7</span> received, 0% packet loss, <span class="nb">time</span> 6019ms
</span></span><span class="line"><span class="cl">rtt min/avg/max/mdev <span class="o">=</span> 41.955/42.210/42.708/0.228 ms
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 终端2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># pstree -p 989</span>
</span></span><span class="line"><span class="cl">sshd<span class="o">(</span>989<span class="o">)</span>─┬─sshd<span class="o">(</span>1876<span class="o">)</span>───bash<span class="o">(</span>1880<span class="o">)</span>───pstree<span class="o">(</span>1958<span class="o">)</span>
</span></span><span class="line"><span class="cl">          └─sshd<span class="o">(</span>1923<span class="o">)</span>───bash<span class="o">(</span>1927<span class="o">)</span>───ping<span class="o">(</span>1957<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>前面命令成功才执行后面命令示例</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># mkkkk &amp;&amp; echo &#34;ok&#34;</span>
</span></span><span class="line"><span class="cl">-bash: mkkkk: <span class="nb">command</span> not found</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="配色" class="heading-element">
  <a href="#%e9%85%8d%e8%89%b2" class="heading-mark"></a>配色</h1><h2 id="修改字体颜色或背景颜色" class="heading-element">
  <a href="#%e4%bf%ae%e6%94%b9%e5%ad%97%e4%bd%93%e9%a2%9c%e8%89%b2%e6%88%96%e8%83%8c%e6%99%af%e9%a2%9c%e8%89%b2" class="heading-mark"></a>修改字体颜色或背景颜色</h2><p>可以使用非常规字符序列的开始，以<code>\</code>开关，以<code>m</code>结束，使用多种格式时使用<code>;</code>分隔</p>
<table>
<thead>
<tr>
<th style="text-align:left">编码</th>
<th style="text-align:left">效果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>\033[0</code></td>
<td style="text-align:left">重新设置属性到缺省设置</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[1</code></td>
<td style="text-align:left">设置粗体</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[2</code></td>
<td style="text-align:left">设置一半亮度（模拟彩色显示器的颜色）</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[4</code></td>
<td style="text-align:left">设置下划线（模拟彩色显示器的颜色）</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[5</code></td>
<td style="text-align:left">设置闪烁</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[7</code></td>
<td style="text-align:left">设置反向图象</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[22</code></td>
<td style="text-align:left">设置一般密度</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[24</code></td>
<td style="text-align:left">关闭下划线</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[25</code></td>
<td style="text-align:left">关闭闪烁</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[27</code></td>
<td style="text-align:left">关闭反向图象</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[30</code></td>
<td style="text-align:left">设置黑色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[31</code></td>
<td style="text-align:left">设置红色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[32</code></td>
<td style="text-align:left">设置绿色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[33</code></td>
<td style="text-align:left">设置棕色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[34</code></td>
<td style="text-align:left">设置蓝色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[35</code></td>
<td style="text-align:left">设置紫色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[36</code></td>
<td style="text-align:left">设置青色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[37</code></td>
<td style="text-align:left">设置白色前景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[38</code></td>
<td style="text-align:left">在缺省的前景颜色上设置下划线</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[39</code></td>
<td style="text-align:left">在缺省的前景颜色上关闭下划线</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[40</code></td>
<td style="text-align:left">设置黑色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[41</code></td>
<td style="text-align:left">设置红色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[42</code></td>
<td style="text-align:left">设置绿色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[43</code></td>
<td style="text-align:left">设置棕色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[44</code></td>
<td style="text-align:left">设置蓝色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[45</code></td>
<td style="text-align:left">设置紫色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[46</code></td>
<td style="text-align:left">设置青色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[47</code></td>
<td style="text-align:left">设置白色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[49</code></td>
<td style="text-align:left">设置缺省黑色背景</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[2J</code></td>
<td style="text-align:left">　清除屏幕</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[0q</code></td>
<td style="text-align:left">　关闭所有的键盘指示灯</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[1q</code></td>
<td style="text-align:left">　设置“滚动锁定”指示灯 (Scroll Lock)</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[2q</code></td>
<td style="text-align:left">　设置“数值锁定”指示灯 (Num Lock)</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[3q</code></td>
<td style="text-align:left">　设置“大写锁定”指示灯 (Caps Lock)</td>
</tr>
<tr>
<td style="text-align:left"><code>\033[15:40H</code></td>
<td style="text-align:left">把关闭移动到第15行，40列</td>
</tr>
<tr>
<td style="text-align:left"><code>\007</code></td>
<td style="text-align:left">　　发蜂鸣生beep</td>
</tr>
</tbody>
</table>
<h2 id="终端命令行颜色" class="heading-element">
  <a href="#%e7%bb%88%e7%ab%af%e5%91%bd%e4%bb%a4%e8%a1%8c%e9%a2%9c%e8%89%b2" class="heading-mark"></a>终端命令行颜色</h2><p>终端配置由 <code>PS1</code> 变量指定</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># echo $PS1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span><span class="se">\u</span>@<span class="se">\h</span> <span class="se">\W</span><span class="o">]</span><span class="se">\$</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># PS1=&#34;[\e[32;1m\u@\e[35;1m\h \e[31;1m\W]\\$ &#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># ls</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这是一些转义字符格式效果：</p>
<ul>
<li><code>\d</code> ：代表日期，格式为weekday month date，例如：&ldquo;Mon Aug 1&rdquo;</li>
<li><code>\H</code> ：完整的主机名称。例如：我的机器名称为：fc4.linux，则这个名称就是fc4.linux</li>
<li><code>\h</code> ：仅取主机的第一个名字，如上例，则为fc4，.linux则被省略</li>
<li><code>\t</code> ：显示时间为24小时格式，如：HH：MM：SS</li>
<li><code>\T</code> ：显示时间为12小时格式</li>
<li><code>\A</code> ：显示时间为24小时格式：HH：MM</li>
<li><code>\u</code> ：当前用户的账号名称</li>
<li><code>\v</code> ：BASH的版本信息</li>
<li><code>\w</code> ：完整的工作目录名称。家目录会以 ~代替</li>
<li><code>\W</code> ：利用basename取得工作目录名称，所以只会列出最后一个目录</li>
<li><code>\#</code> ：下达的第几个命令</li>
<li><code>\$</code> ：提示字符，如果是root时，提示符为：# ，普通用户则为：$</li>
<li><code>\n</code> ：新建一行</li>
<li><code>\e[x;ym</code> ：这就是控制字体和背景颜色的转义字符。其中 <code>x</code>为<code>0~10</code>，表示不同的字体样式（只有在 x 环境下生效），<code>y</code>为字体与背景颜色，如下表。当<code>x</code>为<code>0</code>时，可省略。如 <code>[\\e[0;32m</code>等效<code>\e[;32m</code> 等效<code>\e[32m</code></li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">颜色</th>
<th style="text-align:left">字符颜色</th>
<th style="text-align:left">背景颜色</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">黑色</td>
<td style="text-align:left">30</td>
<td style="text-align:left">40</td>
</tr>
<tr>
<td style="text-align:left">红色</td>
<td style="text-align:left">31</td>
<td style="text-align:left">41</td>
</tr>
<tr>
<td style="text-align:left">绿色</td>
<td style="text-align:left">32</td>
<td style="text-align:left">42</td>
</tr>
<tr>
<td style="text-align:left">蓝色</td>
<td style="text-align:left">34</td>
<td style="text-align:left">44</td>
</tr>
<tr>
<td style="text-align:left">紫色</td>
<td style="text-align:left">35</td>
<td style="text-align:left">45</td>
</tr>
<tr>
<td style="text-align:left">白色</td>
<td style="text-align:left">37</td>
<td style="text-align:left">47</td>
</tr>
<tr>
<td style="text-align:left">淡红色</td>
<td style="text-align:left">33</td>
<td style="text-align:left">43</td>
</tr>
<tr>
<td style="text-align:left">淡蓝色</td>
<td style="text-align:left">36</td>
<td style="text-align:left">46</td>
</tr>
</tbody>
</table>
<h1 id="shell-脚本书写与规范" class="heading-element">
  <a href="#shell-%e8%84%9a%e6%9c%ac%e4%b9%a6%e5%86%99%e4%b8%8e%e8%a7%84%e8%8c%83" class="heading-mark"></a>shell 脚本书写与规范</h1><p><code>shell</code>脚本是为了实现某个目的，把一系列命令安装特定方式组织而成的文本，可以理解为一堆 <code>shell</code> 命令+逻辑语言。如果可以，<code>Bash shell</code> 是唯一指定的 <code>shell</code> 解释器。必要时使用 <code>set</code> 设置 shell 选项，使其 <code>bash &lt;shell.sh&gt;</code> 执行脚本时不会出现意外</p>
<p>脚本格式：</p>
<ol>
<li>（可选）第一行指定 shell 解释器。格式 <code>#!/解释器路径1;解释器路径2;...</code> 多个解释器存在时，优先级从左往右</li>
<li>（可选）其余以 # 开头的行或字符都会被当成注释忽略掉</li>
<li>（必须）执行的命令</li>
</ol>
<ul>
<li>示例：常见指定 shell 解释器方式</li>
</ul>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat /mnt/hgfs/note/centos/shell/shell脚本合集/ssc/ssc.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/env bash</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># head /mnt/hgfs/note/centos/shell/shell脚本合集/vpn_centos.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># head /mnt/hgfs/note/centos/shell/shell脚本合集/l2tp.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/env bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">PATH</span><span class="o">=</span>/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin</span></span></code></pre></td></tr></table>
</div>
</div><p>执行一个脚本方式：</p>
<ul>
<li>增加相应的执行权限，使 <code>./脚本名称</code> 其能够执行</li>
<li>指定 shell 解释器，如：<code>bash 脚本文件名称</code></li>
</ul>
<br/>
<ul>
<li>示例：以指定 shell 解释器（bash）执行脚本</li>
</ul>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat ping.sh </span>
</span></span><span class="line"><span class="cl">ping baidu.com
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># bash ping.sh </span>
</span></span><span class="line"><span class="cl">PING baidu.com <span class="o">(</span>39.156.69.79<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>47.1 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 39.156.69.79 <span class="o">(</span>39.156.69.79<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>48.9 ms
</span></span><span class="line"><span class="cl">^C</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：增加权限执行</li>
</ul>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat ping.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ping 百度</span>
</span></span><span class="line"><span class="cl">ping baidu.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># chmod +x ping.sh </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># ./ping.sh </span>
</span></span><span class="line"><span class="cl">PING baidu.com <span class="o">(</span>220.181.38.148<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 220.181.38.148 <span class="o">(</span>220.181.38.148<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">1</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>43.7 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 220.181.38.148 <span class="o">(</span>220.181.38.148<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">2</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>45.5 ms
</span></span><span class="line"><span class="cl"><span class="m">64</span> bytes from 220.181.38.148 <span class="o">(</span>220.181.38.148<span class="o">)</span>: <span class="nv">icmp_seq</span><span class="o">=</span><span class="m">3</span> <span class="nv">ttl</span><span class="o">=</span><span class="m">128</span> <span class="nv">time</span><span class="o">=</span>43.3 ms
</span></span><span class="line"><span class="cl">^C
</span></span><span class="line"><span class="cl">--- baidu.com ping statistics ---
</span></span><span class="line"><span class="cl"><span class="m">3</span> packets transmitted, <span class="m">3</span> received, 0% packet loss, <span class="nb">time</span> 2015ms
</span></span><span class="line"><span class="cl">rtt min/avg/max/mdev <span class="o">=</span> 43.303/44.206/45.572/1.011 ms</span></span></code></pre></td></tr></table>
</div>
</div><p>规范我个人书写标准，不是必须遵循的规范。目的是使 <code>shell</code> 脚本简洁、易读</p>
<h2 id="缩进与文本长度" class="heading-element">
  <a href="#%e7%bc%a9%e8%bf%9b%e4%b8%8e%e6%96%87%e6%9c%ac%e9%95%bf%e5%ba%a6" class="heading-mark"></a>缩进与文本长度</h2><p>所有缩进为 <code>2</code> 个空格，不使用制表符，如果是已有文件保持之前文件缩进，文本行不能过长，过长的文本和代码应该想办法换行</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">command1 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="p">|</span> command2 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="p">|</span> command3 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="p">|</span> command4</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="文件名称和路径" class="heading-element">
  <a href="#%e6%96%87%e4%bb%b6%e5%90%8d%e7%a7%b0%e5%92%8c%e8%b7%af%e5%be%84" class="heading-mark"></a>文件名称和路径</h2><ul>
<li>脚本文件和库文件以 <code>.sh</code> 结尾</li>
<li>文件名称使用小写，多个单词之间使用 <code>-</code> 连接</li>
<li>尽量使用绝对路径，如果使用相对路径（当前）使用 <code>./</code> 开头，增加可读性</li>
</ul>
<h2 id="注释" class="heading-element">
  <a href="#%e6%b3%a8%e9%87%8a" class="heading-mark"></a>注释</h2><p>每个文件开头都有以下注释信息：</p>
<ul>
<li>时间</li>
<li>脚本功能</li>
<li>运行环境</li>
<li>作者及其联系方式</li>
<li>其他必要的声明</li>
</ul>
<p>任何函数和库文件都必须含有以下注释，使其看注释就能知道怎么使用：</p>
<ul>
<li>函数或库文件的功能描述</li>
<li>全局变量的修改和说明</li>
<li>使用参数说明</li>
<li>返回值</li>
</ul>
<p>注释添加标签，给注释分类，这些分类需要在文件头部说明含义：</p>
<ul>
<li>TODO：表示临时功能，等待进一步完善。格式：<code># TODO(作者及其联系方式)：需要完善的信息 (TODO:序列号)</code></li>
<li>FIXME：表示BUG，不能正常使用，等待修复。格式：<code># FIXME(作者及联系方式)：需要修复的BUG (HIXME:序列号)</code></li>
<li>DEPRECATED：表示弃用，已经不使用，等待删除。格式：<code># DEPRECATED(作者以及联系方式)：弃用原因以及替代方案 (DEPRECATED:序列号)</code></li>
<li>其他自定义类型，也需要在文件开头出注释说明</li>
</ul>
<h2 id="命令" class="heading-element">
  <a href="#%e5%91%bd%e4%bb%a4" class="heading-mark"></a>命令</h2><p>命令替换使用 <code>$(command)</code> 而不是 <code>`command`</code>，这样可读性更强
优先选择内建命令
<code>exec</code> 命令：
<code>source</code> 命令：当前进程执行，而不是产生子进程执行
<code>{}</code>：当前进程中执行中跨号的命令
<code>()</code>：子进程中执行大括号的命令</p>
<h2 id="条件表达式" class="heading-element">
  <a href="#%e6%9d%a1%e4%bb%b6%e8%a1%a8%e8%be%be%e5%bc%8f" class="heading-mark"></a>条件表达式</h2><p>定义条件表达式以下方式</p>
<ul>
<li>使用 <code>test</code> 命令
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">if</span> <span class="nb">test</span> 表达式<span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>使用 <code>[ ... ]</code> 或 `[[ &hellip; ]]
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> 表达式 <span class="o">]</span> <span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>注意以下情况：</p>
<ul>
<li>当 <code>test</code> 命令不带表达式时，条件不成立</li>
<li>当 <code>test</code> 命令表达是为变量，且变量值为空时，条件不成立</li>
<li>所有的表达式<code>[ ... ]</code> 或 [[ &hellip; ]] 两边都有空格</li>
<li><code>[ ... ]</code> 条件表达式不支持正则表达式</li>
<li>高等字符串比较需要使用双中括号<code>[[ ... ]]</code>, 优先使用它，能减少错误发生且还支持正则表达式，</li>
<li>使用<code>&lt;</code>或<code>&gt;</code>时需要转义，否则视为重定向（高等表达式除外）</li>
<li>字符使用<code>ASCII</code>排序</li>
<li>普通的运算需要使用中括号<code>[ ]</code></li>
<li>并不是所有的<code>shell</code> 支持高级字符串比较</li>
<li>字符串比较符 <code>-n</code>，<code>-z</code> 如果有变量要加双引号</li>
<li>如果测试字符串，尽量使用引号，而不是过滤字符串</li>
<li>某些命令能正常执行，但退出状态码不为 <code>0</code>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat if-then.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="k">$(</span>systemctl status firewalld<span class="k">)</span> <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;命令执行成功&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 命令执行成功，但 if 语句判断失败</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># bash if-then.sh </span>
</span></span><span class="line"><span class="cl">● firewalld.service - firewalld - dynamic firewall daemon
</span></span><span class="line"><span class="cl">   Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/firewalld.service<span class="p">;</span> disabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
</span></span><span class="line"><span class="cl">   Active: inactive <span class="o">(</span>dead<span class="o">)</span>
</span></span><span class="line"><span class="cl">     Docs: man:firewalld<span class="o">(</span>1<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>判断条件结果有以下几种情况</p>
<ul>
<li>表达式：表达式成立为真，否则为假</li>
<li>退出状态码：可执行文件退出状态码为 <code>0</code> 表示为真</li>
<li><code>true</code>：单纯的三个字符，表示条件为成立</li>
<li><code>false</code>：单词的四个字符，表示条件为不成立</li>
</ul>
<h3 id="整数比较" class="heading-element">
  <a href="#%e6%95%b4%e6%95%b0%e6%af%94%e8%be%83" class="heading-mark"></a>整数比较</h3><table>
<thead>
<tr>
<th style="text-align:left">整数比较符</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>-eq</code></td>
<td style="text-align:left">等于</td>
<td style="text-align:left"><code>[ 1 -eq 1 ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-gt</code></td>
<td style="text-align:left">大于</td>
<td style="text-align:left"><code>[ 2 -gt 1 ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-lt</code></td>
<td style="text-align:left">小于</td>
<td style="text-align:left"><code>[ 2 -lt 1 ]</code> 表达式不成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-ne</code></td>
<td style="text-align:left">不等于</td>
<td style="text-align:left"><code>[ 1 -ne 1 ]</code> 表达式不成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-ge</code></td>
<td style="text-align:left">大于或等于</td>
<td style="text-align:left"><code>[ 2 -ge 1 ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-le</code></td>
<td style="text-align:left">小于或等于</td>
<td style="text-align:left"><code>[ 2 -le 1 ]</code> 表达式成不成立</td>
</tr>
</tbody>
</table>
<h3 id="字符串比较" class="heading-element">
  <a href="#%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%af%94%e8%be%83" class="heading-mark"></a>字符串比较</h3><table>
<thead>
<tr>
<th style="text-align:left">比较符</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>=</code></td>
<td style="text-align:left">等于</td>
<td style="text-align:left"><code>[ &quot;a&quot; = &quot;a&quot; ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>&gt;</code></td>
<td style="text-align:left">大于</td>
<td style="text-align:left"><code>[ &quot;a&quot; &gt; &quot;c&quot; ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;</code></td>
<td style="text-align:left">小于</td>
<td style="text-align:left"><code>[ &quot;a&quot; &gt; &quot;c&quot; ]</code> 表达式不成立</td>
</tr>
<tr>
<td style="text-align:left"><code>&gt;=</code></td>
<td style="text-align:left">大于或等于</td>
<td style="text-align:left"><code>[ &quot;a&quot; &gt;= &quot;c&quot; ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>&lt;=</code></td>
<td style="text-align:left">小于或等于</td>
<td style="text-align:left"><code>[ &quot;a&quot; &gt;= &quot;c&quot; ]</code> 表达式不成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-n</code></td>
<td style="text-align:left">长度不为0</td>
<td style="text-align:left"><code>[ -n &quot;s&quot; ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-z</code></td>
<td style="text-align:left">长度为0</td>
<td style="text-align:left"><code>[ -z &quot;a&quot; ]</code> 表达式不成立</td>
</tr>
<tr>
<td style="text-align:left"><code>==</code></td>
<td style="text-align:left">等于</td>
<td style="text-align:left"><code>[ &quot;a&quot; == &quot;a&quot; ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>!=</code></td>
<td style="text-align:left">不等于</td>
<td style="text-align:left"><code>[ &quot;s&quot; != &quot;d&quot; ]</code> 表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>=!</code></td>
<td style="text-align:left">右边的扩展正则表达式包含左边的字符串</td>
<td style="text-align:left"><code>&quot;shell&quot; =~ [a-z]+</code> 表示成立</td>
</tr>
<tr>
<td style="text-align:left"><code>str</code></td>
<td style="text-align:left">存在为真</td>
<td style="text-align:left"><code>[ dtr &quot;sdf&quot; ]</code> 表达式成立</td>
</tr>
</tbody>
</table>
<br/>
<p><code>=~</code> 补充：判断右边的模式是否为左边字符串的子字符串，而不是判断右边的模式是否完全等于左边的字符串，且右边的扩展正则表达式不能被引号包围，否则当成字符串处理，不解析表达式</p>
<h3 id="文件测试符" class="heading-element">
  <a href="#%e6%96%87%e4%bb%b6%e6%b5%8b%e8%af%95%e7%ac%a6" class="heading-mark"></a>文件测试符</h3><table>
<thead>
<tr>
<th style="text-align:left">测试符</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>-e</code></td>
<td style="text-align:left">文件或目录存在，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-f</code></td>
<td style="text-align:left">文件存在，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-d</code></td>
<td style="text-align:left">目录存在，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-r</code></td>
<td style="text-align:left">有读权限，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-w</code></td>
<td style="text-align:left">有写权限，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-x</code></td>
<td style="text-align:left">有执行权限，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-s</code></td>
<td style="text-align:left">文件存在且不为空，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-O</code></td>
<td style="text-align:left">文件存在且属主为当前用户，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-G</code></td>
<td style="text-align:left">文件存在且属主有当前用户，表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-nt</code></td>
<td style="text-align:left">左边文件比右边文件新（创建日期），表达式成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-ot</code></td>
<td style="text-align:left">左边文件比右边文件旧（创建日期），表达式成立</td>
</tr>
</tbody>
</table>
<h3 id="逻辑判断符" class="heading-element">
  <a href="#%e9%80%bb%e8%be%91%e5%88%a4%e6%96%ad%e7%ac%a6" class="heading-mark"></a>逻辑判断符</h3><table>
<thead>
<tr>
<th style="text-align:left">判断符</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>&amp;&amp;</code></td>
<td style="text-align:left">逻辑和，两边条件都成立，则表达式成立</td>
</tr>
<tr>
<td style="text-align:left">`</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h3 id="布尔运算符" class="heading-element">
  <a href="#%e5%b8%83%e5%b0%94%e8%bf%90%e7%ae%97%e7%ac%a6" class="heading-mark"></a>布尔运算符</h3><table>
<thead>
<tr>
<th style="text-align:left">布尔运算符</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>!</code></td>
<td style="text-align:left">非关系，如果表达式成立，则返回 <code>false</code> （表示表达式不成立）</td>
</tr>
<tr>
<td style="text-align:left"><code>-a</code></td>
<td style="text-align:left">和关系，所有表达式成立，整个表达式才算成立</td>
</tr>
<tr>
<td style="text-align:left"><code>-o</code></td>
<td style="text-align:left">或关系，其中一个表达式成立，整个表达式都成立</td>
</tr>
</tbody>
</table>
<h2 id="逻辑语句" class="heading-element">
  <a href="#%e9%80%bb%e8%be%91%e8%af%ad%e5%8f%a5" class="heading-mark"></a>逻辑语句</h2><p><code>; do</code> , <code>; then</code> 应该和 <code>if/for/while</code> 放在同一行。 <code>else</code> 应该单独一行，结束语句应该单独一行并且跟开始语句垂直对齐</p>
<h3 id="if-语句" class="heading-element">
  <a href="#if-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>if 语句</h3><div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 如果条件判断成立，则执行相应的操作（可以有多个），如果条件不成立，则忽略相应操作</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> 条件判断<span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> 条件判断 <span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">	条件成立执行的相应操作
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">	条件失败执行的相应操作
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 如果某个条件成立，则执行相应的操作，之后的操作不会再去判断</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> 条件判断 <span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作1
</span></span><span class="line"><span class="cl"><span class="k">elif</span> 条件判断2 <span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作2
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="k">elif</span> 条件判断 n <span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作 n
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># then可以换行，但then 前面的 ; 要去掉</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> 条件判断1
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作1
</span></span><span class="line"><span class="cl"><span class="k">elif</span> 条件判断2
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作2
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="k">elif</span> 条件判断 n
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">	执行操作 n
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">	所有条件都失败执行的操作
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> dir in <span class="si">${</span><span class="nv">dirs_to_cleanup</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[[</span> -d <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">ORACLE_SID</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    log_date <span class="s2">&#34;Cleaning up old files in </span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">ORACLE_SID</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    rm <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">ORACLE_SID</span><span class="si">}</span><span class="s2">/&#34;</span>*
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$?</span><span class="s2">&#34;</span> -ne <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      error_message
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    mkdir -p <span class="s2">&#34;</span><span class="si">${</span><span class="nv">dir</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">ORACLE_SID</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$?</span><span class="s2">&#34;</span> -ne <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      error_message
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="for-语句" class="heading-element">
  <a href="#for-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>for 语句</h3><p><code>for</code> 语句可以创建一个遍历一系列值的循环。每次迭代选区其中一个值来执行已经定义好的一组命令。格式如下</p>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> 变量 in 变量取值列表<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">	执行操作
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><p>第一次迭代使用列表中的第一值，第二次迭代使用第二次值，以此类推直到遍历所有的值，变量值会保持最后一次遍历的值</p>
<p>变量取值列表：</p>
<ul>
<li>取值列表的值用<code>IFS</code>定义的变量值为分隔符</li>
<li>取值列表的值包含其他的值需要转义或双引号引用</li>
<li>变量取值列表的值可以是一个变量列表、变量数组、命令的执行输出</li>
</ul>
<p><code>IFS</code>（内部字段分隔符）默认情况下会把以下字符当成分隔符：</p>
<ul>
<li>空格</li>
<li>制表符</li>
<li>换行符</li>
</ul>
<p><code>IFS</code> 可以添加变量 <code>$IFS</code> 指定分隔符，如下示例：</p>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">IFS_1</span><span class="o">=</span><span class="nv">$IFS</span> <span class="c1"># 先保留到 IFS_1 ，以便后续恢复到默认值使用</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 只有换行符才被认为是分隔符</span>
</span></span><span class="line"><span class="cl"><span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="c-语言风格的-for-语句" class="heading-element">
  <a href="#c-%e8%af%ad%e8%a8%80%e9%a3%8e%e6%a0%bc%e7%9a%84-for-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>C 语言风格的 for 语句</h3><ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span>1<span class="p">;</span> i &lt;<span class="o">=</span> 10<span class="p">;</span> i++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;The next number is </span><span class="nv">$i</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中，<code>i++</code> 表示每次 <code>+1</code>，<code>i</code> 起始值为 <code>1</code>，每次遍历 <code>i</code> 都会 +<code>1</code>，直到 <code>i</code> 小于等于 <code>10</code> 才停止</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">a</span><span class="o">=</span>1, <span class="nv">b</span><span class="o">=</span>10<span class="p">;</span> a &lt;<span class="o">=</span> 10<span class="p">;</span> a++, b-- <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$a</span><span class="s2"> - </span><span class="nv">$b</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中，每次遍历 <code>a+1，b-1</code> 。直到 <code>a = 10</code> 才停止遍历</p>
<h3 id="while-语句" class="heading-element">
  <a href="#while-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>while 语句</h3><p><code>while</code> 语句当条件成立时，循环执行某些操作，直到条件不成立为止。条件不会自动改变，因此需要在 <code>while</code> 执行操作中要改变判断条件，否则会无限循环</p>
<p>语法格式：</p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">while</span> :<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">	执行操作（必须包含改变终结循环的条件）
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：语法2</li>
</ul>
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat while.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> :<span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">  <span class="nb">read</span> -p <span class="s2">&#34;Please input username: &#34;</span> USER 
</span></span><span class="line"><span class="cl">  <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$USER</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">break</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><p>由于循环命令是在一个子<code>shell</code>中运行的，在<code>while</code>循环中被修改的变量是不能传递给父<code>shell</code>，且管道导向 <code>while</code> 循环中的隐式子<code>shell</code>使得追踪<code>bug</code>变得很困难。因此，不要使用管道符传递给<code>while</code> 语句或者使用 <code>for</code> 语句替代或使用以下方式</p>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">read</span> count filename<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">total</span><span class="o">+=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">count</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">last_file</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">filename</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> &lt; &lt;<span class="o">(</span>your_command <span class="p">|</span> uniq -c<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>当然，不需要传递复杂的结果给父<code>shell</code>时可以使用<code>while</code>循环时可以使用管道符传递给 <code>while</code> 语句</p>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat /proc/mounts <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> src dest <span class="nb">type</span> opts rest<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[[</span> <span class="si">${</span><span class="nv">type</span><span class="si">}</span> <span class="o">==</span> <span class="s2">&#34;nfs&#34;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;NFS </span><span class="si">${</span><span class="nv">dest</span><span class="si">}</span><span class="s2"> maps to </span><span class="si">${</span><span class="nv">src</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="until-语句" class="heading-element">
  <a href="#until-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>until 语句</h3><p><code>until</code> 语句与<code>while</code>相反，它是当条件不成立时，会循环执行相关操作，直到条件成立。判断条件也不会自动更新，需要在循环语句中更改判断条件，格式如下</p>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">util  判断条件 <span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    执行操作（必须包含改变条件判断的语句）
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="case-语句" class="heading-element">
  <a href="#case-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>case 语句</h3><p><code>case</code> 是一种简洁的条件判断语句：更据变量取值，执行相应的代码块，如果都没有匹配的条件，则执行 <code>*</code> 号的代码块（可选）。语句格式如下：</p>
<ul>
<li>使用 <code>2</code> 个空格缩进可选项</li>
<li>在同一行可选项的模式右圆括号之后和结束符 <code>;;</code> 之前各需要一个空格</li>
<li>长可选项或者多命令可选项应该被拆分成多行，模式、操作和结束符 <code>;;</code> 在不同的行</li>
</ul>
<br/>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">case</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">expression</span><span class="si">}</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">  a<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">variable</span><span class="o">=</span><span class="s2">&#34;...&#34;</span>
</span></span><span class="line"><span class="cl">    some_command <span class="s2">&#34;</span><span class="si">${</span><span class="nv">variable</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">other_expr</span><span class="si">}</span><span class="s2">&#34;</span> 
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  absolute<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="nv">actions</span><span class="o">=</span><span class="s2">&#34;relative&#34;</span>
</span></span><span class="line"><span class="cl">    another_command <span class="s2">&#34;</span><span class="si">${</span><span class="nv">actions</span><span class="si">}</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">other_expr</span><span class="si">}</span><span class="s2">&#34;</span> 
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  *<span class="o">)</span>
</span></span><span class="line"><span class="cl">    error <span class="s2">&#34;Unexpected expression &#39;</span><span class="si">${</span><span class="nv">expression</span><span class="si">}</span><span class="s2">&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl"><span class="k">esac</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## 简短格式</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">getopts</span> <span class="s1">&#39;abf:v&#39;</span> flag<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">flag</span><span class="si">}</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    a<span class="o">)</span> <span class="nv">aflag</span><span class="o">=</span><span class="s1">&#39;true&#39;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    b<span class="o">)</span> <span class="nv">bflag</span><span class="o">=</span><span class="s1">&#39;true&#39;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    f<span class="o">)</span> <span class="nv">files</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">OPTARG</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    v<span class="o">)</span> <span class="nv">verbose</span><span class="o">=</span><span class="s1">&#39;true&#39;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span> error <span class="s2">&#34;Unexpected option </span><span class="si">${</span><span class="nv">flag</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat ssh.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/binn/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;sshd服务选项：15:重启、16:启动、17:停止、18:状态&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">read</span> -p <span class="s2">&#34;请输入选项：&#34;</span> option
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="nv">$option</span>  in
</span></span><span class="line"><span class="cl">    15<span class="o">)</span>
</span></span><span class="line"><span class="cl">        systemctl restart sshd
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    16<span class="o">)</span>
</span></span><span class="line"><span class="cl">        ystemctl start sshd
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    17<span class="o">)</span>
</span></span><span class="line"><span class="cl">        systemctl stop sshd
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    18<span class="o">)</span>
</span></span><span class="line"><span class="cl">        systemctl status sshd
</span></span><span class="line"><span class="cl">   <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;请输入正确的选项&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">;;</span>
</span></span><span class="line"><span class="cl"><span class="k">esac</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行脚本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># bash ssh.sh </span>
</span></span><span class="line"><span class="cl">sshd服务选项：15:重启、16:启动、17:停止、18:状态
</span></span><span class="line"><span class="cl">请输入选项：19
</span></span><span class="line"><span class="cl">请输入正确的选项
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># bash ssh.sh </span>
</span></span><span class="line"><span class="cl">sshd服务选项：15:重启、16:启动、17:停止、18:状态
</span></span><span class="line"><span class="cl">请输入选项：18
</span></span><span class="line"><span class="cl">● sshd.service - OpenSSH server daemon
</span></span><span class="line"><span class="cl">   Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/sshd.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
</span></span><span class="line"><span class="cl">   Active: active <span class="o">(</span>running<span class="o">)</span> since Sat 2020-06-06 07:13:21 CST<span class="p">;</span> <span class="m">1</span> day 23h ago
</span></span><span class="line"><span class="cl">     Docs: man:sshd<span class="o">(</span>8<span class="o">)</span>
</span></span><span class="line"><span class="cl">           man:sshd_config<span class="o">(</span>5<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="循环语句控制" class="heading-element">
  <a href="#%e5%be%aa%e7%8e%af%e8%af%ad%e5%8f%a5%e6%8e%a7%e5%88%b6" class="heading-mark"></a>循环语句控制</h3><p>以下命令可以直接终止循环语句:</p>
<ul>
<li><code>break</code>：终止循环。以下是示例
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">a</span> <span class="o">=</span> 1<span class="p">;</span> a &lt; 4<span class="p">;</span> a++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;Outer loop: </span><span class="nv">$a</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="o">((</span> <span class="nv">b</span> <span class="o">=</span> 1<span class="p">;</span> b &lt; 100<span class="p">;</span> b++ <span class="o">))</span>
</span></span><span class="line"><span class="cl">	<span class="k">do</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="o">[</span> <span class="nv">$b</span> -eq <span class="m">5</span> <span class="o">]</span> <span class="c1"># b = 5 时，终止当前 for 循环</span>
</span></span><span class="line"><span class="cl">		<span class="k">then</span>
</span></span><span class="line"><span class="cl">			<span class="nb">break</span>
</span></span><span class="line"><span class="cl">		<span class="k">fi</span>
</span></span><span class="line"><span class="cl">		<span class="nb">echo</span> <span class="s2">&#34; Inner loop: </span><span class="nv">$b</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash break.sh </span>
</span></span><span class="line"><span class="cl">Outer loop: <span class="m">1</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">1</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">2</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">3</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">4</span>
</span></span><span class="line"><span class="cl">Outer loop: <span class="m">2</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">1</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">2</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">3</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">4</span>
</span></span><span class="line"><span class="cl">Outer loop: <span class="m">3</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">1</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">2</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">3</span>
</span></span><span class="line"><span class="cl"> Inner loop: <span class="m">4</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li><code>continue</code>：跳出循环（忽略本次循环
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash -v continue.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">((</span> <span class="nv">var1</span> <span class="o">=</span> 1<span class="p">;</span> var1 &lt; 15<span class="p">;</span> var1++ <span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> <span class="nv">$var1</span> -gt <span class="m">5</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="nv">$var1</span> -lt <span class="m">10</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="k">continue</span> <span class="c1"># var = 5时忽略下面代码，直接执行下次循环</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Iteration number: </span><span class="nv">$var1</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">1</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">2</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">3</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">4</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">5</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">10</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">11</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">12</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">13</span>
</span></span><span class="line"><span class="cl">Iteration number: <span class="m">14</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="脚本参数与选项" class="heading-element">
  <a href="#%e8%84%9a%e6%9c%ac%e5%8f%82%e6%95%b0%e4%b8%8e%e9%80%89%e9%a1%b9" class="heading-mark"></a>脚本参数与选项</h2><h3 id="位置参数" class="heading-element">
  <a href="#%e4%bd%8d%e7%bd%ae%e5%8f%82%e6%95%b0" class="heading-mark"></a>位置参数</h3><p>位置参数表示脚本后面的字符串，这些位置参数以空格作为分隔符分别保存在 <code>${n}</code> 中，<code>n</code> 必须是正整数或为 <code>0</code>。如果 <code>n</code> 小于 <code>10</code> 则可以不用 <code>{}</code> ：</p>
<ul>
<li><code>$0</code> 表示脚本名称，如果带有路径，则显示路径+脚本名称</li>
<li><code>$1</code> 表示脚本之后第 <code>1</code> 个字符串</li>
<li><code>$2</code> 表示脚本之后第 <code>2</code> 个字符串
&hellip;</li>
<li><code>$9</code> 表示脚本之后第 <code>9</code> 个字符串</li>
<li><code>${10}</code> 表示脚本之后第 <code>10</code> 个字符串
&hellip;</li>
</ul>
<br/>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-33"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$0</span>--<span class="si">${</span><span class="nv">1</span><span class="si">}</span>+<span class="nv">$2</span>+<span class="nv">$3</span>+<span class="nv">$4</span>+<span class="nv">$5</span>+<span class="nv">$6</span>+<span class="nv">$7</span>+<span class="nv">$8</span>+<span class="si">${</span><span class="nv">9</span><span class="si">}</span>+<span class="si">${</span><span class="nv">10</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行带路径的脚本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash ~/shell/test.sh q w e r t y u i o p</span>
</span></span><span class="line"><span class="cl">/root/shell/test.sh--q+w+e+r+t+y+u+i+o+p
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行不带路径的脚本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash test.sh q w e r t y u i o p</span>
</span></span><span class="line"><span class="cl">test.sh--q+w+e+r+t+y+u+i+o+p</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="脚本参数数量" class="heading-element">
  <a href="#%e8%84%9a%e6%9c%ac%e5%8f%82%e6%95%b0%e6%95%b0%e9%87%8f" class="heading-mark"></a>脚本参数数量</h3><p>脚本参数数量保存在 <code>$#</code> 中，<code>${!#}</code> 表示最后一个位置参数</p>
<div class="highlight" id="id-34"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;脚本参数总共有 </span><span class="nv">$#</span><span class="s2"> 个，最后一个参数是 </span><span class="si">${</span><span class="p">!#</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行脚本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash test.sh s f l </span>
</span></span><span class="line"><span class="cl">脚本参数总共有 <span class="m">3</span> 个，最后一个参数是 l</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="抓取所有脚本参数" class="heading-element">
  <a href="#%e6%8a%93%e5%8f%96%e6%89%80%e6%9c%89%e8%84%9a%e6%9c%ac%e5%8f%82%e6%95%b0" class="heading-mark"></a>抓取所有脚本参数</h3><p><code>$*</code> 会把脚本参数当成一个整体，<code>$@</code> 会把所有所有脚本参数保存起，单个处理</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-35"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> param in <span class="s2">&#34;</span><span class="nv">$*</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;\$* Parameter #</span><span class="nv">$count</span><span class="s2"> = </span><span class="nv">$param</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> param in <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;\$@ Parameter #</span><span class="nv">$count</span><span class="s2"> = </span><span class="nv">$param</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="脚本参数偏移位" class="heading-element">
  <a href="#%e8%84%9a%e6%9c%ac%e5%8f%82%e6%95%b0%e5%81%8f%e7%a7%bb%e4%bd%8d" class="heading-mark"></a>脚本参数偏移位</h3><p><code>shift n</code> 命令可以将每个脚本参数向左移动指定 n 个（缺省为1）位置。如 <code>$3</code> 向左偏移 1 位为 <code>$2</code> ，<code>$1</code> 再向左偏移则会被删除，无法恢复</p>
<div class="highlight" id="id-36"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Parameter #</span><span class="nv">$count</span><span class="s2"> = </span><span class="nv">$1</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">shift</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行脚本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash test.sh  30 20 10 9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Parameter <span class="c1">#1 = 30</span>
</span></span><span class="line"><span class="cl">Parameter <span class="c1">#2 = 20</span>
</span></span><span class="line"><span class="cl">Parameter <span class="c1">#3 = 10</span>
</span></span><span class="line"><span class="cl">Parameter <span class="c1">#4 = 9</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="查找选项" class="heading-element">
  <a href="#%e6%9f%a5%e6%89%be%e9%80%89%e9%a1%b9" class="heading-mark"></a>查找选项</h3><p>如果是处理单个脚本参数或对脚本参数执行顺序无要求的情况，可以使用以下方式</p>
<div class="highlight" id="id-37"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat option.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    -a<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s2">&#34;执行操作a&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    --list<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">shift</span>
</span></span><span class="line"><span class="cl">      <span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">		all<span class="o">)</span>
</span></span><span class="line"><span class="cl">          <span class="nb">echo</span> <span class="s2">&#34;执行操作 list all&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">;;</span>
</span></span><span class="line"><span class="cl">        user<span class="o">)</span>
</span></span><span class="line"><span class="cl">          <span class="nb">echo</span> <span class="s2">&#34;执行操作 list user&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">;;</span>
</span></span><span class="line"><span class="cl">		*<span class="o">)</span>
</span></span><span class="line"><span class="cl">          <span class="nb">echo</span> <span class="s2">&#34;请出入正确的参数&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="k">esac</span>
</span></span><span class="line"><span class="cl">    <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s2">&#34;输出帮助信息&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">break</span>
</span></span><span class="line"><span class="cl">  <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">  <span class="nb">shift</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash  option.sh  --list all -a --list -p</span>
</span></span><span class="line"><span class="cl">执行操作 list all
</span></span><span class="line"><span class="cl">执行操作a
</span></span><span class="line"><span class="cl">请出入正确的 --list 参数</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="处理合并的选选项" class="heading-element">
  <a href="#%e5%a4%84%e7%90%86%e5%90%88%e5%b9%b6%e7%9a%84%e9%80%89%e9%80%89%e9%a1%b9" class="heading-mark"></a>处理合并的选选项</h3><p><code>getopt</code> 命令行自动解析脚本选项和参数，该命令会把空格作为分隔符，且处理带空格或引号的参数值有点麻烦</p>
<div class="highlight" id="id-38"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># getopt ab:cd: -a -b test -cd test2 test3</span>
</span></span><span class="line"><span class="cl"> -a -b <span class="nb">test</span> -c -d test2 -- test3</span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中: <code>ab:cd</code> ：表示可用选项有 <code>-a</code>, <code>-b</code>, <code>-c</code>, <code>-d</code>；冒号表示之前的选项有参数（<code>-b test</code>） ；不带 <code>-</code> 开头的字符串视为参数，如果出现 <code>-</code> 之后的字母不是 a,b,c,d 之一，则报错</p>
<p>在脚本中使用 <code>getopt</code> 命令需要把输出传递给 <code>set --</code> ，</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-39"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">set</span> -- <span class="k">$(</span>getopt -q ab:cd <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    -a<span class="o">)</span> 
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s2">&#34;Found the -a option&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    -b<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nv">param</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$2</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s2">&#34;Found the -b option, with parameter value </span><span class="nv">$param</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nb">shift</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    -c<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s2">&#34;Found the -c option&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    --<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">shift</span>
</span></span><span class="line"><span class="cl">      <span class="nb">break</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2"> is not an option&#34;</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl">  <span class="nb">shift</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> param in <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Parameter #</span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$param</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># bash test.sh -a -b test1 -cd test2 test3 test4</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Found the -a option
</span></span><span class="line"><span class="cl">Found the -b option, with parameter value <span class="s1">&#39;test1&#39;</span>
</span></span><span class="line"><span class="cl">Found the -c option
</span></span><span class="line"><span class="cl">-d is not an option
</span></span><span class="line"><span class="cl">Parameter <span class="c1">#1: &#39;test2&#39;</span>
</span></span><span class="line"><span class="cl">Parameter <span class="c1">#2: &#39;test3&#39;</span>
</span></span><span class="line"><span class="cl">Parameter <span class="c1">#3: &#39;test4&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>getopts</code> 命令能够和已有的 shell 参数变量配合使用，每次调用时，只处理命令行上检测的第一个参数，处理完所有参数之后，会返回一个大于 0 的退出状态码</p>
<p><code>getopts</code> 命令格式：<code>getopts 有效选项 选项变量</code></p>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-40"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">getopts</span> :ab:c opt
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$opt</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    a<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Found the -a option&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    b<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Found the -b option, with value </span><span class="nv">$OPTARG</span><span class="s2">&#34;</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">    c<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Found the -c option&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Unknown option: </span><span class="nv">$opt</span><span class="s2">&#34;</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># ./test.sh -acb test1 </span>
</span></span><span class="line"><span class="cl">Found the -a option
</span></span><span class="line"><span class="cl">Found the -c option
</span></span><span class="line"><span class="cl">Found the -b option, with value test1</span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中 opt 变量值为每次迭代的选项，OPTARG 变量值为对应的选项</p>
<ul>
<li>示例：</li>
</ul>
<div class="highlight" id="id-41"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">getopts</span> :ab:cd opt
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">case</span> <span class="s2">&#34;</span><span class="nv">$opt</span><span class="s2">&#34;</span> in
</span></span><span class="line"><span class="cl">    a<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Found the -a option&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    b<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Found the -b option, with value </span><span class="nv">$OPTARG</span><span class="s2">&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    c<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Found the -c option&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    d<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Found the -d option&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">    *<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Unknown option: </span><span class="nv">$opt</span><span class="s2">&#34;</span> <span class="p">;;</span>
</span></span><span class="line"><span class="cl">  <span class="k">esac</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">shift</span> $<span class="o">[</span> <span class="nv">$OPTIND</span> - <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span>
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> param in <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Parameter </span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$param</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># ./test.sh -a -b test1 -d test2 test3 test4</span>
</span></span><span class="line"><span class="cl">Found the -a option
</span></span><span class="line"><span class="cl">Found the -b option, with value test1
</span></span><span class="line"><span class="cl">Found the -d option
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Parameter 1: test2
</span></span><span class="line"><span class="cl">Parameter 2: test3
</span></span><span class="line"><span class="cl">Parameter 3: test4</span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中，<code>while</code> 语句只处理了 <code>getopts</code> 命令分解的选项和参数，没处理的选项和参数由 <code>for</code> 语句处理</p>
<h3 id="标准化选项" class="heading-element">
  <a href="#%e6%a0%87%e5%87%86%e5%8c%96%e9%80%89%e9%a1%b9" class="heading-mark"></a>标准化选项</h3><p>命令选项没有标准化，以下是 <code>Linux</code> 命令中部分选项常见的含义，通常见到选项都大概知道是什么意思</p>
<table>
<thead>
<tr>
<th style="text-align:left">常见选项</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>-a</code></td>
<td style="text-align:left">显示所有对象</td>
</tr>
<tr>
<td style="text-align:left"><code>-c</code></td>
<td style="text-align:left">生成一个计数</td>
</tr>
<tr>
<td style="text-align:left"><code>-d</code></td>
<td style="text-align:left">指定一个目录</td>
</tr>
<tr>
<td style="text-align:left"><code>-e</code></td>
<td style="text-align:left">扩展一个对象</td>
</tr>
<tr>
<td style="text-align:left"><code>-f</code></td>
<td style="text-align:left">指定读入数据的文件</td>
</tr>
<tr>
<td style="text-align:left"><code>-h</code></td>
<td style="text-align:left">显示帮助信息</td>
</tr>
<tr>
<td style="text-align:left"><code>-i</code></td>
<td style="text-align:left">忽略文本大小写</td>
</tr>
<tr>
<td style="text-align:left"><code>-l</code></td>
<td style="text-align:left">产生输出的长格式版本</td>
</tr>
<tr>
<td style="text-align:left"><code>-n</code></td>
<td style="text-align:left">批处理</td>
</tr>
<tr>
<td style="text-align:left"><code>-o</code></td>
<td style="text-align:left">重定向输出</td>
</tr>
<tr>
<td style="text-align:left"><code>-q</code></td>
<td style="text-align:left">静默模式</td>
</tr>
<tr>
<td style="text-align:left"><code>-r</code></td>
<td style="text-align:left">递归目录</td>
</tr>
<tr>
<td style="text-align:left"><code>-s</code></td>
<td style="text-align:left">静默模式</td>
</tr>
<tr>
<td style="text-align:left"><code>-v</code></td>
<td style="text-align:left">详细输出</td>
</tr>
<tr>
<td style="text-align:left"><code>-x</code></td>
<td style="text-align:left">排出某个对象</td>
</tr>
<tr>
<td style="text-align:left"><code>-y</code></td>
<td style="text-align:left">自动确认</td>
</tr>
</tbody>
</table>
<h2 id="函数" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0" class="heading-mark"></a>函数</h2><p>函数是一个脚本代码块，可以在脚本中引用该函数的代码块，可以有效避免定义重复的代码块，<code>bash shell</code> 会将函数当成小型脚本，因此，可以把函数当成脚本对待；函数也可以向脚本那样在命令行中创建使用或写入 <code>bashrc</code>文件</p>
<ul>
<li>函数名使用 <code>function</code> 字母开头，尽量使用单词（前面的关键字 <code>function</code> 可选的，但可以增加识别度）</li>
<li>使用 <code>::</code> 区分  <code>package</code></li>
<li>函数定义在常用变量和环境变量声明下面，函数之间不能使用可执行代码</li>
</ul>
<br/>
<div class="highlight" id="id-42"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">## Single function</span>
</span></span><span class="line"><span class="cl">FunctionFunc<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Part of a package</span>
</span></span><span class="line"><span class="cl">FunctionPackage::my_func<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  ...
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>bash shell</code> 中有以下方式创建函数，函数名称在脚本中，必须是唯一的</p>
<div class="highlight" id="id-43"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 第一种</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> 函数名称 <span class="o">{</span>
</span></span><span class="line"><span class="cl">  执行操作
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 第二种</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">函数名称 <span class="o">(){</span>
</span></span><span class="line"><span class="cl">  执行操作
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="引用函数" class="heading-element">
  <a href="#%e5%bc%95%e7%94%a8%e5%87%bd%e6%95%b0" class="heading-mark"></a>引用函数</h3><p>函数定义之后，直接使用函数名称就能引用函数代码块，函数定义必须在调用函数之前，每次调用函数 <code>shell</code> 脚本都会产生一个新的子进程运行函数</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-44"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> func1 <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;This is an example of a function&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">[</span> <span class="nv">$count</span> -le <span class="m">5</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  func1
</span></span><span class="line"><span class="cl">  <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;This is the end of the loop&#34;</span>
</span></span><span class="line"><span class="cl">func1
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Now this is the end of the script&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>函数的执行输出可以赋值给变量</p>
<div class="highlight" id="id-45"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> dbl <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">read</span> -p <span class="s2">&#34;Enter a value: &#34;</span> value
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> $<span class="o">[</span> <span class="nv">$value</span> * <span class="m">2</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">result</span><span class="o">=</span><span class="k">$(</span>dbl<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The new value is </span><span class="nv">$result</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="函数的退出状态码" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0%e7%9a%84%e9%80%80%e5%87%ba%e7%8a%b6%e6%80%81%e7%a0%81" class="heading-mark"></a>函数的退出状态码</h3><p>函数执行完之后，会返回一个退出状态码。默认情况下，函数退出状态码是函数最后一条命令的退出状态码</p>
<div class="highlight" id="id-46"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">func1<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;trying to display a non-existent file&#34;</span>
</span></span><span class="line"><span class="cl">  ls -l badfile
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;testing the function: &#34;</span>
</span></span><span class="line"><span class="cl">func1
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The exit status is: </span><span class="nv">$?</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>bash shell 中，<code>return</code> 命令可以指定函数的退出状态码</p>
<div class="highlight" id="id-47"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> dbl <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">read</span> -p <span class="s2">&#34;Enter a value: &#34;</span> value
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;doubling the value&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> $<span class="o">[</span> <span class="nv">$value</span> * <span class="m">2</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">dbl
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The new value is </span><span class="nv">$?</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="函数中的变量" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0%e4%b8%ad%e7%9a%84%e5%8f%98%e9%87%8f" class="heading-mark"></a>函数中的变量</h3><p>函数可以使用标准的参数环境变量:</p>
<ul>
<li>调用函数时可以指定位置参数（<code>$1</code> <code>$2</code> 之类的）</li>
<li>函数中可以使用脚本中定义的变量</li>
<li>函数中修改或定义的变量对整个脚本都是有效的，可以使用 <code>local 变量名=变量值</code> 的方式定义变量，使该变量只在函数内生效</li>
</ul>
<h3 id="函数中的数组" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0%e4%b8%ad%e7%9a%84%e6%95%b0%e7%bb%84" class="heading-mark"></a>函数中的数组</h3><p>将数组变量当成单个参数传递给函数时，函数只会读取数组中第一个值。只有把数组的值分解为单个值，然后将这些值作为函数参数使用，在函数内部可以把所有的参数值重新合成一个新的变量。反之，如果要从函数向脚本传递数组也是在函数内部分解，再到脚本组合</p>
<ul>
<li>示例：脚本向函数传递数组</li>
</ul>
<div class="highlight" id="id-48"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> addarray
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> <span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl">    <span class="nb">local</span> newarray
</span></span><span class="line"><span class="cl">    <span class="nv">newarray</span><span class="o">=(</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="k">)</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> value in <span class="si">${</span><span class="nv">newarray</span><span class="p">[*]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">do</span>
</span></span><span class="line"><span class="cl">	<span class="nv">sum</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$sum</span> + <span class="nv">$value</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="nv">$sum</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">myarray</span><span class="o">=(</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> 5<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The original array is: </span><span class="si">${</span><span class="nv">myarray</span><span class="p">[*]</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">arg1</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">myarray</span><span class="p">[*]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">result</span><span class="o">=</span><span class="k">$(</span>addarray <span class="nv">$arg1</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The result is </span><span class="nv">$result</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：函数向脚本传递数组</li>
</ul>
<div class="highlight" id="id-49"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> arraydblr <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="nb">local</span> origarray
</span></span><span class="line"><span class="cl">	<span class="nb">local</span> newarray
</span></span><span class="line"><span class="cl">	<span class="nb">local</span> elements
</span></span><span class="line"><span class="cl">	<span class="nb">local</span> i
</span></span><span class="line"><span class="cl">	<span class="nv">origarray</span><span class="o">=(</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="k">)</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">	<span class="nv">newarray</span><span class="o">=(</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span><span class="k">)</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">	<span class="nv">elements</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$#</span> - <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span> <span class="o">=</span> 0<span class="p">;</span> i &lt;<span class="o">=</span> <span class="nv">$elements</span><span class="p">;</span> i++ <span class="o">))</span>
</span></span><span class="line"><span class="cl">	<span class="o">{</span>
</span></span><span class="line"><span class="cl">		newarray<span class="o">[</span><span class="nv">$i</span><span class="o">]=</span>$<span class="o">[</span> <span class="si">${</span><span class="nv">origarray</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span> * <span class="m">2</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="si">${</span><span class="nv">newarray</span><span class="p">[*]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">myarray</span><span class="o">=(</span><span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> 5<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The original array is: </span><span class="si">${</span><span class="nv">myarray</span><span class="p">[*]</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">arg1</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="si">${</span><span class="nv">myarray</span><span class="p">[*]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">result</span><span class="o">=(</span><span class="k">$(</span>arraydblr <span class="nv">$arg1</span><span class="k">)</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The new array is: </span><span class="si">${</span><span class="nv">result</span><span class="p">[*]</span><span class="si">}</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="函数递归" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0%e9%80%92%e5%bd%92" class="heading-mark"></a>函数递归</h3><p>函数局部变量的特性之一的自成体系，除了从脚本命令行处获取变量，自成体系的函数不需要使用任何外部资源。因此，函数可以递归使用，也就是函数可以调用其他函数，也可以调用自己</p>
<p>通常递归函数都有一个最终可以迭代的基准值，许多高级算法用递归对复杂的方程进行逐级规约，指定基准值定义的级别</p>
<ul>
<li>示例：<code>x=x(x-1)!</code> 方程</li>
</ul>
<div class="highlight" id="id-50"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">function</span> factorial <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="nv">$1</span> -eq <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">then</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">	<span class="nb">local</span> <span class="nv">temp</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$1</span> - <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">	<span class="nb">local</span> <span class="nv">result</span><span class="o">=</span><span class="s1">&#39;factorial $temp&#39;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> $<span class="o">[</span> <span class="nv">$result</span> * <span class="nv">$1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="函数库" class="heading-element">
  <a href="#%e5%87%bd%e6%95%b0%e5%ba%93" class="heading-mark"></a>函数库</h3><p>函数库文件包含很多函数，其他脚本可以引用函数库文件，不需要重复定义函数</p>
<p>定义函数库文件很简单，只需要将函数写入一个文本文档中，在脚本中引用函数库文件时当成可执行文件使用（注意上下文，文件权限等等）</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-51"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 函数库文件</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat function.txt </span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> addem <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> $<span class="o">[</span> <span class="nv">$1</span> + <span class="nv">$2</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> multem <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> $<span class="o">[</span> <span class="nv">$1</span> * <span class="nv">$2</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> divem <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[</span> <span class="nv">$2</span> -ne <span class="m">0</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> $<span class="o">[</span> <span class="nv">$1</span> / <span class="nv">$2</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> -1
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 脚本</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"> .  /root/shell/function.txt <span class="c1"># 点(source命令的别名) 和库文件之间是有空格的</span>
</span></span><span class="line"><span class="cl"><span class="c1">#  以下 3 个命令等效上述命令</span>
</span></span><span class="line"><span class="cl"><span class="c1"># . ./function.txt	</span>
</span></span><span class="line"><span class="cl"><span class="c1"># source  /root/shell/function.txt</span>
</span></span><span class="line"><span class="cl"><span class="c1"># source ./function.txt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">result</span><span class="o">=</span><span class="k">$(</span>addem <span class="m">10</span> 15<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;The result is </span><span class="nv">$result</span><span class="s2">&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="gun-shtool-函数库" class="heading-element">
  <a href="#gun-shtool-%e5%87%bd%e6%95%b0%e5%ba%93" class="heading-mark"></a>GUN shtool 函数库</h3><p><a href="http://www.gnu.org/software/shtool/"target="_blank" rel="external nofollow noopener noreferrer">GNU shtool</a>是将小型但非常稳定且可移植的shell脚本编译为单个shell工具的工具。多年来，各种成分已成功用于各种免费软件项目中。编译后的shtool程序旨在在其他免费软件包的源代码树中使用。在那里，它可以完成与构建和安装此软件包有关的各种（通常是非便携式的）任务。</p>
<ol>
<li>下载安装包</li>
</ol>
<div class="highlight" id="id-52"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 pag<span class="o">]</span><span class="c1"># tar -zxf /mnt/hgfs/note/other/shtool-2.0.8.tar.gz -C ./</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 pag<span class="o">]</span><span class="c1"># cd shtool-2.0.8</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>安装</li>
</ol>
<div class="highlight" id="id-53"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shtool-2.0.8<span class="o">]</span><span class="c1"># ./configure &amp;&amp; make &amp;&amp; make install</span>
</span></span><span class="line"><span class="cl">Configuring GNU shtool <span class="o">(</span>Portable Shell Tool<span class="o">)</span>, version 2.0.8 <span class="o">(</span>18-Jul-2008<span class="o">)</span>
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>c<span class="o">)</span> 1994-2008 Ralf S. Engelschall &lt;rse@engelschall.com&gt;
</span></span><span class="line"><span class="cl">checking whether make sets <span class="k">$(</span>MAKE<span class="k">)</span>... yes
</span></span><span class="line"><span class="cl">checking <span class="k">for</span> perl interpreter... /usr/bin/perl
</span></span><span class="line"><span class="cl">...</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>查看帮助信息</li>
</ol>
<div class="highlight" id="id-54"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># shtool --help</span>
</span></span><span class="line"><span class="cl">This is GNU shtool, version 2.0.8 <span class="o">(</span>18-Jul-2008<span class="o">)</span>
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>c<span class="o">)</span> 1994-2008 Ralf S. Engelschall &lt;rse@engelschall.com&gt;
</span></span><span class="line"><span class="cl">Report bugs to &lt;bug-shtool@gnu.org&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Usage: shtool <span class="o">[</span>&lt;options&gt;<span class="o">]</span> <span class="o">[</span>&lt;cmd-name&gt; <span class="o">[</span>&lt;cmd-options&gt;<span class="o">]</span> <span class="o">[</span>&lt;cmd-args&gt;<span class="o">]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Available global &lt;options&gt;:
</span></span><span class="line"><span class="cl">  -v, --version   display shtool version information
</span></span><span class="line"><span class="cl">  -h, --help      display shtool usage <span class="nb">help</span> page <span class="o">(</span>this one<span class="o">)</span>
</span></span><span class="line"><span class="cl">  -d, --debug     display shell trace information
</span></span><span class="line"><span class="cl">  -r, --recreate  recreate this shtool script via shtoolize
</span></span><span class="line"><span class="cl">...</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="退出状态码" class="heading-element">
  <a href="#%e9%80%80%e5%87%ba%e7%8a%b6%e6%80%81%e7%a0%81" class="heading-mark"></a>退出状态码</h2><p><code>shell</code> 中每个命令都使用退出状态码告知 shell 运行完毕。退出状态码为 <code>0</code> 到 <code>255</code> 的整数值，命令执行结束之后，退出状态码会保存在 <code>$?</code> 这个变量中。退出状态码是没有标准化的，也就是说没有统一的标准，因此在 <code>exit</code> 命令中随意指定，但通常状态码 <code>0</code> 表示成功，非 <code>0</code> 表示失败。当 <code>exit N</code> 指定退出状态码(<code>N</code>)大于 <code>255</code> 时，退出状态码=<code>N/256</code>的余数，如 <code>25500/256=99······156</code>，退出态码为 <code>156</code></p>
<p>示例：</p>
<div class="highlight" id="id-55"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat exit.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">var1</span><span class="o">=</span><span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="nv">var2</span><span class="o">=</span><span class="m">30</span>
</span></span><span class="line"><span class="cl"><span class="nv">var3</span><span class="o">=</span>$<span class="o">[</span><span class="nv">$var1</span> + <span class="nv">$var2</span><span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">exit</span> <span class="nv">$var3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># bash exit.sh </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># echo $?</span>
</span></span><span class="line"><span class="cl"><span class="m">40</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="重定向与文件描述符" class="heading-element">
  <a href="#%e9%87%8d%e5%ae%9a%e5%90%91%e4%b8%8e%e6%96%87%e4%bb%b6%e6%8f%8f%e8%bf%b0%e7%ac%a6" class="heading-mark"></a>重定向与文件描述符</h2><p><code>Linux</code> 系统将每个对象当成文件处理，包括输入和输出。<code>linux</code> 用文件描述符来标识文件对象。以下文件描述符和输入输出相关</p>
<table>
<thead>
<tr>
<th style="text-align:left">文件描述符</th>
<th style="text-align:left">缩写</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">STDIN</td>
<td style="text-align:left">标准输入（可以理解为键盘）</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">STDOUT</td>
<td style="text-align:left">标准输出（可以理解为屏幕）</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">STDERR</td>
<td style="text-align:left">标准错误输出 (可以理解为错误信息输出到屏幕）</td>
</tr>
</tbody>
</table>
<p><code>lsof -p $$</code> 命令可以查看当前进程打开的文件描述符</p>
<div class="highlight" id="id-56"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># lsof -p $$ </span>
</span></span><span class="line"><span class="cl">COMMAND  PID USER   FD   TYPE DEVICE  SIZE/OFF     NODE NAME
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">bash    <span class="m">1734</span> root    0u   CHR  136,0       0t0        <span class="m">3</span> /dev/pts/0
</span></span><span class="line"><span class="cl">bash    <span class="m">1734</span> root    1u   CHR  136,0       0t0        <span class="m">3</span> /dev/pts/0
</span></span><span class="line"><span class="cl">bash    <span class="m">1734</span> root    2u   CHR  136,0       0t0        <span class="m">3</span> /dev/pts/0
</span></span><span class="line"><span class="cl">bash    <span class="m">1734</span> root  255u   CHR  136,0       0t0        <span class="m">3</span> /dev/pts/0</span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中，<code>u</code> 表示文件描述符，其中 <code>255</code> 是重定向时保存的副本</p>
<p>重新向或追加可以替换原来的标准输入或标准输出，重定向或追加之前标准输出的文件描述符可以省略，全部重定向或追加可以使用 <code>&amp;</code> 替代</p>
<ul>
<li>示例：重定向正确输出到文件</li>
</ul>
<div class="highlight" id="id-57"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># ls &gt;file</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 或以下命令</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># ls 1&gt;file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 查看输出的内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat file </span>
</span></span><span class="line"><span class="cl">anaconda-ks.cfg
</span></span><span class="line"><span class="cl">file
</span></span><span class="line"><span class="cl">pag
</span></span><span class="line"><span class="cl">shell</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：重定向正确输出到文件，错误信息会继续输出到屏幕</li>
</ul>
<div class="highlight" id="id-58"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># systemctl status firewa sshd &gt;file</span>
</span></span><span class="line"><span class="cl">Unit firewa.service could not be found.
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat file </span>
</span></span><span class="line"><span class="cl">● sshd.service - OpenSSH server daemon
</span></span><span class="line"><span class="cl">   Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/sshd.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：重定向错误输出到文件</li>
</ul>
<div class="highlight" id="id-59"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat filea 2&gt;file</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat file </span>
</span></span><span class="line"><span class="cl">cat: filea: No such file or directory</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：重定向错误输出到文件，正确信息会继续输出到屏幕</li>
</ul>
<div class="highlight" id="id-60"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># systemctl status firewa sshd 2&gt;file</span>
</span></span><span class="line"><span class="cl">● sshd.service - OpenSSH server daemon
</span></span><span class="line"><span class="cl">   Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/sshd.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
</span></span><span class="line"><span class="cl">   Active: active <span class="o">(</span>running<span class="o">)</span> since Tue 2020-06-09 08:53:57 CST<span class="p">;</span> 22min ago
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat file </span>
</span></span><span class="line"><span class="cl">Unit firewa.service could not be found.</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：所有输出信息都重定向到文件</li>
</ul>
<div class="highlight" id="id-61"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># systemctl status firewa sshd &amp;&gt;file</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 等效上面的命令，2&gt;&amp;1 表示错误的信息重定向到标准输出 “1”。1 的信息也重定向到 文件</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># systemctl status firewa sshd &gt;file 2&gt;&amp;1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 等效上面的命令</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># systemctl status firewa sshd 2&gt;file &gt;&amp;2</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cat-和-eof" class="heading-element">
  <a href="#cat-%e5%92%8c-eof" class="heading-mark"></a>cat 和 EOF</h3><p>以相同字符开头和结尾（结尾可以使用 <code>&lt;Ctrl+d&gt;</code> ）。通常是 EOF 可以自定义。通常和 <code>cat </code> 命令使用</p>
<ul>
<li>示例：从标准输入追加到 cat 命令再重定向到 file</li>
</ul>
<div class="highlight" id="id-62"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat &gt; file &lt;&lt;EOF</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 等效上面的命令</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat &lt;&lt;EOF&gt;file</span>
</span></span><span class="line"><span class="cl">&gt; fds
</span></span><span class="line"><span class="cl">&gt; fds
</span></span><span class="line"><span class="cl">&gt; EOF
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 ~<span class="o">]</span><span class="c1"># cat file </span>
</span></span><span class="line"><span class="cl">fds
</span></span><span class="line"><span class="cl">fds</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>向文件重定向内容（会覆盖之前的内容）</li>
</ul>
<div class="highlight" id="id-63"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 文件内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># ls a.out </span>
</span></span><span class="line"><span class="cl">a.out
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 内容重定向到文件</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [root@localhost ~]# cat &lt;&lt; EOF &gt;a.out  #等效下述命令</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat &gt;a.out  &lt;&lt; EOF</span>
</span></span><span class="line"><span class="cl">&gt; 1-abc
</span></span><span class="line"><span class="cl">&gt; 2-abc
</span></span><span class="line"><span class="cl">&gt; EOF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文件内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat a.out </span>
</span></span><span class="line"><span class="cl">1-abc
</span></span><span class="line"><span class="cl">2-abc</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>向文件追加内容</li>
</ul>
<div class="highlight" id="id-64"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 文件内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat a.out </span>
</span></span><span class="line"><span class="cl">1-abc
</span></span><span class="line"><span class="cl">2-abc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 内容追加到文件</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [root@localhost ~]# cat &gt;&gt; a.out  &lt;&lt; EOF  #等效下述命令</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat &lt;&lt; EOF &gt;&gt;a.out </span>
</span></span><span class="line"><span class="cl">&gt; 3-abc
</span></span><span class="line"><span class="cl">&gt; 4-abc
</span></span><span class="line"><span class="cl">&gt; EOF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 文件内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># cat a.out </span>
</span></span><span class="line"><span class="cl">1-abc
</span></span><span class="line"><span class="cl">2-abc
</span></span><span class="line"><span class="cl">3-abc
</span></span><span class="line"><span class="cl">4-abc</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="脚本中的重定向" class="heading-element">
  <a href="#%e8%84%9a%e6%9c%ac%e4%b8%ad%e7%9a%84%e9%87%8d%e5%ae%9a%e5%90%91" class="heading-mark"></a>脚本中的重定向</h3><p>在 <code>shell</code> 脚本中，除了上述的标准使用，还可以在语法格式（如：if语句 for 语句等）、函数等重定向输出或输入</p>
<ul>
<li>示例：while 语句中使用重定向</li>
</ul>
<div class="highlight" id="id-65"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">cat /var/log/maillog <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Line </span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$line</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + 1<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> &gt;file
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Finished processing the file&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># ./test.sh </span>
</span></span><span class="line"><span class="cl">Finished processing the file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 重定向文件的内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat file </span>
</span></span><span class="line"><span class="cl">Line 1: Jun  <span class="m">7</span> 21:37:05 centos7 postfix/postfix-script<span class="o">[</span>1275<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 2: Jun  <span class="m">7</span> 21:37:05 centos7 postfix/master<span class="o">[</span>1277<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix
</span></span><span class="line"><span class="cl">Line 3: Jun  <span class="m">8</span> 08:51:17 centos7 postfix/postfix-script<span class="o">[</span>1282<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 4: Jun  <span class="m">8</span> 08:51:17 centos7 postfix/master<span class="o">[</span>1284<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix
</span></span><span class="line"><span class="cl">Line 5: Jun  <span class="m">9</span> 04:34:32 centos7 postfix/postfix-script<span class="o">[</span>1194<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 6: Jun  <span class="m">9</span> 04:34:32 centos7 postfix/master<span class="o">[</span>1196<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix
</span></span><span class="line"><span class="cl">Line 7: Jun  <span class="m">9</span> 08:54:00 centos7 postfix/postfix-script<span class="o">[</span>1282<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 8: Jun  <span class="m">9</span> 08:54:00 centos7 postfix/master<span class="o">[</span>1287<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：脚本从文件中读取内容输入</li>
</ul>
<div class="highlight" id="id-66"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 0&lt; /var/log/maillog
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Line </span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$line</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + 1<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> 
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Finished processing the file&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># ./test.sh </span>
</span></span><span class="line"><span class="cl">Line 1: Jun  <span class="m">7</span> 21:37:05 centos7 postfix/postfix-script<span class="o">[</span>1275<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 2: Jun  <span class="m">7</span> 21:37:05 centos7 postfix/master<span class="o">[</span>1277<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix
</span></span><span class="line"><span class="cl">Line 3: Jun  <span class="m">8</span> 08:51:17 centos7 postfix/postfix-script<span class="o">[</span>1282<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 4: Jun  <span class="m">8</span> 08:51:17 centos7 postfix/master<span class="o">[</span>1284<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix
</span></span><span class="line"><span class="cl">Line 5: Jun  <span class="m">9</span> 04:34:32 centos7 postfix/postfix-script<span class="o">[</span>1194<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 6: Jun  <span class="m">9</span> 04:34:32 centos7 postfix/master<span class="o">[</span>1196<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix
</span></span><span class="line"><span class="cl">Line 7: Jun  <span class="m">9</span> 08:54:00 centos7 postfix/postfix-script<span class="o">[</span>1282<span class="o">]</span>: starting the Postfix mail system
</span></span><span class="line"><span class="cl">Line 8: Jun  <span class="m">9</span> 08:54:00 centos7 postfix/master<span class="o">[</span>1287<span class="o">]</span>: daemon started -- version 2.10.1, configuration /etc/postfix</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>脚本输出到文件，不输出到屏幕（标准输出和错误输出） alog.txt</li>
</ul>
<div class="highlight" id="id-67"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt; alog.txt 
</span></span><span class="line"><span class="cl"><span class="c1"># 相同文件</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 错误输出到另一个文件</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt; blog.txt</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>脚本输出到文件，也输出到屏幕（标准输出和错误输出）</li>
</ul>
<div class="highlight" id="id-68"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt; &gt;<span class="o">(</span>tee alog.txt<span class="o">)</span>    
</span></span><span class="line"><span class="cl"><span class="c1"># 错误输出到相同文件</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 错误输出到另一个文件</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt; &gt;<span class="o">(</span>tee blog.txt &gt;<span class="p">&amp;</span>2<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>脚本输出到文件，正确输出到屏幕（标准出和错误输出都保存到文件）</li>
</ul>
<div class="highlight" id="id-69"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt; &gt;<span class="o">(</span>tee  alog.txt<span class="o">)</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># 错误输出到相同文件</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt; &gt;<span class="o">(</span>tee  alog.txt &gt; /dev/null<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 错误输出到另一个文件</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt;blog.txt</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>脚本输出到文件，错误输出到屏幕（标准输出和错误输出都保存到文件），不能打乱顺序</li>
</ul>
<div class="highlight" id="id-70"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 3&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt; &gt;<span class="o">(</span>tee  alog.txt &gt; /dev/null<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt; &gt;<span class="o">(</span>tee  alog.txt &gt;<span class="p">&amp;</span>3<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 或者使用以下方式</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt;alog.txt
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 2&gt; &gt;<span class="o">(</span>tee  alog.txt &gt;<span class="p">&amp;</span>2<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="自定义文件描述符" class="heading-element">
  <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e6%96%87%e4%bb%b6%e6%8f%8f%e8%bf%b0%e7%ac%a6" class="heading-mark"></a>自定义文件描述符</h3><p>每个进程可以打开 <code>9</code> 个文件描述符，其中 <code>0-2</code> 已经被 <code>bash shell</code> 保留了，剩下的 <code>3-8</code> 可以使用 <code>exec</code> 命令分配</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-71"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 0&lt;  /var/log/maillog
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 3&gt; file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Line </span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$line</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + 1<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> &gt;<span class="p">&amp;</span><span class="m">3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Finished processing the file&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：重定向文件描述符</li>
</ul>
<div class="highlight" id="id-72"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 3&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt;test14out
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;This should store in the output file&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;along with this line.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 1&gt;<span class="p">&amp;</span><span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Now things should be back to normal&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：创建输入文件描述符</li>
</ul>
<div class="highlight" id="id-73"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 6&lt;<span class="p">&amp;</span><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 0&lt; testfile
</span></span><span class="line"><span class="cl"><span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">read</span> line
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Line #</span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$line</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 0&lt;<span class="p">&amp;</span><span class="m">6</span>
</span></span><span class="line"><span class="cl"><span class="nb">read</span> -p <span class="s2">&#34;Are you done now? &#34;</span> answer
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="nv">$answer</span> in
</span></span><span class="line"><span class="cl">  Y<span class="p">|</span>y<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Goodbye&#34;</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl">  N<span class="p">|</span>n<span class="o">)</span> <span class="nb">echo</span> <span class="s2">&#34;Sorry, this is the end.&#34;</span><span class="p">;;</span>
</span></span><span class="line"><span class="cl"><span class="k">esac</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>示例：创建读写文件描述符</li>
</ul>
<div class="highlight" id="id-74"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 3&lt;&gt; testfile
</span></span><span class="line"><span class="cl"><span class="nb">read</span> line &lt;<span class="p">&amp;</span><span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Read: </span><span class="nv">$line</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;This is a test line&#34;</span> &gt;<span class="p">&amp;</span><span class="m">3</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="关闭自定义文件描述符" class="heading-element">
  <a href="#%e5%85%b3%e9%97%ad%e8%87%aa%e5%ae%9a%e4%b9%89%e6%96%87%e4%bb%b6%e6%8f%8f%e8%bf%b0%e7%ac%a6" class="heading-mark"></a>关闭自定义文件描述符</h3><p>一旦关闭了文件描述符，就不能在脚本中向它写入任何数据，否则shell会生成错误消息。此外。如果随后在脚本中打开了同一个输出文件，shell会用一个新文件来替换已有文件。因此输出数据就会覆盖已有文件</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-75"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">exec</span> 3&gt; test17file
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;This is a test line of data&#34;</span> &gt;<span class="p">&amp;</span><span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 3&gt;<span class="p">&amp;</span>-
</span></span><span class="line"><span class="cl">cat test17file
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> 3&gt; test17file
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;This&#39;ll be bad&#34;</span> &gt;<span class="p">&amp;</span><span class="m">3</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="交互式脚本" class="heading-element">
  <a href="#%e4%ba%a4%e4%ba%92%e5%bc%8f%e8%84%9a%e6%9c%ac" class="heading-mark"></a>交互式脚本</h1><h2 id="read-命令" class="heading-element">
  <a href="#read-%e5%91%bd%e4%bb%a4" class="heading-mark"></a>read 命令</h2><p><code>read</code> 命令能从键盘或文件中接收输入，并将接收到输入保存在变量中，可以指定多个变量。如果没有指定变量，则保存在环境变量 REPLY 中</p>
<div class="highlight" id="id-76"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">常见选项
</span></span><span class="line"><span class="cl">-p
</span></span><span class="line"><span class="cl">	指定提示符
</span></span><span class="line"><span class="cl">-t
</span></span><span class="line"><span class="cl">	指定超时时间（秒），在这时间之后还没接收到数据就退出并返回一个非 <span class="m">0</span> 的状态码
</span></span><span class="line"><span class="cl">-n
</span></span><span class="line"><span class="cl">	指定数据长度，当达到指定字符串长度时，自动提交数据，不用等待用户输入 &lt;Enter&gt; 键
</span></span><span class="line"><span class="cl">-s
</span></span><span class="line"><span class="cl">	隐藏用户的输入，用户输入的数据不会在屏幕中显示</span></span></code></pre></td></tr></table>
</div>
</div><p>示例</p>
<div class="highlight" id="id-77"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> -n <span class="s2">&#34;Enter your name: &#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">read</span> name
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Hello </span><span class="nv">$name</span><span class="s2">, welcome to my program. &#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 执行效果</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># ./test.sh </span>
</span></span><span class="line"><span class="cl">Enter your name: user01  <span class="c1"># 会等待用户输入</span>
</span></span><span class="line"><span class="cl">Hello user01, welcome to my program. </span></span></code></pre></td></tr></table>
</div>
</div><p>上述示例中，<code>echo -n</code> 取消了换行，等待用户输入之后（回车），把输入的内容赋值到变量中，该脚本还可以使用以下方式：</p>
<div class="highlight" id="id-78"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 脚本内容</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@centos7 shell<span class="o">]</span><span class="c1"># cat test.sh </span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nb">read</span> -p <span class="s2">&#34;Enter your name: &#34;</span> name
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Hello </span><span class="nv">$name</span><span class="s2">, welcome to my program. &#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="select-语句" class="heading-element">
  <a href="#select-%e8%af%ad%e5%8f%a5" class="heading-mark"></a>select 语句</h2><p>在<code>select</code>执行时，会根据<code>list</code>数组给出选择菜单，用户选择后的结果保存在<code>$var</code>变量中，然后执行<code>statements</code>语句。执行完成后，再次给出菜单，等待用户选择。如果用户想跳出选择循环，需要在循环体中根据条件增加<code>break</code>语句</p>
<ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-79"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash 
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  
</span></span><span class="line"><span class="cl"><span class="nv">fruits</span><span class="o">=(</span> 
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;apple&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;pear&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;orange&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;watermelon&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">)</span> 
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Please guess which fruit I like :&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">select</span> var in <span class="si">${</span><span class="nv">fruits</span><span class="p">[@]</span><span class="si">}</span> 
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[</span> <span class="nv">$var</span> <span class="o">=</span> <span class="s2">&#34;apple&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Congratulations, you are my good firend!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">break</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Try again!&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="重定向错误信息" class="heading-element">
  <a href="#%e9%87%8d%e5%ae%9a%e5%90%91%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af" class="heading-mark"></a>重定向错误信息</h1><p>将所有的错误信息都应该被导向STDERR，这样实际问题中分离出正常状态变得更容易</p>
<div class="highlight" id="id-80"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">err<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;[</span><span class="k">$(</span>date +<span class="s1">&#39;%Y-%m-%dT%H:%M:%S%z&#39;</span><span class="k">)</span><span class="s2">]: </span><span class="nv">$@</span><span class="s2">&#34;</span> &gt;<span class="p">&amp;</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> ! do_something<span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    err <span class="s2">&#34;Unable to do_something&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="分离输出信息" class="heading-element">
  <a href="#%e5%88%86%e7%a6%bb%e8%be%93%e5%87%ba%e4%bf%a1%e6%81%af" class="heading-mark"></a>分离输出信息</h1><p>把不同的输出信息重定向到不同的文件标示符</p>
<ul>
<li>示例：指定错误信息</li>
</ul>
<div class="highlight" id="id-81"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="p">!var</span><span class="k">:-</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="si">${</span><span class="p">!fileVar</span><span class="k">:-</span><span class="si">}</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> &gt;<span class="p">&amp;</span><span class="m">2</span> <span class="s2">&#34;error: both </span><span class="nv">$var</span><span class="s2"> and </span><span class="nv">$fileVar</span><span class="s2"> are set (but are exclusive)&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="判断用户身份" class="heading-element">
  <a href="#%e5%88%a4%e6%96%ad%e7%94%a8%e6%88%b7%e8%ba%ab%e4%bb%bd" class="heading-mark"></a>判断用户身份</h1><p>判断用户身份是否为超级管理员</p>
<div class="highlight" id="id-82"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span> <span class="k">$(</span>id -u<span class="k">)</span> !<span class="o">=</span> <span class="s2">&#34;0&#34;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> -e <span class="s2">&#34;\033[31m错误：当前用不是管理员用户\033[0m&#34;</span> <span class="p">;</span> <span class="nb">exit</span> 1<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 或</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="k">$(</span>id -u<span class="k">)</span> !<span class="o">=</span> <span class="s2">&#34;0&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;错误：当前用不是超级管理员，必须要 root 用户才能执行此脚本&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="提示错误过程" class="heading-element">
  <a href="#%e6%8f%90%e7%a4%ba%e9%94%99%e8%af%af%e8%bf%87%e7%a8%8b" class="heading-mark"></a>提示错误过程</h1><ul>
<li>示例</li>
</ul>
<div class="highlight" id="id-83"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="k">$(</span>ls -A<span class="k">)</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span>  <span class="s2">&#34;WARNING: </span><span class="nv">$PWD</span><span class="s2"> is not empty - press Ctrl+C now if this is an error!&#34;</span> &gt;<span class="p">&amp;</span><span class="m">2</span>
</span></span><span class="line"><span class="cl">	 <span class="o">(</span><span class="nb">set</span> -x<span class="p">;</span> ls -A<span class="p">;</span> sleep 10<span class="o">)</span> &gt;<span class="p">&amp;</span><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="使用-expr-命令处理字符串" class="heading-element">
  <a href="#%e4%bd%bf%e7%94%a8-expr-%e5%91%bd%e4%bb%a4%e5%a4%84%e7%90%86%e5%ad%97%e7%ac%a6%e4%b8%b2" class="heading-mark"></a>使用 expr 命令处理字符串</h1><h2 id="得到字符串长度" class="heading-element">
  <a href="#%e5%be%97%e5%88%b0%e5%ad%97%e7%ac%a6%e4%b8%b2%e9%95%bf%e5%ba%a6" class="heading-mark"></a>得到字符串长度</h2><p>直接使用 <code>expr</code> 命令</p>
<div class="highlight" id="id-84"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr length &#34;this is a test&#34;</span>
</span></span><span class="line"><span class="cl"><span class="m">14</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr &#34;sfdsafsd&#34; : &#34;.*&#34;</span>
</span></span><span class="line"><span class="cl"><span class="m">8</span></span></span></code></pre></td></tr></table>
</div>
</div><p>此外可以使用变量替换表达式：<code>$echo ${#variable}</code></p>
<div class="highlight" id="id-85"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zhyfly: ~$ <span class="nv">x</span><span class="o">=</span><span class="s2">&#34;this is a test&#34;</span>
</span></span><span class="line"><span class="cl">zhyfly: ~$ <span class="nb">echo</span> <span class="si">${#</span><span class="nv">x</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="m">14</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="查找字符串子串位置" class="heading-element">
  <a href="#%e6%9f%a5%e6%89%be%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%ad%90%e4%b8%b2%e4%bd%8d%e7%bd%ae" class="heading-mark"></a>查找字符串子串位置</h2><p>格式：<code>expr index &quot;$variable&quot; &quot;substring&quot;</code></p>
<div class="highlight" id="id-86"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr index &#34;this is a test&#34; &#34;h&#34;</span>
</span></span><span class="line"><span class="cl"><span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr index &#34;this is a test&#34; &#34;t&#34;</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取字符串子串" class="heading-element">
  <a href="#%e8%8e%b7%e5%8f%96%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%ad%90%e4%b8%b2" class="heading-mark"></a>获取字符串子串</h2><p>格式：<code>expr substr &quot;$variable&quot; startposition length</code></p>
<div class="highlight" id="id-87"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr substr &#34;variable&#34; 2 3</span>
</span></span><span class="line"><span class="cl">ari
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr substr &#34;variable&#34; 1 4</span>
</span></span><span class="line"><span class="cl">vari</span></span></code></pre></td></tr></table>
</div>
</div><p>此外可以使用变量替换表达式：<code>echo ${variable:position:length}</code></p>
<div class="highlight" id="id-88"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">zhyfly: ~$ <span class="nv">x</span><span class="o">=</span><span class="s2">&#34;this is a test&#34;</span>
</span></span><span class="line"><span class="cl">zhyfly: ~$ <span class="nb">echo</span> <span class="si">${</span><span class="nv">x</span><span class="p">:</span><span class="nv">1</span><span class="p">:</span><span class="nv">5</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">his i</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="获取字符串子串长度" class="heading-element">
  <a href="#%e8%8e%b7%e5%8f%96%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%ad%90%e4%b8%b2%e9%95%bf%e5%ba%a6" class="heading-mark"></a>获取字符串子串长度</h2><p>格式：<code>expr match &quot;string&quot; &quot;regex&quot;</code> 如果有匹配则反回其长度，否则返回 <code>0</code>。非从字符串头部开始匹配也是反回 <code>0</code></p>
<div class="highlight" id="id-89"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr match &#34;abcabab&#34; &#34;ac&#34;</span>
</span></span><span class="line"><span class="cl"><span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr match &#34;abcabcab&#34; &#34;a.*b&#34;</span>
</span></span><span class="line"><span class="cl"><span class="m">8</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@localhost ~<span class="o">]</span><span class="c1"># expr match &#34;abcabcab&#34; &#34;b.*b&#34;</span>
</span></span><span class="line"><span class="cl"><span class="m">0</span></span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2023-08-04 13:37:17">更新于 2023-08-04&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/shell/" class="post-tag" title="标签 - shell">shell</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/k8sAPI%E6%A6%82%E8%BF%B0%E5%8F%8A%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/" class="post-nav-item" rel="prev" title="k8s API 概述及访问控制"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>k8s API 概述及访问控制</a>
      <a href="/k8s%E5%AD%98%E5%82%A8/" class="post-nav-item" rel="next" title="k8s 存储卷">k8s 存储卷<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">由 <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.115.3"><img class="hugo-icon" src="/images/hugo.min.svg" alt="Hugo logo" /> Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.1"><img class="fixit-icon" src="/images/fixit.min.svg" alt="FixIt logo" /> FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2022 - 2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/"></a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/pangu/pangu.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"lightgallery":true,"pangu":{"enable":true,"selector":"article"},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":true,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":50,"threshold":0.3,"type":"fuse","useExtendedSearch":false}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
